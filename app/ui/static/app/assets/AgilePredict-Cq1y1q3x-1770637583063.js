import{c as Me,r as Q,a as _e,j as u,a2 as Rt,C as T,d as he,e as fe,s as _t,t as It,v as Ot,w as Et,x as Lt,B as Wt,R as Yt,f as N,o as zt,Y as Xt}from"./index-C9o0Pios-1770637583063.js";import{f as W,g as Y,C as te,E as I,t as v,h as Ce,j as C,k as oe,l as S,m as Bt,u as Ht,n as L,R as st,o as Vt,q as $t,D as Ft,A as qt,v as U,r as it,s as ke,Q as V,H as Z,w as Ie,x as at,y as Ut,z as Oe,F as ge,G as Ee,I as Gt,L as Jt,a as Kt,b as Qt,P as Zt,c as en,p as tn,d as nn,e as rn,T as on}from"./index-CFEBNbnl-1770637583063.js";import"./chartjs-adapter-date-fns.esm-tZY1Tlk9-1770637583063.js";import{L as Le}from"./loader-2-BdWnDbgH-1770637583063.js";/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sn=Me("ArrowDownRight",[["path",{d:"m7 7 10 10",key:"1fmybs"}],["path",{d:"M17 7v10H7",key:"6fjiku"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const an=Me("ArrowUpRight",[["path",{d:"M7 7h10v10",key:"1tivn9"}],["path",{d:"M7 17 17 7",key:"1vkiza"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ln=Me("CalendarRange",[["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",ry:"2",key:"eu3xkr"}],["line",{x1:"16",x2:"16",y1:"2",y2:"6",key:"m3sa8f"}],["line",{x1:"8",x2:"8",y1:"2",y2:"6",key:"18kwsl"}],["line",{x1:"3",x2:"21",y1:"10",y2:"10",key:"xt86sb"}],["path",{d:"M17 14h-6",key:"bkmgh3"}],["path",{d:"M13 18H7",key:"bb0bb7"}],["path",{d:"M7 14h.01",key:"1qa3f1"}],["path",{d:"M17 18h.01",key:"1bdyru"}]]);/*!
* chartjs-plugin-annotation v3.1.0
* https://www.chartjs.org/chartjs-plugin-annotation/index
 * (c) 2024 chartjs-plugin-annotation Contributors
 * Released under the MIT License
 */const We={modes:{point(t,e){return ne(t,e,{intersect:!0})},nearest(t,e,n){return un(t,e,n)},x(t,e,n){return ne(t,e,{intersect:n.intersect,axis:"x"})},y(t,e,n){return ne(t,e,{intersect:n.intersect,axis:"y"})}}};function ve(t,e,n){return(We.modes[n.mode]||We.modes.nearest)(t,e,n)}function dn(t,e,n){return n!=="x"&&n!=="y"?t.inRange(e.x,e.y,"x",!0)||t.inRange(e.x,e.y,"y",!0):t.inRange(e.x,e.y,n,!0)}function cn(t,e,n){return n==="x"?{x:t.x,y:e.y}:n==="y"?{x:e.x,y:t.y}:e}function ne(t,e,n){return t.filter(r=>n.intersect?r.inRange(e.x,e.y):dn(r,e,n.axis))}function un(t,e,n){let r=Number.POSITIVE_INFINITY;return ne(t,e,n).reduce((o,s)=>{const i=s.getCenterPoint(),a=cn(e,i,n.axis),l=Ce(e,a);return l<r?(o=[s],r=l):l===r&&o.push(s),o},[]).sort((o,s)=>o._index-s._index).slice(0,1)}function O(t,e,n){const r=Math.cos(n),o=Math.sin(n),s=e.x,i=e.y;return{x:s+r*(t.x-s)-o*(t.y-i),y:i+o*(t.x-s)+r*(t.y-i)}}const hn=(t,e)=>e>t||t.length>e.length&&t.slice(0,e.length)===e,R=.001,se=(t,e,n)=>Math.min(n,Math.max(e,t)),lt=(t,e)=>t.value>=t.start-e&&t.value<=t.end+e;function fn(t,e,n){for(const r of Object.keys(t))t[r]=se(t[r],e,n);return t}function gn(t,e,n,r){return!t||!e||n<=0?!1:Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2)<=Math.pow(n+r,2)}function dt(t,{x:e,y:n,x2:r,y2:o},s,{borderWidth:i,hitTolerance:a}){const l=(i+a)/2,d=t.x>=e-l-R&&t.x<=r+l+R,c=t.y>=n-l-R&&t.y<=o+l+R;return s==="x"?d:(s==="y"||d)&&c}function ct(t,{rect:e,center:n},r,{rotation:o,borderWidth:s,hitTolerance:i}){const a=O(t,n,v(-o));return dt(a,e,r,{borderWidth:s,hitTolerance:i})}function E(t,e){const{centerX:n,centerY:r}=t.getProps(["centerX","centerY"],e);return{x:n,y:r}}function mn(t,e,n,r=!0){const o=n.split(".");let s=0;for(const i of e.split(".")){const a=o[s++];if(parseInt(i,10)<parseInt(a,10))break;if(hn(a,i)){if(r)throw new Error(`${t} v${n} is not supported. v${e} or newer is required.`);return!1}}return!0}const ut=t=>typeof t=="string"&&t.endsWith("%"),ht=t=>parseFloat(t)/100,ft=t=>se(ht(t),0,1),$=(t,e)=>({x:t,y:e,x2:t,y2:e,width:0,height:0}),bn={box:t=>$(t.centerX,t.centerY),doughnutLabel:t=>$(t.centerX,t.centerY),ellipse:t=>({centerX:t.centerX,centerY:t.centerX,radius:0,width:0,height:0}),label:t=>$(t.centerX,t.centerY),line:t=>$(t.x,t.y),point:t=>({centerX:t.centerX,centerY:t.centerY,radius:0,width:0,height:0}),polygon:t=>$(t.centerX,t.centerY)};function Pe(t,e){return e==="start"?0:e==="end"?t:ut(e)?ft(e)*t:t/2}function D(t,e,n=!0){return typeof e=="number"?e:ut(e)?(n?ft(e):ht(e))*t:t}function yn(t,e){const{x:n,width:r}=t,o=e.textAlign;return o==="center"?n+r/2:o==="end"||o==="right"?n+r:n}function gt(t,e,{borderWidth:n,position:r,xAdjust:o,yAdjust:s},i){const a=W(i),l=e.width+(a?i.width:0)+n,d=e.height+(a?i.height:0)+n,c=Ae(r),h=Ye(t.x,l,o,c.x),f=Ye(t.y,d,s,c.y);return{x:h,y:f,x2:h+l,y2:f+d,width:l,height:d,centerX:h+l/2,centerY:f+d/2}}function Ae(t,e="center"){return W(t)?{x:U(t.x,e),y:U(t.y,e)}:(t=U(t,e),{x:t,y:t})}const mt=(t,e)=>t&&t.autoFit&&e<1;function bt(t,e){const n=t.font,r=Y(n)?n:[n];return mt(t,e)?r.map(function(o){const s=ge(o);return s.size=Math.floor(o.size*e),s.lineHeight=o.lineHeight,ge(s)}):r.map(o=>ge(o))}function yt(t){return t&&(C(t.xValue)||C(t.yValue))}function Ye(t,e,n=0,r){return t-Pe(e,r)+n}function X(t,e,n){const r=n.init;if(r){if(r===!0)return xt(e,n)}else return;return pn(t,e,n)}function pt(t,e,n){let r=!1;return e.forEach(o=>{L(t[o])?(r=!0,n[o]=t[o]):C(n[o])&&delete n[o]}),r}function xt(t,e){const n=e.type||"line";return bn[n](t)}function pn(t,e,n){const r=ke(n.init,[{chart:t,properties:e,options:n}]);if(r===!0)return xt(e,n);if(W(r))return r}const me=new Map,xn=t=>isNaN(t)||t<=0,wn=t=>t.reduce(function(e,n){return e+=n.string,e},"");function ie(t){if(t&&typeof t=="object"){const e=t.toString();return e==="[object HTMLImageElement]"||e==="[object HTMLCanvasElement]"}}function ae(t,{x:e,y:n},r){r&&(t.translate(e,n),t.rotate(v(r)),t.translate(-e,-n))}function k(t,e){if(e&&e.borderWidth)return t.lineCap=e.borderCapStyle||"butt",t.setLineDash(e.borderDash),t.lineDashOffset=e.borderDashOffset,t.lineJoin=e.borderJoinStyle||"miter",t.lineWidth=e.borderWidth,t.strokeStyle=e.borderColor,!0}function B(t,e){t.shadowColor=e.backgroundShadowColor,t.shadowBlur=e.shadowBlur,t.shadowOffsetX=e.shadowOffsetX,t.shadowOffsetY=e.shadowOffsetY}function le(t,e){const n=e.content;if(ie(n))return{width:D(n.width,e.width),height:D(n.height,e.height)};const r=bt(e),o=e.textStrokeWidth,s=Y(n)?n:[n],i=s.join()+wn(r)+o+(t._measureText?"-spriting":"");return me.has(i)||me.set(i,Cn(t,s,r,o)),me.get(i)}function wt(t,e,n){const{x:r,y:o,width:s,height:i}=e;t.save(),B(t,n);const a=k(t,n);t.fillStyle=n.backgroundColor,t.beginPath(),Vt(t,{x:r,y:o,w:s,h:i,radius:fn($t(n.borderRadius),0,Math.min(s,i)/2)}),t.closePath(),t.fill(),a&&(t.shadowColor=n.borderShadowColor,t.stroke()),t.restore()}function St(t,e,n,r){const o=n.content;if(ie(o)){t.save(),t.globalAlpha=Pn(n.opacity,o.style.opacity),t.drawImage(o,e.x,e.y,e.width,e.height),t.restore();return}const s=Y(o)?o:[o],i=bt(n,r),a=n.color,l=Y(a)?a:[a],d=yn(e,n),c=e.y+n.textStrokeWidth/2;t.save(),t.textBaseline="middle",t.textAlign=n.textAlign,Sn(t,n)&&kn(t,{x:d,y:c},s,i),vn(t,{x:d,y:c},s,{fonts:i,colors:l}),t.restore()}function Sn(t,e){if(e.textStrokeWidth>0)return t.lineJoin="round",t.miterLimit=2,t.lineWidth=e.textStrokeWidth,t.strokeStyle=e.textStrokeColor,!0}function jn(t,e,n,r){const{radius:o,options:s}=e,i=s.pointStyle,a=s.rotation;let l=(a||0)*st;if(ie(i)){t.save(),t.translate(n,r),t.rotate(l),t.drawImage(i,-i.width/2,-i.height/2,i.width,i.height),t.restore();return}xn(o)||Mn(t,{x:n,y:r,radius:o,rotation:a,style:i,rad:l})}function Mn(t,{x:e,y:n,radius:r,rotation:o,style:s,rad:i}){let a,l,d,c;switch(t.beginPath(),s){default:t.arc(e,n,r,0,at),t.closePath();break;case"triangle":t.moveTo(e+Math.sin(i)*r,n-Math.cos(i)*r),i+=Ie,t.lineTo(e+Math.sin(i)*r,n-Math.cos(i)*r),i+=Ie,t.lineTo(e+Math.sin(i)*r,n-Math.cos(i)*r),t.closePath();break;case"rectRounded":c=r*.516,d=r-c,a=Math.cos(i+V)*d,l=Math.sin(i+V)*d,t.arc(e-a,n-l,c,i-S,i-Z),t.arc(e+l,n-a,c,i-Z,i),t.arc(e+a,n+l,c,i,i+Z),t.arc(e-l,n+a,c,i+Z,i+S),t.closePath();break;case"rect":if(!o){d=Math.SQRT1_2*r,t.rect(e-d,n-d,2*d,2*d);break}i+=V;case"rectRot":a=Math.cos(i)*r,l=Math.sin(i)*r,t.moveTo(e-a,n-l),t.lineTo(e+l,n-a),t.lineTo(e+a,n+l),t.lineTo(e-l,n+a),t.closePath();break;case"crossRot":i+=V;case"cross":a=Math.cos(i)*r,l=Math.sin(i)*r,t.moveTo(e-a,n-l),t.lineTo(e+a,n+l),t.moveTo(e+l,n-a),t.lineTo(e-l,n+a);break;case"star":a=Math.cos(i)*r,l=Math.sin(i)*r,t.moveTo(e-a,n-l),t.lineTo(e+a,n+l),t.moveTo(e+l,n-a),t.lineTo(e-l,n+a),i+=V,a=Math.cos(i)*r,l=Math.sin(i)*r,t.moveTo(e-a,n-l),t.lineTo(e+a,n+l),t.moveTo(e+l,n-a),t.lineTo(e-l,n+a);break;case"line":a=Math.cos(i)*r,l=Math.sin(i)*r,t.moveTo(e-a,n-l),t.lineTo(e+a,n+l);break;case"dash":t.moveTo(e,n),t.lineTo(e+Math.cos(i)*r,n+Math.sin(i)*r);break}t.fill()}function Cn(t,e,n,r){t.save();const o=e.length;let s=0,i=r;for(let a=0;a<o;a++){const l=n[Math.min(a,n.length-1)];t.font=l.string;const d=e[a];s=Math.max(s,t.measureText(d).width+r),i+=l.lineHeight}return t.restore(),{width:s,height:i}}function kn(t,{x:e,y:n},r,o){t.beginPath();let s=0;r.forEach(function(i,a){const l=o[Math.min(a,o.length-1)],d=l.lineHeight;t.font=l.string,t.strokeText(i,e,n+d/2+s),s+=d}),t.stroke()}function vn(t,{x:e,y:n},r,{fonts:o,colors:s}){let i=0;r.forEach(function(a,l){const d=s[Math.min(l,s.length-1)],c=o[Math.min(l,o.length-1)],h=c.lineHeight;t.beginPath(),t.font=c.string,t.fillStyle=d,t.fillText(a,e,n+h/2+i),i+=h,t.fill()})}function Pn(t,e){const n=Oe(t)?t:e;return Oe(n)?se(n,0,1):1}const jt=["left","bottom","top","right"];function An(t,e){const{pointX:n,pointY:r,options:o}=e,s=o.callout,i=s&&s.display&&_n(e,s);if(!i||On(e,s,i))return;if(t.save(),t.beginPath(),!k(t,s))return t.restore();const{separatorStart:l,separatorEnd:d}=Dn(e,i),{sideStart:c,sideEnd:h}=Nn(e,i,l);(s.margin>0||o.borderWidth===0)&&(t.moveTo(l.x,l.y),t.lineTo(d.x,d.y)),t.moveTo(c.x,c.y),t.lineTo(h.x,h.y);const f=O({x:n,y:r},e.getCenterPoint(),v(-e.rotation));t.lineTo(f.x,f.y),t.stroke(),t.restore()}function Dn(t,e){const{x:n,y:r,x2:o,y2:s}=t,i=Tn(t,e);let a,l;return e==="left"||e==="right"?(a={x:n+i,y:r},l={x:a.x,y:s}):(a={x:n,y:r+i},l={x:o,y:a.y}),{separatorStart:a,separatorEnd:l}}function Tn(t,e){const{width:n,height:r,options:o}=t,s=o.callout.margin+o.borderWidth/2;return e==="right"?n+s:e==="bottom"?r+s:-s}function Nn(t,e,n){const{y:r,width:o,height:s,options:i}=t,a=i.callout.start,l=Rn(e,i.callout);let d,c;return e==="left"||e==="right"?(d={x:n.x,y:r+D(s,a)},c={x:d.x+l,y:d.y}):(d={x:n.x+D(o,a),y:n.y},c={x:d.x,y:d.y+l}),{sideStart:d,sideEnd:c}}function Rn(t,e){const n=e.side;return t==="left"||t==="top"?-n:n}function _n(t,e){const n=e.position;return jt.includes(n)?n:In(t,e)}function In(t,e){const{x:n,y:r,x2:o,y2:s,width:i,height:a,pointX:l,pointY:d,centerX:c,centerY:h,rotation:f}=t,b={x:c,y:h},m=e.start,x=D(i,m),g=D(a,m),p=[n,n+x,n+x,o],y=[r+g,s,r,s],j=[];for(let w=0;w<4;w++){const M=O({x:p[w],y:y[w]},b,v(f));j.push({position:jt[w],distance:Ce(M,{x:l,y:d})})}return j.sort((w,M)=>w.distance-M.distance)[0].position}function On(t,e,n){const{pointX:r,pointY:o}=t,s=e.margin;let i=r,a=o;return n==="left"?i+=s:n==="right"?i-=s:n==="top"?a+=s:n==="bottom"&&(a-=s),t.inRange(i,a)}const ze={xScaleID:{min:"xMin",max:"xMax",start:"left",end:"right",startProp:"x",endProp:"x2"},yScaleID:{min:"yMin",max:"yMax",start:"bottom",end:"top",startProp:"y",endProp:"y2"}};function z(t,e,n){return e=typeof e=="number"?e:t.parse(e),it(e)?t.getPixelForValue(e):n}function _(t,e,n){const r=e[n];if(r||n==="scaleID")return r;const o=n.charAt(0),s=Object.values(t).filter(i=>i.axis&&i.axis===o);return s.length?s[0].id:o}function Mt(t,e){if(t){const n=t.options.reverse,r=z(t,e.min,n?e.end:e.start),o=z(t,e.max,n?e.start:e.end);return{start:r,end:o}}}function Ct(t,e){const{chartArea:n,scales:r}=t,o=r[_(r,e,"xScaleID")],s=r[_(r,e,"yScaleID")];let i=n.width/2,a=n.height/2;return o&&(i=z(o,e.xValue,o.left+o.width/2)),s&&(a=z(s,e.yValue,s.top+s.height/2)),{x:i,y:a}}function De(t,e){const n=t.scales,r=n[_(n,e,"xScaleID")],o=n[_(n,e,"yScaleID")];if(!r&&!o)return{};let{left:s,right:i}=r||t.chartArea,{top:a,bottom:l}=o||t.chartArea;const d=Xe(r,{min:e.xMin,max:e.xMax,start:s,end:i});s=d.start,i=d.end;const c=Xe(o,{min:e.yMin,max:e.yMax,start:l,end:a});return a=c.start,l=c.end,{x:s,y:a,x2:i,y2:l,width:i-s,height:l-a,centerX:s+(i-s)/2,centerY:a+(l-a)/2}}function kt(t,e){if(!yt(e)){const n=De(t,e);let r=e.radius;(!r||isNaN(r))&&(r=Math.min(n.width,n.height)/2,e.radius=r);const o=r*2,s=n.centerX+e.xAdjust,i=n.centerY+e.yAdjust;return{x:s-r,y:i-r,x2:s+r,y2:i+r,centerX:s,centerY:i,width:o,height:o,radius:r}}return Ln(t,e)}function En(t,e){const{scales:n,chartArea:r}=t,o=n[e.scaleID],s={x:r.left,y:r.top,x2:r.right,y2:r.bottom};return o?Wn(o,s,e):Yn(n,s,e),s}function vt(t,e){const n=De(t,e);return n.initProperties=X(t,n,e),n.elements=[{type:"label",optionScope:"label",properties:Bn(t,n,e),initProperties:n.initProperties}],n}function Ln(t,e){const n=Ct(t,e),r=e.radius*2;return{x:n.x-e.radius+e.xAdjust,y:n.y-e.radius+e.yAdjust,x2:n.x+e.radius+e.xAdjust,y2:n.y+e.radius+e.yAdjust,centerX:n.x+e.xAdjust,centerY:n.y+e.yAdjust,radius:e.radius,width:r,height:r}}function Xe(t,e){const n=Mt(t,e)||e;return{start:Math.min(n.start,n.end),end:Math.max(n.start,n.end)}}function Wn(t,e,n){const r=z(t,n.value,NaN),o=z(t,n.endValue,r);t.isHorizontal()?(e.x=r,e.x2=o):(e.y=r,e.y2=o)}function Yn(t,e,n){for(const r of Object.keys(ze)){const o=t[_(t,n,r)];if(o){const{min:s,max:i,start:a,end:l,startProp:d,endProp:c}=ze[r],h=Mt(o,{min:n[s],max:n[i],start:o[a],end:o[l]});e[d]=h.start,e[c]=h.end}}}function zn({properties:t,options:e},n,r,o){const{x:s,x2:i,width:a}=t;return Pt({start:s,end:i,borderWidth:e.borderWidth},{position:r.x,padding:{start:o.left,end:o.right},adjust:e.label.xAdjust,size:n.width})}function Xn({properties:t,options:e},n,r,o){const{y:s,y2:i,height:a}=t;return Pt({start:s,end:i,borderWidth:e.borderWidth},{position:r.y,padding:{start:o.top,end:o.bottom},adjust:e.label.yAdjust,size:n.height})}function Pt(t,e){const{start:n,end:r,borderWidth:o}=t,{position:s,padding:{start:i,end:a},adjust:l}=e,d=r-o-n-i-a-e.size;return n+o/2+l+Pe(d,s)}function Bn(t,e,n){const r=n.label;r.backgroundColor="transparent",r.callout.display=!1;const o=Ae(r.position),s=oe(r.padding),i=le(t.ctx,r),a=zn({properties:e,options:n},i,o,s),l=Xn({properties:e,options:n},i,o,s),d=i.width+s.width,c=i.height+s.height;return{x:a,y:l,x2:a+d,y2:l+c,width:d,height:c,centerX:a+d/2,centerY:l+c/2,rotation:r.rotation}}const be=["enter","leave"],Te=be.concat("click");function Hn(t,e,n){e.listened=pt(n,Te,e.listeners),e.moveListened=!1,be.forEach(r=>{L(n[r])&&(e.moveListened=!0)}),(!e.listened||!e.moveListened)&&e.annotations.forEach(r=>{!e.listened&&L(r.click)&&(e.listened=!0),e.moveListened||be.forEach(o=>{L(r[o])&&(e.listened=!0,e.moveListened=!0)})})}function Vn(t,e,n){if(t.listened)switch(e.type){case"mousemove":case"mouseout":return $n(t,e,n);case"click":return Fn(t,e,n)}}function $n(t,e,n){if(!t.moveListened)return;let r;e.type==="mousemove"?r=ve(t.visibleElements,e,n.interaction):r=[];const o=t.hovered;t.hovered=r;const s={state:t,event:e};let i=Be(s,"leave",o,r);return Be(s,"enter",r,o)||i}function Be({state:t,event:e},n,r,o){let s;for(const i of r)o.indexOf(i)<0&&(s=At(i.options[n]||t.listeners[n],i,e)||s);return s}function Fn(t,e,n){const r=t.listeners,o=ve(t.visibleElements,e,n.interaction);let s;for(const i of o)s=At(i.options.click||r.click,i,e)||s;return s}function At(t,e,n){return ke(t,[e.$context,n])===!0}const re=["afterDraw","beforeDraw"];function qn(t,e,n){const r=e.visibleElements;e.hooked=pt(n,re,e.hooks),e.hooked||r.forEach(o=>{e.hooked||re.forEach(s=>{L(o.options[s])&&(e.hooked=!0)})})}function He(t,e,n){if(t.hooked){const r=e.options[n]||t.hooks[n];return ke(r,[e.$context])}}function Un(t,e,n){const r=Zn(t.scales,e,n);let o=Ve(e,r,"min","suggestedMin");o=Ve(e,r,"max","suggestedMax")||o,o&&L(e.handleTickRangeOptions)&&e.handleTickRangeOptions()}function Gn(t,e){for(const n of t)Kn(n,e)}function Ve(t,e,n,r){if(it(e[n])&&!Jn(t.options,n,r)){const o=t[n]!==e[n];return t[n]=e[n],o}}function Jn(t,e,n){return C(t[e])||C(t[n])}function Kn(t,e){for(const n of["scaleID","xScaleID","yScaleID"]){const r=_(e,t,n);r&&!e[r]&&Qn(t,n)&&console.warn(`No scale found with id '${r}' for annotation '${t.id}'`)}}function Qn(t,e){if(e==="scaleID")return!0;const n=e.charAt(0);for(const r of["Min","Max","Value"])if(C(t[n+r]))return!0;return!1}function Zn(t,e,n){const r=e.axis,o=e.id,s=r+"ScaleID",i={min:U(e.min,Number.NEGATIVE_INFINITY),max:U(e.max,Number.POSITIVE_INFINITY)};for(const a of n)a.scaleID===o?$e(a,e,["value","endValue"],i):_(t,a,s)===o&&$e(a,e,[r+"Min",r+"Max",r+"Value"],i);return i}function $e(t,e,n,r){for(const o of n){const s=t[o];if(C(s)){const i=e.parse(s);r.min=Math.min(r.min,i),r.max=Math.max(r.max,i)}}}class H extends I{inRange(e,n,r,o){const{x:s,y:i}=O({x:e,y:n},this.getCenterPoint(o),v(-this.options.rotation));return dt({x:s,y:i},this.getProps(["x","y","x2","y2"],o),r,this.options)}getCenterPoint(e){return E(this,e)}draw(e){e.save(),ae(e,this.getCenterPoint(),this.options.rotation),wt(e,this,this.options),e.restore()}get label(){return this.elements&&this.elements[0]}resolveElementProperties(e,n){return vt(e,n)}}H.id="boxAnnotation";H.defaults={adjustScaleRange:!0,backgroundShadowColor:"transparent",borderCapStyle:"butt",borderDash:[],borderDashOffset:0,borderJoinStyle:"miter",borderRadius:0,borderShadowColor:"transparent",borderWidth:1,display:!0,init:void 0,hitTolerance:0,label:{backgroundColor:"transparent",borderWidth:0,callout:{display:!1},color:"black",content:null,display:!1,drawTime:void 0,font:{family:void 0,lineHeight:void 0,size:void 0,style:void 0,weight:"bold"},height:void 0,hitTolerance:void 0,opacity:void 0,padding:6,position:"center",rotation:void 0,textAlign:"start",textStrokeColor:void 0,textStrokeWidth:0,width:void 0,xAdjust:0,yAdjust:0,z:void 0},rotation:0,shadowBlur:0,shadowOffsetX:0,shadowOffsetY:0,xMax:void 0,xMin:void 0,xScaleID:void 0,yMax:void 0,yMin:void 0,yScaleID:void 0,z:0};H.defaultRoutes={borderColor:"color",backgroundColor:"color"};H.descriptors={label:{_fallback:!0}};class de extends I{inRange(e,n,r,o){return ct({x:e,y:n},{rect:this.getProps(["x","y","x2","y2"],o),center:this.getCenterPoint(o)},r,{rotation:this.rotation,borderWidth:0,hitTolerance:this.options.hitTolerance})}getCenterPoint(e){return E(this,e)}draw(e){const n=this.options;!n.display||!n.content||(sr(e,this),e.save(),ae(e,this.getCenterPoint(),this.rotation),St(e,this,n,this._fitRatio),e.restore())}resolveElementProperties(e,n){const r=er(e,n);if(!r)return{};const{controllerMeta:o,point:s,radius:i}=nr(e,n,r);let a=le(e.ctx,n);const l=rr(a,i);mt(n,l)&&(a={width:a.width*l,height:a.height*l});const{position:d,xAdjust:c,yAdjust:h}=n,f=gt(s,a,{borderWidth:0,position:d,xAdjust:c,yAdjust:h});return{initProperties:X(e,f,n),...f,...o,rotation:n.rotation,_fitRatio:l}}}de.id="doughnutLabelAnnotation";de.defaults={autoFit:!0,autoHide:!0,backgroundColor:"transparent",backgroundShadowColor:"transparent",borderColor:"transparent",borderDash:[],borderDashOffset:0,borderJoinStyle:"miter",borderShadowColor:"transparent",borderWidth:0,color:"black",content:null,display:!0,font:{family:void 0,lineHeight:void 0,size:void 0,style:void 0,weight:void 0},height:void 0,hitTolerance:0,init:void 0,opacity:void 0,position:"center",rotation:0,shadowBlur:0,shadowOffsetX:0,shadowOffsetY:0,spacing:1,textAlign:"center",textStrokeColor:void 0,textStrokeWidth:0,width:void 0,xAdjust:0,yAdjust:0};de.defaultRoutes={};function er(t,e){return t.getSortedVisibleDatasetMetas().reduce(function(n,r){const o=r.controller;return o instanceof Ft&&tr(t,e,r.data)&&(!n||o.innerRadius<n.controller.innerRadius)&&o.options.circumference>=90?r:n},void 0)}function tr(t,e,n){if(!e.autoHide)return!0;for(let r=0;r<n.length;r++)if(!n[r].hidden&&t.getDataVisibility(r))return!0}function nr({chartArea:t},e,n){const{left:r,top:o,right:s,bottom:i}=t,{innerRadius:a,offsetX:l,offsetY:d}=n.controller,c=(r+s)/2+l,h=(o+i)/2+d,f={left:Math.max(c-a,r),right:Math.min(c+a,s),top:Math.max(h-a,o),bottom:Math.min(h+a,i)},b={x:(f.left+f.right)/2,y:(f.top+f.bottom)/2},m=e.spacing+e.borderWidth/2,x=a-m,g=b.y>h,p=g?o+m:i-m,y=or(p,c,h,x);return{controllerMeta:{_centerX:c,_centerY:h,_radius:x,_counterclockwise:g,...y},point:b,radius:Math.min(a,Math.min(f.right-f.left,f.bottom-f.top)/2)}}function rr({width:t,height:e},n){const r=Math.sqrt(Math.pow(t,2)+Math.pow(e,2));return n*2/r}function or(t,e,n,r){const o=Math.pow(n-t,2),s=Math.pow(r,2),i=e*-2,a=Math.pow(e,2)+o-s,l=Math.pow(i,2)-4*a;if(l<=0)return{_startAngle:0,_endAngle:at};const d=(-i-Math.sqrt(l))/2,c=(-i+Math.sqrt(l))/2;return{_startAngle:Ee({x:e,y:n},{x:d,y:t}).angle,_endAngle:Ee({x:e,y:n},{x:c,y:t}).angle}}function sr(t,e){const{_centerX:n,_centerY:r,_radius:o,_startAngle:s,_endAngle:i,_counterclockwise:a,options:l}=e;t.save();const d=k(t,l);t.fillStyle=l.backgroundColor,t.beginPath(),t.arc(n,r,o,s,i,a),t.closePath(),t.fill(),d&&t.stroke(),t.restore()}class G extends I{inRange(e,n,r,o){return ct({x:e,y:n},{rect:this.getProps(["x","y","x2","y2"],o),center:this.getCenterPoint(o)},r,{rotation:this.rotation,borderWidth:this.options.borderWidth,hitTolerance:this.options.hitTolerance})}getCenterPoint(e){return E(this,e)}draw(e){const n=this.options,r=!C(this._visible)||this._visible;!n.display||!n.content||!r||(e.save(),ae(e,this.getCenterPoint(),this.rotation),An(e,this),wt(e,this,n),St(e,ir(this),n),e.restore())}resolveElementProperties(e,n){let r;if(yt(n))r=Ct(e,n);else{const{centerX:a,centerY:l}=De(e,n);r={x:a,y:l}}const o=oe(n.padding),s=le(e.ctx,n),i=gt(r,s,n,o);return{initProperties:X(e,i,n),pointX:r.x,pointY:r.y,...i,rotation:n.rotation}}}G.id="labelAnnotation";G.defaults={adjustScaleRange:!0,backgroundColor:"transparent",backgroundShadowColor:"transparent",borderCapStyle:"butt",borderDash:[],borderDashOffset:0,borderJoinStyle:"miter",borderRadius:0,borderShadowColor:"transparent",borderWidth:0,callout:{borderCapStyle:"butt",borderColor:void 0,borderDash:[],borderDashOffset:0,borderJoinStyle:"miter",borderWidth:1,display:!1,margin:5,position:"auto",side:5,start:"50%"},color:"black",content:null,display:!0,font:{family:void 0,lineHeight:void 0,size:void 0,style:void 0,weight:void 0},height:void 0,hitTolerance:0,init:void 0,opacity:void 0,padding:6,position:"center",rotation:0,shadowBlur:0,shadowOffsetX:0,shadowOffsetY:0,textAlign:"center",textStrokeColor:void 0,textStrokeWidth:0,width:void 0,xAdjust:0,xMax:void 0,xMin:void 0,xScaleID:void 0,xValue:void 0,yAdjust:0,yMax:void 0,yMin:void 0,yScaleID:void 0,yValue:void 0,z:0};G.defaultRoutes={borderColor:"color"};function ir({x:t,y:e,width:n,height:r,options:o}){const s=o.borderWidth/2,i=oe(o.padding);return{x:t+i.left+s,y:e+i.top+s,width:n-i.left-i.right-o.borderWidth,height:r-i.top-i.bottom-o.borderWidth}}const Ne=(t,e,n)=>({x:t.x+n*(e.x-t.x),y:t.y+n*(e.y-t.y)}),ye=(t,e,n)=>Ne(e,n,Math.abs((t-e.y)/(n.y-e.y))).x,Fe=(t,e,n)=>Ne(e,n,Math.abs((t-e.x)/(n.x-e.x))).y,q=t=>t*t,ar=(t,e,{x:n,y:r,x2:o,y2:s},i)=>i==="y"?{start:Math.min(r,s),end:Math.max(r,s),value:e}:{start:Math.min(n,o),end:Math.max(n,o),value:t},qe=(t,e,n,r)=>(1-r)*(1-r)*t+2*(1-r)*r*e+r*r*n,pe=(t,e,n,r)=>({x:qe(t.x,e.x,n.x,r),y:qe(t.y,e.y,n.y,r)}),Ue=(t,e,n,r)=>2*(1-r)*(e-t)+2*r*(n-e),Ge=(t,e,n,r)=>-Math.atan2(Ue(t.x,e.x,n.x,r),Ue(t.y,e.y,n.y,r))+.5*S;class J extends I{inRange(e,n,r,o){const s=(this.options.borderWidth+this.options.hitTolerance)/2;if(r!=="x"&&r!=="y"){const i={mouseX:e,mouseY:n},{path:a,ctx:l}=this;if(a){k(l,this.options),l.lineWidth+=this.options.hitTolerance;const{chart:c}=this.$context,h=e*c.currentDevicePixelRatio,f=n*c.currentDevicePixelRatio,b=l.isPointInStroke(a,h,f)||xe(this,i,o);return l.restore(),b}const d=q(s);return ur(this,i,d,o)||xe(this,i,o)}return lr(this,{mouseX:e,mouseY:n},r,{hitSize:s,useFinalPosition:o})}getCenterPoint(e){return E(this,e)}draw(e){const{x:n,y:r,x2:o,y2:s,cp:i,options:a}=this;if(e.save(),!k(e,a))return e.restore();B(e,a);const l=Math.sqrt(Math.pow(o-n,2)+Math.pow(s-r,2));if(a.curve&&i)return xr(e,this,i,l),e.restore();const{startOpts:d,endOpts:c,startAdjust:h,endAdjust:f}=Dt(this),b=Math.atan2(s-r,o-n);e.translate(n,r),e.rotate(b),e.beginPath(),e.moveTo(0+h,0),e.lineTo(l-f,0),e.shadowColor=a.borderShadowColor,e.stroke(),we(e,0,h,d),we(e,l,-f,c),e.restore()}get label(){return this.elements&&this.elements[0]}resolveElementProperties(e,n){const r=En(e,n),{x:o,y:s,x2:i,y2:a}=r,l=dr(r,e.chartArea),d=l?cr({x:o,y:s},{x:i,y:a},e.chartArea):{x:o,y:s,x2:i,y2:a,width:Math.abs(i-o),height:Math.abs(a-s)};if(d.centerX=(i+o)/2,d.centerY=(a+s)/2,d.initProperties=X(e,d,n),n.curve){const h={x:d.x,y:d.y},f={x:d.x2,y:d.y2};d.cp=pr(d,n,Ce(h,f))}const c=hr(e,d,n.label);return c._visible=l,d.elements=[{type:"label",optionScope:"label",properties:c,initProperties:d.initProperties}],d}}J.id="lineAnnotation";const Je={backgroundColor:void 0,backgroundShadowColor:void 0,borderColor:void 0,borderDash:void 0,borderDashOffset:void 0,borderShadowColor:void 0,borderWidth:void 0,display:void 0,fill:void 0,length:void 0,shadowBlur:void 0,shadowOffsetX:void 0,shadowOffsetY:void 0,width:void 0};J.defaults={adjustScaleRange:!0,arrowHeads:{display:!1,end:Object.assign({},Je),fill:!1,length:12,start:Object.assign({},Je),width:6},borderDash:[],borderDashOffset:0,borderShadowColor:"transparent",borderWidth:2,curve:!1,controlPoint:{y:"-50%"},display:!0,endValue:void 0,init:void 0,hitTolerance:0,label:{backgroundColor:"rgba(0,0,0,0.8)",backgroundShadowColor:"transparent",borderCapStyle:"butt",borderColor:"black",borderDash:[],borderDashOffset:0,borderJoinStyle:"miter",borderRadius:6,borderShadowColor:"transparent",borderWidth:0,callout:Object.assign({},G.defaults.callout),color:"#fff",content:null,display:!1,drawTime:void 0,font:{family:void 0,lineHeight:void 0,size:void 0,style:void 0,weight:"bold"},height:void 0,hitTolerance:void 0,opacity:void 0,padding:6,position:"center",rotation:0,shadowBlur:0,shadowOffsetX:0,shadowOffsetY:0,textAlign:"center",textStrokeColor:void 0,textStrokeWidth:0,width:void 0,xAdjust:0,yAdjust:0,z:void 0},scaleID:void 0,shadowBlur:0,shadowOffsetX:0,shadowOffsetY:0,value:void 0,xMax:void 0,xMin:void 0,xScaleID:void 0,yMax:void 0,yMin:void 0,yScaleID:void 0,z:0};J.descriptors={arrowHeads:{start:{_fallback:!0},end:{_fallback:!0},_fallback:!0}};J.defaultRoutes={borderColor:"color"};function lr(t,{mouseX:e,mouseY:n},r,{hitSize:o,useFinalPosition:s}){const i=ar(e,n,t.getProps(["x","y","x2","y2"],s),r);return lt(i,o)||xe(t,{mouseX:e,mouseY:n},s,r)}function dr({x:t,y:e,x2:n,y2:r},{top:o,right:s,bottom:i,left:a}){return!(t<a&&n<a||t>s&&n>s||e<o&&r<o||e>i&&r>i)}function Ke({x:t,y:e},n,{top:r,right:o,bottom:s,left:i}){return t<i&&(e=Fe(i,{x:t,y:e},n),t=i),t>o&&(e=Fe(o,{x:t,y:e},n),t=o),e<r&&(t=ye(r,{x:t,y:e},n),e=r),e>s&&(t=ye(s,{x:t,y:e},n),e=s),{x:t,y:e}}function cr(t,e,n){const{x:r,y:o}=Ke(t,e,n),{x:s,y:i}=Ke(e,t,n);return{x:r,y:o,x2:s,y2:i,width:Math.abs(s-r),height:Math.abs(i-o)}}function ur(t,{mouseX:e,mouseY:n},r=R,o){const{x:s,y:i,x2:a,y2:l}=t.getProps(["x","y","x2","y2"],o),d=a-s,c=l-i,h=q(d)+q(c),f=h===0?-1:((e-s)*d+(n-i)*c)/h;let b,m;return f<0?(b=s,m=i):f>1?(b=a,m=l):(b=s+f*d,m=i+f*c),q(e-b)+q(n-m)<=r}function xe(t,{mouseX:e,mouseY:n},r,o){const s=t.label;return s.options.display&&s.inRange(e,n,o,r)}function hr(t,e,n){const r=n.borderWidth,o=oe(n.padding),s=le(t.ctx,n),i=s.width+o.width+r,a=s.height+o.height+r;return gr(e,n,{width:i,height:a,padding:o},t.chartArea)}function fr(t){const{x:e,y:n,x2:r,y2:o}=t,s=Math.atan2(o-n,r-e);return s>S/2?s-S:s<S/-2?s+S:s}function gr(t,e,n,r){const{width:o,height:s,padding:i}=n,{xAdjust:a,yAdjust:l}=e,d={x:t.x,y:t.y},c={x:t.x2,y:t.y2},h=e.rotation==="auto"?fr(t):v(e.rotation),f=mr(o,s,h),b=br(t,e,{labelSize:f,padding:i},r),m=t.cp?pe(d,t.cp,c,b):Ne(d,c,b),x={size:f.w,min:r.left,max:r.right,padding:i.left},g={size:f.h,min:r.top,max:r.bottom,padding:i.top},p=Ze(m.x,x)+a,y=Ze(m.y,g)+l;return{x:p-o/2,y:y-s/2,x2:p+o/2,y2:y+s/2,centerX:p,centerY:y,pointX:m.x,pointY:m.y,width:o,height:s,rotation:Ut(h)}}function mr(t,e,n){const r=Math.cos(n),o=Math.sin(n);return{w:Math.abs(t*r)+Math.abs(e*o),h:Math.abs(t*o)+Math.abs(e*r)}}function br(t,e,n,r){let o;const s=yr(t,r);return e.position==="start"?o=Qe({w:t.x2-t.x,h:t.y2-t.y},n,e,s):e.position==="end"?o=1-Qe({w:t.x-t.x2,h:t.y-t.y2},n,e,s):o=Pe(1,e.position),o}function Qe(t,e,n,r){const{labelSize:o,padding:s}=e,i=t.w*r.dx,a=t.h*r.dy,l=i>0&&(o.w/2+s.left-r.x)/i,d=a>0&&(o.h/2+s.top-r.y)/a;return se(Math.max(l,d),0,.25)}function yr(t,e){const{x:n,x2:r,y:o,y2:s}=t,i=Math.min(o,s)-e.top,a=Math.min(n,r)-e.left,l=e.bottom-Math.max(o,s),d=e.right-Math.max(n,r);return{x:Math.min(a,d),y:Math.min(i,l),dx:a<=d?1:-1,dy:i<=l?1:-1}}function Ze(t,e){const{size:n,min:r,max:o,padding:s}=e,i=n/2;return n>o-r?(o+r)/2:(r>=t-s-i&&(t=r+s+i),o<=t+s+i&&(t=o-s-i),t)}function Dt(t){const e=t.options,n=e.arrowHeads&&e.arrowHeads.start,r=e.arrowHeads&&e.arrowHeads.end;return{startOpts:n,endOpts:r,startAdjust:et(t,n),endAdjust:et(t,r)}}function et(t,e){if(!e||!e.display)return 0;const{length:n,width:r}=e,o=t.options.borderWidth/2,s={x:n,y:r+o};return Math.abs(ye(0,s,{x:0,y:o}))}function we(t,e,n,r){if(!r||!r.display)return;const{length:o,width:s,fill:i,backgroundColor:a,borderColor:l}=r,d=Math.abs(e-o)+n;t.beginPath(),B(t,r),k(t,r),t.moveTo(d,-s),t.lineTo(e+n,0),t.lineTo(d,s),i===!0?(t.fillStyle=a||l,t.closePath(),t.fill(),t.shadowColor="transparent"):t.shadowColor=r.borderShadowColor,t.stroke()}function pr(t,e,n){const{x:r,y:o,x2:s,y2:i,centerX:a,centerY:l}=t,d=Math.atan2(i-o,s-r),c=Ae(e.controlPoint,0),h={x:a+D(n,c.x,!1),y:l+D(n,c.y,!1)};return O(h,{x:a,y:l},d)}function tt(t,{x:e,y:n},{angle:r,adjust:o},s){!s||!s.display||(t.save(),t.translate(e,n),t.rotate(r),we(t,0,-o,s),t.restore())}function xr(t,e,n,r){const{x:o,y:s,x2:i,y2:a,options:l}=e,{startOpts:d,endOpts:c,startAdjust:h,endAdjust:f}=Dt(e),b={x:o,y:s},m={x:i,y:a},x=Ge(b,n,m,0),g=Ge(b,n,m,1)-S,p=pe(b,n,m,h/r),y=pe(b,n,m,1-f/r),j=new Path2D;t.beginPath(),j.moveTo(p.x,p.y),j.quadraticCurveTo(n.x,n.y,y.x,y.y),t.shadowColor=l.borderShadowColor,t.stroke(j),e.path=j,e.ctx=t,tt(t,p,{angle:x,adjust:h},d),tt(t,y,{angle:g,adjust:f},c)}class K extends I{inRange(e,n,r,o){const s=this.options.rotation,i=(this.options.borderWidth+this.options.hitTolerance)/2;if(r!=="x"&&r!=="y")return wr({x:e,y:n},this.getProps(["width","height","centerX","centerY"],o),s,i);const{x:a,y:l,x2:d,y2:c}=this.getProps(["x","y","x2","y2"],o),h=r==="y"?{start:l,end:c}:{start:a,end:d},f=O({x:e,y:n},this.getCenterPoint(o),v(-s));return f[r]>=h.start-i-R&&f[r]<=h.end+i+R}getCenterPoint(e){return E(this,e)}draw(e){const{width:n,height:r,centerX:o,centerY:s,options:i}=this;e.save(),ae(e,this.getCenterPoint(),i.rotation),B(e,this.options),e.beginPath(),e.fillStyle=i.backgroundColor;const a=k(e,i);e.ellipse(o,s,r/2,n/2,S/2,0,2*S),e.fill(),a&&(e.shadowColor=i.borderShadowColor,e.stroke()),e.restore()}get label(){return this.elements&&this.elements[0]}resolveElementProperties(e,n){return vt(e,n)}}K.id="ellipseAnnotation";K.defaults={adjustScaleRange:!0,backgroundShadowColor:"transparent",borderDash:[],borderDashOffset:0,borderShadowColor:"transparent",borderWidth:1,display:!0,hitTolerance:0,init:void 0,label:Object.assign({},H.defaults.label),rotation:0,shadowBlur:0,shadowOffsetX:0,shadowOffsetY:0,xMax:void 0,xMin:void 0,xScaleID:void 0,yMax:void 0,yMin:void 0,yScaleID:void 0,z:0};K.defaultRoutes={borderColor:"color",backgroundColor:"color"};K.descriptors={label:{_fallback:!0}};function wr(t,e,n,r){const{width:o,height:s,centerX:i,centerY:a}=e,l=o/2,d=s/2;if(l<=0||d<=0)return!1;const c=v(n||0),h=Math.cos(c),f=Math.sin(c),b=Math.pow(h*(t.x-i)+f*(t.y-a),2),m=Math.pow(f*(t.x-i)-h*(t.y-a),2);return b/Math.pow(l+r,2)+m/Math.pow(d+r,2)<=1.0001}class ce extends I{inRange(e,n,r,o){const{x:s,y:i,x2:a,y2:l,width:d}=this.getProps(["x","y","x2","y2","width"],o),c=(this.options.borderWidth+this.options.hitTolerance)/2;return r!=="x"&&r!=="y"?gn({x:e,y:n},this.getCenterPoint(o),d/2,c):lt(r==="y"?{start:i,end:l,value:n}:{start:s,end:a,value:e},c)}getCenterPoint(e){return E(this,e)}draw(e){const n=this.options,r=n.borderWidth;if(n.radius<.1)return;e.save(),e.fillStyle=n.backgroundColor,B(e,n);const o=k(e,n);jn(e,this,this.centerX,this.centerY),o&&!ie(n.pointStyle)&&(e.shadowColor=n.borderShadowColor,e.stroke()),e.restore(),n.borderWidth=r}resolveElementProperties(e,n){const r=kt(e,n);return r.initProperties=X(e,r,n),r}}ce.id="pointAnnotation";ce.defaults={adjustScaleRange:!0,backgroundShadowColor:"transparent",borderDash:[],borderDashOffset:0,borderShadowColor:"transparent",borderWidth:1,display:!0,hitTolerance:0,init:void 0,pointStyle:"circle",radius:10,rotation:0,shadowBlur:0,shadowOffsetX:0,shadowOffsetY:0,xAdjust:0,xMax:void 0,xMin:void 0,xScaleID:void 0,xValue:void 0,yAdjust:0,yMax:void 0,yMin:void 0,yScaleID:void 0,yValue:void 0,z:0};ce.defaultRoutes={borderColor:"color",backgroundColor:"color"};class ue extends I{inRange(e,n,r,o){if(r!=="x"&&r!=="y")return this.options.radius>=.1&&this.elements.length>1&&jr(this.elements,e,n,o);const s=O({x:e,y:n},this.getCenterPoint(o),v(-this.options.rotation)),i=this.elements.map(d=>r==="y"?d.bY:d.bX),a=Math.min(...i),l=Math.max(...i);return s[r]>=a&&s[r]<=l}getCenterPoint(e){return E(this,e)}draw(e){const{elements:n,options:r}=this;e.save(),e.beginPath(),e.fillStyle=r.backgroundColor,B(e,r);const o=k(e,r);let s=!0;for(const i of n)s?(e.moveTo(i.x,i.y),s=!1):e.lineTo(i.x,i.y);e.closePath(),e.fill(),o&&(e.shadowColor=r.borderShadowColor,e.stroke()),e.restore()}resolveElementProperties(e,n){const r=kt(e,n),{sides:o,rotation:s}=n,i=[],a=2*S/o;let l=s*st;for(let d=0;d<o;d++,l+=a){const c=Sr(r,n,l);c.initProperties=X(e,r,n),i.push(c)}return r.elements=i,r}}ue.id="polygonAnnotation";ue.defaults={adjustScaleRange:!0,backgroundShadowColor:"transparent",borderCapStyle:"butt",borderDash:[],borderDashOffset:0,borderJoinStyle:"miter",borderShadowColor:"transparent",borderWidth:1,display:!0,hitTolerance:0,init:void 0,point:{radius:0},radius:10,rotation:0,shadowBlur:0,shadowOffsetX:0,shadowOffsetY:0,sides:3,xAdjust:0,xMax:void 0,xMin:void 0,xScaleID:void 0,xValue:void 0,yAdjust:0,yMax:void 0,yMin:void 0,yScaleID:void 0,yValue:void 0,z:0};ue.defaultRoutes={borderColor:"color",backgroundColor:"color"};function Sr({centerX:t,centerY:e},{radius:n,borderWidth:r,hitTolerance:o},s){const i=(r+o)/2,a=Math.sin(s),l=Math.cos(s),d={x:t+a*n,y:e-l*n};return{type:"point",optionScope:"point",properties:{x:d.x,y:d.y,centerX:d.x,centerY:d.y,bX:t+a*(n+i),bY:e-l*(n+i)}}}function jr(t,e,n,r){let o=!1,s=t[t.length-1].getProps(["bX","bY"],r);for(const i of t){const a=i.getProps(["bX","bY"],r);a.bY>n!=s.bY>n&&e<(s.bX-a.bX)*(n-a.bY)/(s.bY-a.bY)+a.bX&&(o=!o),s=a}return o}const A={box:H,doughnutLabel:de,ellipse:K,label:G,line:J,point:ce,polygon:ue};Object.keys(A).forEach(t=>{Gt.describe(`elements.${A[t].id}`,{_fallback:"plugins.annotation.common"})});const Mr={update:Object.assign},Cr=Te.concat(re),nt=(t,e)=>W(e)?je(t,e):t,Se=t=>t==="color"||t==="font";function Re(t="line"){return A[t]?t:(console.warn(`Unknown annotation type: '${t}', defaulting to 'line'`),"line")}function kr(t,e,n,r){const o=Pr(t,n.animations,r),s=e.annotations,i=Tr(e.elements,s);for(let a=0;a<s.length;a++){const l=s[a],d=Tt(i,a,l.type),c=l.setContext(Dr(t,d,i,l)),h=d.resolveElementProperties(t,c);h.skip=vr(h),"elements"in h&&(Ar(d,h.elements,c,o),delete h.elements),C(d.x)||Object.assign(d,h),Object.assign(d,h.initProperties),h.options=Nt(c),o.update(d,h)}}function vr(t){return isNaN(t.x)||isNaN(t.y)}function Pr(t,e,n){return n==="reset"||n==="none"||n==="resize"?Mr:new qt(t,e)}function Ar(t,e,n,r){const o=t.elements||(t.elements=[]);o.length=e.length;for(let s=0;s<e.length;s++){const i=e[s],a=i.properties,l=Tt(o,s,i.type,i.initProperties),d=n[i.optionScope].override(i);a.options=Nt(d),r.update(l,a)}}function Tt(t,e,n,r){const o=A[Re(n)];let s=t[e];return(!s||!(s instanceof o))&&(s=t[e]=new o,Object.assign(s,r)),s}function Nt(t){const e=A[Re(t.type)],n={};n.id=t.id,n.type=t.type,n.drawTime=t.drawTime,Object.assign(n,je(t,e.defaults),je(t,e.defaultRoutes));for(const r of Cr)n[r]=t[r];return n}function je(t,e){const n={};for(const r of Object.keys(e)){const o=e[r],s=t[r];Se(r)&&Y(s)?n[r]=s.map(i=>nt(i,o)):n[r]=nt(s,o)}return n}function Dr(t,e,n,r){return e.$context||(e.$context=Object.assign(Object.create(t.getContext()),{element:e,get elements(){return n.filter(o=>o&&o.options)},id:r.id,type:"annotation"}))}function Tr(t,e){const n=e.length,r=t.length;if(r<n){const o=n-r;t.splice(r,0,...new Array(o))}else r>n&&t.splice(n,r-n);return t}var Nr="3.1.0";const P=new Map,rt=t=>t.type!=="doughnutLabel",Rr=Te.concat(re);var _r={id:"annotation",version:Nr,beforeRegister(){mn("chart.js","4.0",te.version)},afterRegister(){te.register(A)},afterUnregister(){te.unregister(A)},beforeInit(t){P.set(t,{annotations:[],elements:[],visibleElements:[],listeners:{},listened:!1,moveListened:!1,hooks:{},hooked:!1,hovered:[]})},beforeUpdate(t,e,n){const r=P.get(t),o=r.annotations=[];let s=n.annotations;W(s)?Object.keys(s).forEach(i=>{const a=s[i];W(a)&&(a.id=i,o.push(a))}):Y(s)&&o.push(...s),Gn(o.filter(rt),t.scales)},afterDataLimits(t,e){const n=P.get(t);Un(t,e.scale,n.annotations.filter(rt).filter(r=>r.display&&r.adjustScaleRange))},afterUpdate(t,e,n){const r=P.get(t);Hn(t,r,n),kr(t,r,n,e.mode),r.visibleElements=r.elements.filter(o=>!o.skip&&o.options.display),qn(t,r,n)},beforeDatasetsDraw(t,e,n){F(t,"beforeDatasetsDraw",n.clip)},afterDatasetsDraw(t,e,n){F(t,"afterDatasetsDraw",n.clip)},beforeDatasetDraw(t,e,n){F(t,e.index,n.clip)},beforeDraw(t,e,n){F(t,"beforeDraw",n.clip)},afterDraw(t,e,n){F(t,"afterDraw",n.clip)},beforeEvent(t,e,n){const r=P.get(t);Vn(r,e.event,n)&&(e.changed=!0)},afterDestroy(t){P.delete(t)},getAnnotations(t){const e=P.get(t);return e?e.elements:[]},_getAnnotationElementsAtEventForMode(t,e,n){return ve(t,e,n)},defaults:{animations:{numbers:{properties:["x","y","x2","y2","width","height","centerX","centerY","pointX","pointY","radius"],type:"number"},colors:{properties:["backgroundColor","borderColor"],type:"color"}},clip:!0,interaction:{mode:void 0,axis:void 0,intersect:void 0},common:{drawTime:"afterDatasetsDraw",init:!1,label:{}}},descriptors:{_indexable:!1,_scriptable:t=>!Rr.includes(t)&&t!=="init",annotations:{_allKeys:!1,_fallback:(t,e)=>`elements.${A[Re(e.type)].id}`},interaction:{_fallback:!0},common:{label:{_indexable:Se,_fallback:!0},_indexable:Se}},additionalOptionScopes:[""]};function F(t,e,n){const{ctx:r,chartArea:o}=t,s=P.get(t);n&&Bt(r,o);const i=Ir(s.visibleElements,e).sort((a,l)=>a.element.options.z-l.element.options.z);for(const a of i)Or(r,o,s,a);n&&Ht(r)}function Ir(t,e){const n=[];for(const r of t)if(r.options.drawTime===e&&n.push({element:r,main:!0}),r.elements&&r.elements.length)for(const o of r.elements)o.options.display&&o.options.drawTime===e&&n.push({element:o});return n}function Or(t,e,n,r){const o=r.element;r.main?(He(n,o,"beforeDraw"),o.draw(t,e),He(n,o,"afterDraw")):o.draw(t,e)}te.register(Kt,Qt,Zt,en,tn,nn,rn,on,_r);async function ot(t,e){const n=await fetch(t,{headers:{"Content-Type":"application/json"},...e});if(!n.ok){const r=await n.json().catch(()=>({})),o=r.detail||r.message||`Request failed (${n.status})`;throw new Error(o)}if(n.status!==204)return n.json()}const Er=[{value:"3",label:"3 days"},{value:"5",label:"5 days"},{value:"7",label:"7 days"}];function ee(t){var s;if(!t)return"—";const e=new Date(t.start),n=e.toLocaleTimeString("en-GB",{hour:"2-digit",minute:"2-digit"}),r=e.toLocaleDateString("en-GB",{weekday:"short",day:"numeric",month:"short"});return`${((s=t.price_pred_pence)==null?void 0:s.toFixed(2))??"—"} p/kWh • ${r} ${n}`}function Lr(t){return t?new Date(t).toLocaleString("en-GB",{weekday:"short",hour:"2-digit",minute:"2-digit",day:"numeric",month:"short"}):"—"}function Wr(t){const e=t.map(r=>r.price_pred_pence).filter(r=>typeof r=="number");if(!e.length)return null;const n=e.reduce((r,o)=>r+o,0);return Number((n/e.length).toFixed(2))}function Hr(){const[t,e]=Q.useState("7"),{data:n,isLoading:r,isFetching:o,error:s,refetch:i}=_e({queryKey:["agile-forecast",t],queryFn:()=>ot(`/api/energy/agile-forecast?days=${t}`),refetchInterval:3e5}),{data:a}=_e({queryKey:["agile-bands"],queryFn:()=>ot("/api/settings/agile-solo-strategy/bands"),refetchInterval:3e5}),l=a==null?void 0:a.bands.find(g=>g.sort_order===5),d=typeof(l==null?void 0:l.min_price)=="number"?l.min_price:19,c=typeof(l==null?void 0:l.max_price)=="number"?l.max_price:30,h=Q.useMemo(()=>{var g;return(g=n==null?void 0:n.days)!=null&&g.length?n.days.flatMap(p=>p.slots.filter(y=>typeof y.price_pred_pence=="number").map(y=>({timestamp:y.start,price:y.price_pred_pence}))):[]},[n]),f=Q.useMemo(()=>h.length?{labels:h.map(g=>new Date(g.timestamp)),datasets:[{label:"Predicted price",data:h.map(g=>g.price),borderColor:"rgba(59, 130, 246, 1)",backgroundColor:"rgba(59, 130, 246, 0.1)",tension:.35,pointRadius:0}]}:null,[h]),b=Q.useMemo(()=>({responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1},tooltip:{callbacks:{label:g=>{var y;return`${(typeof((y=g.parsed)==null?void 0:y.y)=="number"?g.parsed.y:0).toFixed(2)} p/kWh`}}},annotation:{annotations:{line19p:{type:"line",yMin:d,yMax:d,borderColor:"rgba(234, 179, 8, 0.7)",borderWidth:2,borderDash:[6,6],label:{display:!0,content:`Band 5 Min: ${Number(d).toFixed(1)}p/kWh`,position:"end",backgroundColor:"rgba(234, 179, 8, 0.2)",color:"rgba(234, 179, 8, 1)",font:{size:11},padding:4}},line30p:{type:"line",yMin:c,yMax:c,borderColor:"rgba(239, 68, 68, 0.7)",borderWidth:2,borderDash:[6,6],label:{display:!0,content:`Band 5 Max: ${Number(c).toFixed(1)}p/kWh`,position:"end",backgroundColor:"rgba(239, 68, 68, 0.2)",color:"rgba(239, 68, 68, 1)",font:{size:11},padding:4}}}}},scales:{x:{type:"time",time:{unit:"hour"},ticks:{maxRotation:0},grid:{color:"rgba(255,255,255,0.05)"}},y:{beginAtZero:!1,title:{display:!0,text:"p/kWh"},grid:{color:"rgba(255,255,255,0.05)"}}}}),[d,c]),m=(n==null?void 0:n.days)??[],x=n==null?void 0:n.summary;return u.jsxs("div",{className:"space-y-8",children:[u.jsxs("div",{className:"flex flex-col gap-2",children:[u.jsxs("div",{className:"flex items-center gap-3 text-sm uppercase tracking-widest text-blue-300",children:[u.jsx(Rt,{className:"h-5 w-5"}),u.jsx("span",{children:"Agile Predict"})]}),u.jsx("h1",{className:"text-2xl font-semibold",children:"7-Day Agile Forecast"}),u.jsx("p",{className:"text-sm text-gray-400",children:"Ingested directly from AgilePredict.com with daily refresh windows at 04:30. Use the forecast to pre-stage automation rules, power plans, and miner bands."})]}),u.jsxs(T,{children:[u.jsxs(he,{className:"flex flex-col gap-4 border-b border-border/50 bg-muted/10 md:flex-row md:items-center md:justify-between",children:[u.jsxs("div",{children:[u.jsx("p",{className:"text-xs uppercase tracking-widest text-blue-300",children:"Forecast Controls"}),u.jsxs(fe,{className:"text-xl",children:["Region ",(n==null?void 0:n.region)??"—"]}),u.jsxs("p",{className:"text-sm text-muted-foreground",children:["Last updated ",Lr(n==null?void 0:n.forecast_created_at)]})]}),u.jsxs("div",{className:"flex flex-col gap-3 sm:flex-row sm:items-center",children:[u.jsxs(_t,{value:t,onValueChange:e,children:[u.jsx(It,{className:"w-full sm:w-32",children:u.jsx(Ot,{placeholder:"Days"})}),u.jsx(Et,{children:Er.map(g=>u.jsx(Lt,{value:g.value,children:g.label},g.value))})]}),u.jsxs(Wt,{onClick:()=>i(),variant:"secondary",disabled:o,className:"gap-2",children:[o?u.jsx(Le,{className:"h-4 w-4 animate-spin"}):u.jsx(Yt,{className:"h-4 w-4"}),"Refresh"]})]})]}),u.jsxs(N,{className:"py-6",children:[s&&u.jsxs("div",{className:"flex items-center gap-3 rounded-md border border-red-500/40 bg-red-500/10 px-4 py-3 text-sm text-red-200",children:[u.jsx(zt,{className:"h-4 w-4"}),u.jsx("span",{children:s instanceof Error?s.message:"Unable to load Agile Predict forecast."})]}),r?u.jsxs("div",{className:"flex items-center gap-3 text-muted-foreground",children:[u.jsx(Le,{className:"h-4 w-4 animate-spin"}),"Loading forecast…"]}):null]})]}),x&&u.jsxs("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-4",children:[u.jsx(T,{children:u.jsxs(N,{className:"p-5",children:[u.jsx("p",{className:"text-xs uppercase text-gray-500",children:"Average price"}),u.jsx("p",{className:"mt-2 text-3xl font-semibold",children:x.average_price_pence?`${x.average_price_pence.toFixed(2)} p/kWh`:"—"})]})}),u.jsx(T,{children:u.jsxs(N,{className:"p-5",children:[u.jsx("p",{className:"text-xs uppercase text-gray-500",children:"Total slots"}),u.jsx("p",{className:"mt-2 text-3xl font-semibold",children:x.slot_count})]})}),u.jsx(T,{children:u.jsxs(N,{className:"p-5",children:[u.jsx("p",{className:"text-xs uppercase text-gray-500",children:"Cheapest slot"}),u.jsx("p",{className:"mt-2 text-sm text-muted-foreground",children:ee(x.cheapest_slot)})]})}),u.jsx(T,{children:u.jsxs(N,{className:"p-5",children:[u.jsx("p",{className:"text-xs uppercase text-gray-500",children:"Most expensive"}),u.jsx("p",{className:"mt-2 text-sm text-muted-foreground",children:ee(x.most_expensive_slot)})]})})]}),f&&u.jsxs(T,{children:[u.jsxs(he,{children:[u.jsx(fe,{children:"Price trajectory"}),u.jsx("p",{className:"text-sm text-muted-foreground",children:"Predicted half-hour slots over the selected window."})]}),u.jsx(N,{children:u.jsx("div",{className:"h-80",children:u.jsx(Jt,{data:f,options:b,"aria-label":"Agile forecast chart"})})})]}),f&&m.length>0&&u.jsx("div",{className:"rounded-md border border-border/40 bg-muted/5 p-4",children:u.jsx("div",{className:"flex divide-x divide-border/30",children:m.map(g=>{const p=new Date(g.date).toLocaleDateString("en-GB",{weekday:"long"});return u.jsxs("div",{className:"flex-1 px-3 text-center text-sm",children:[u.jsx("div",{className:"mb-2 h-4 w-px bg-blue-500/70 mx-auto"}),u.jsx("p",{className:"font-medium text-gray-200",children:p}),u.jsx("p",{className:"text-xs text-muted-foreground",children:new Date(g.date).toLocaleDateString("en-GB",{day:"numeric",month:"short"})})]},g.date)})})}),u.jsxs("div",{className:"space-y-4",children:[u.jsxs("div",{className:"flex items-center gap-3 text-sm uppercase tracking-widest text-blue-300",children:[u.jsx(ln,{className:"h-5 w-5"}),u.jsx("span",{children:"Daily breakdown"})]}),u.jsx("div",{className:"grid gap-4 lg:grid-cols-2",children:m.map(g=>{const p=Wr(g.slots),y=[...g.slots].sort((w,M)=>(w.price_pred_pence??1/0)-(M.price_pred_pence??1/0))[0],j=[...g.slots].sort((w,M)=>(M.price_pred_pence??-1/0)-(w.price_pred_pence??-1/0))[0];return u.jsxs(T,{className:"border-border/60",children:[u.jsxs(he,{children:[u.jsx(fe,{className:"text-lg",children:new Date(g.date).toLocaleDateString("en-GB",{weekday:"long",day:"numeric",month:"long"})}),u.jsxs("p",{className:"text-sm text-muted-foreground",children:["Average ",p?`${p.toFixed(2)} p/kWh`:"—"]})]}),u.jsxs(N,{className:"space-y-4",children:[u.jsxs("div",{className:"grid gap-3 md:grid-cols-2",children:[u.jsxs("div",{className:"rounded-md border border-emerald-500/40 bg-emerald-500/5 p-3 text-sm",children:[u.jsxs("div",{className:"flex items-center gap-2 text-emerald-300",children:[u.jsx(sn,{className:"h-4 w-4"}),"Cheapest"]}),u.jsx("p",{className:"mt-1 text-muted-foreground",children:ee(y)})]}),u.jsxs("div",{className:"rounded-md border border-rose-500/40 bg-rose-500/5 p-3 text-sm",children:[u.jsxs("div",{className:"flex items-center gap-2 text-rose-300",children:[u.jsx(an,{className:"h-4 w-4"}),"Expensive"]}),u.jsx("p",{className:"mt-1 text-muted-foreground",children:ee(j)})]})]}),u.jsx("div",{className:"grid gap-2 sm:grid-cols-2",children:g.slots.slice(0,8).map(w=>{var M;return u.jsxs("div",{className:Xt("flex items-center justify-between rounded-md border px-3 py-2 text-sm",(w.price_pred_pence??0)<=(p??0)?"border-emerald-500/40 bg-emerald-500/5":"border-amber-500/40 bg-amber-500/5"),children:[u.jsx("span",{children:new Date(w.start).toLocaleTimeString("en-GB",{hour:"2-digit",minute:"2-digit"})}),u.jsxs("span",{className:"font-medium",children:[(M=w.price_pred_pence)==null?void 0:M.toFixed(2),"p"]})]},w.start)})}),g.slots.length>8&&u.jsxs("p",{className:"text-xs text-muted-foreground",children:["+",g.slots.length-8," more half-hour slots"]})]})]},g.date)})})]})]})}export{Hr as default};
