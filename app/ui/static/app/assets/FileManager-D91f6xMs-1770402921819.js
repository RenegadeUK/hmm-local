import{c as ee,r as d,ah as L,j as o,X as oe,K as Me,R as ie,as as Se,S as Ce}from"./index-C0ajRcBp-1770402921819.js";import{C as Ee}from"./chevron-right-B-hyQ7vs-1770402921819.js";import{C as Fe}from"./copy-JhTd73EL-1770402921819.js";import{D as Pe}from"./download-C4qc6M_F-1770402921819.js";import{T as $e}from"./trash-2-BqijOcFj-1770402921819.js";import{S as ke}from"./save-DCE1xdZe-1770402921819.js";/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const se=ee("FileCode",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["path",{d:"m10 13-2 2 2 2",key:"17smn8"}],["path",{d:"m14 17 2-2-2-2",key:"14mezr"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ce=ee("FileText",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["line",{x1:"16",x2:"8",y1:"13",y2:"13",key:"14keom"}],["line",{x1:"16",x2:"8",y1:"17",y2:"17",key:"17nazh"}],["line",{x1:"10",x2:"8",y1:"9",y2:"9",key:"1a5vjj"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Re=ee("File",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const le=ee("Folder",[["path",{d:"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z",key:"1kt360"}]]);function ue(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function Ie(e){if(Array.isArray(e))return e}function Te(e,t,r){return(t=He(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Le(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,c,p,m=[],b=!0,j=!1;try{if(c=(r=r.call(e)).next,t!==0)for(;!(b=(n=c.call(r)).done)&&(m.push(n.value),m.length!==t);b=!0);}catch(S){j=!0,i=S}finally{try{if(!b&&r.return!=null&&(p=r.return(),Object(p)!==p))return}finally{if(j)throw i}}return m}}function De(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function de(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function fe(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?de(Object(r),!0).forEach(function(n){Te(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):de(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Ae(e,t){if(e==null)return{};var r,n,i=Ve(e,t);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);for(n=0;n<c.length;n++)r=c[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function Ve(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function ze(e,t){return Ie(e)||Le(e,t)||qe(e,t)||De()}function Ue(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function He(e){var t=Ue(e,"string");return typeof t=="symbol"?t:t+""}function qe(e,t){if(e){if(typeof e=="string")return ue(e,t);var r={}.toString.call(e).slice(8,-1);return r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set"?Array.from(e):r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?ue(e,t):void 0}}function Be(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function pe(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function he(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?pe(Object(r),!0).forEach(function(n){Be(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):pe(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function We(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return function(n){return t.reduceRight(function(i,c){return c(i)},n)}}function _(e){return function t(){for(var r=this,n=arguments.length,i=new Array(n),c=0;c<n;c++)i[c]=arguments[c];return i.length>=e.length?e.apply(this,i):function(){for(var p=arguments.length,m=new Array(p),b=0;b<p;b++)m[b]=arguments[b];return t.apply(r,[].concat(i,m))}}}function Q(e){return{}.toString.call(e).includes("Object")}function Ke(e){return!Object.keys(e).length}function G(e){return typeof e=="function"}function _e(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function Je(e,t){return Q(t)||I("changeType"),Object.keys(t).some(function(r){return!_e(e,r)})&&I("changeField"),t}function Ge(e){G(e)||I("selectorType")}function Xe(e){G(e)||Q(e)||I("handlerType"),Q(e)&&Object.values(e).some(function(t){return!G(t)})&&I("handlersType")}function Ye(e){e||I("initialIsRequired"),Q(e)||I("initialType"),Ke(e)&&I("initialContent")}function Ze(e,t){throw new Error(e[t]||e.default)}var Qe={initialIsRequired:"initial state is required",initialType:"initial state should be an object",initialContent:"initial state shouldn't be an empty object",handlerType:"handler should be an object or a function",handlersType:"all handlers should be a functions",selectorType:"selector should be a function",changeType:"provided value of changes should be an object",changeField:'it seams you want to change a field in the state which is not specified in the "initial" state',default:"an unknown error accured in `state-local` package"},I=_(Ze)(Qe),Y={changes:Je,selector:Ge,handler:Xe,initial:Ye};function et(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};Y.initial(e),Y.handler(t);var r={current:e},n=_(nt)(r,t),i=_(rt)(r),c=_(Y.changes)(e),p=_(tt)(r);function m(){var j=arguments.length>0&&arguments[0]!==void 0?arguments[0]:function(S){return S};return Y.selector(j),j(r.current)}function b(j){We(n,i,c,p)(j)}return[m,b]}function tt(e,t){return G(t)?t(e.current):t}function rt(e,t){return e.current=he(he({},e.current),t),t}function nt(e,t,r){return G(t)?t(e.current):Object.keys(r).forEach(function(n){var i;return(i=t[n])===null||i===void 0?void 0:i.call(t,e.current[n])}),r}var at={create:et},ot={paths:{vs:"https://cdn.jsdelivr.net/npm/monaco-editor@0.55.1/min/vs"}};function it(e){return function t(){for(var r=this,n=arguments.length,i=new Array(n),c=0;c<n;c++)i[c]=arguments[c];return i.length>=e.length?e.apply(this,i):function(){for(var p=arguments.length,m=new Array(p),b=0;b<p;b++)m[b]=arguments[b];return t.apply(r,[].concat(i,m))}}}function st(e){return{}.toString.call(e).includes("Object")}function ct(e){return e||ge("configIsRequired"),st(e)||ge("configType"),e.urls?(lt(),{paths:{vs:e.urls.monacoBase}}):e}function lt(){console.warn(me.deprecation)}function ut(e,t){throw new Error(e[t]||e.default)}var me={configIsRequired:"the configuration object is required",configType:"the configuration object should be an object",default:"an unknown error accured in `@monaco-editor/loader` package",deprecation:`Deprecation warning!
    You are using deprecated way of configuration.

    Instead of using
      monaco.config({ urls: { monacoBase: '...' } })
    use
      monaco.config({ paths: { vs: '...' } })

    For more please check the link https://github.com/suren-atoyan/monaco-loader#config
  `},ge=it(ut)(me),dt={config:ct},ft=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return function(i){return r.reduceRight(function(c,p){return p(c)},i)}};function ye(e,t){return Object.keys(t).forEach(function(r){t[r]instanceof Object&&e[r]&&Object.assign(t[r],ye(e[r],t[r]))}),fe(fe({},e),t)}var pt={type:"cancelation",msg:"operation is manually canceled"};function re(e){var t=!1,r=new Promise(function(n,i){e.then(function(c){return t?i(pt):n(c)}),e.catch(i)});return r.cancel=function(){return t=!0},r}var ht=["monaco"],gt=at.create({config:ot,isInitialized:!1,resolve:null,reject:null,monaco:null}),xe=ze(gt,2),X=xe[0],te=xe[1];function mt(e){var t=dt.config(e),r=t.monaco,n=Ae(t,ht);te(function(i){return{config:ye(i.config,n),monaco:r}})}function yt(){var e=X(function(t){var r=t.monaco,n=t.isInitialized,i=t.resolve;return{monaco:r,isInitialized:n,resolve:i}});if(!e.isInitialized){if(te({isInitialized:!0}),e.monaco)return e.resolve(e.monaco),re(ne);if(window.monaco&&window.monaco.editor)return ve(window.monaco),e.resolve(window.monaco),re(ne);ft(xt,bt)(wt)}return re(ne)}function xt(e){return document.body.appendChild(e)}function vt(e){var t=document.createElement("script");return e&&(t.src=e),t}function bt(e){var t=X(function(n){var i=n.config,c=n.reject;return{config:i,reject:c}}),r=vt("".concat(t.config.paths.vs,"/loader.js"));return r.onload=function(){return e()},r.onerror=t.reject,r}function wt(){var e=X(function(r){var n=r.config,i=r.resolve,c=r.reject;return{config:n,resolve:i,reject:c}}),t=window.require;t.config(e.config),t(["vs/editor/editor.main"],function(r){var n=r.m||r;ve(n),e.resolve(n)},function(r){e.reject(r)})}function ve(e){X().monaco||te({monaco:e})}function jt(){return X(function(e){var t=e.monaco;return t})}var ne=new Promise(function(e,t){return te({resolve:e,reject:t})}),be={config:mt,init:yt,__getMonacoInstance:jt},Nt={wrapper:{display:"flex",position:"relative",textAlign:"initial"},fullWidth:{width:"100%"},hide:{display:"none"}},ae=Nt,Ot={container:{display:"flex",height:"100%",width:"100%",justifyContent:"center",alignItems:"center"}},Mt=Ot;function St({children:e}){return L.createElement("div",{style:Mt.container},e)}var Ct=St,Et=Ct;function Ft({width:e,height:t,isEditorReady:r,loading:n,_ref:i,className:c,wrapperProps:p}){return L.createElement("section",{style:{...ae.wrapper,width:e,height:t},...p},!r&&L.createElement(Et,null,n),L.createElement("div",{ref:i,style:{...ae.fullWidth,...!r&&ae.hide},className:c}))}var Pt=Ft,we=d.memo(Pt);function $t(e){d.useEffect(e,[])}var je=$t;function kt(e,t,r=!0){let n=d.useRef(!0);d.useEffect(n.current||!r?()=>{n.current=!1}:e,t)}var E=kt;function J(){}function z(e,t,r,n){return Rt(e,n)||It(e,t,r,n)}function Rt(e,t){return e.editor.getModel(Ne(e,t))}function It(e,t,r,n){return e.editor.createModel(t,r,n?Ne(e,n):void 0)}function Ne(e,t){return e.Uri.parse(t)}function Tt({original:e,modified:t,language:r,originalLanguage:n,modifiedLanguage:i,originalModelPath:c,modifiedModelPath:p,keepCurrentOriginalModel:m=!1,keepCurrentModifiedModel:b=!1,theme:j="light",loading:S="Loading...",options:x={},height:F="100%",width:D="100%",className:U,wrapperProps:H={},beforeMount:q=J,onMount:B=J}){let[M,T]=d.useState(!1),[P,N]=d.useState(!0),O=d.useRef(null),w=d.useRef(null),k=d.useRef(null),y=d.useRef(B),a=d.useRef(q),s=d.useRef(!1);je(()=>{let l=be.init();return l.then(g=>(w.current=g)&&N(!1)).catch(g=>(g==null?void 0:g.type)!=="cancelation"&&console.error("Monaco initialization: error:",g)),()=>O.current?$():l.cancel()}),E(()=>{if(O.current&&w.current){let l=O.current.getOriginalEditor(),g=z(w.current,e||"",n||r||"text",c||"");g!==l.getModel()&&l.setModel(g)}},[c],M),E(()=>{if(O.current&&w.current){let l=O.current.getModifiedEditor(),g=z(w.current,t||"",i||r||"text",p||"");g!==l.getModel()&&l.setModel(g)}},[p],M),E(()=>{let l=O.current.getModifiedEditor();l.getOption(w.current.editor.EditorOption.readOnly)?l.setValue(t||""):t!==l.getValue()&&(l.executeEdits("",[{range:l.getModel().getFullModelRange(),text:t||"",forceMoveMarkers:!0}]),l.pushUndoStop())},[t],M),E(()=>{var l,g;(g=(l=O.current)==null?void 0:l.getModel())==null||g.original.setValue(e||"")},[e],M),E(()=>{let{original:l,modified:g}=O.current.getModel();w.current.editor.setModelLanguage(l,n||r||"text"),w.current.editor.setModelLanguage(g,i||r||"text")},[r,n,i],M),E(()=>{var l;(l=w.current)==null||l.editor.setTheme(j)},[j],M),E(()=>{var l;(l=O.current)==null||l.updateOptions(x)},[x],M);let u=d.useCallback(()=>{var R;if(!w.current)return;a.current(w.current);let l=z(w.current,e||"",n||r||"text",c||""),g=z(w.current,t||"",i||r||"text",p||"");(R=O.current)==null||R.setModel({original:l,modified:g})},[r,t,i,e,n,c,p]),h=d.useCallback(()=>{var l;!s.current&&k.current&&(O.current=w.current.editor.createDiffEditor(k.current,{automaticLayout:!0,...x}),u(),(l=w.current)==null||l.editor.setTheme(j),T(!0),s.current=!0)},[x,j,u]);d.useEffect(()=>{M&&y.current(O.current,w.current)},[M]),d.useEffect(()=>{!P&&!M&&h()},[P,M,h]);function $(){var g,R,A,W;let l=(g=O.current)==null?void 0:g.getModel();m||((R=l==null?void 0:l.original)==null||R.dispose()),b||((A=l==null?void 0:l.modified)==null||A.dispose()),(W=O.current)==null||W.dispose()}return L.createElement(we,{width:D,height:F,isEditorReady:M,loading:S,_ref:k,className:U,wrapperProps:H})}var Lt=Tt;d.memo(Lt);function Dt(e){let t=d.useRef();return d.useEffect(()=>{t.current=e},[e]),t.current}var At=Dt,Z=new Map;function Vt({defaultValue:e,defaultLanguage:t,defaultPath:r,value:n,language:i,path:c,theme:p="light",line:m,loading:b="Loading...",options:j={},overrideServices:S={},saveViewState:x=!0,keepCurrentModel:F=!1,width:D="100%",height:U="100%",className:H,wrapperProps:q={},beforeMount:B=J,onMount:M=J,onChange:T,onValidate:P=J}){let[N,O]=d.useState(!1),[w,k]=d.useState(!0),y=d.useRef(null),a=d.useRef(null),s=d.useRef(null),u=d.useRef(M),h=d.useRef(B),$=d.useRef(),l=d.useRef(n),g=At(c),R=d.useRef(!1),A=d.useRef(!1);je(()=>{let f=be.init();return f.then(v=>(y.current=v)&&k(!1)).catch(v=>(v==null?void 0:v.type)!=="cancelation"&&console.error("Monaco initialization: error:",v)),()=>a.current?Oe():f.cancel()}),E(()=>{var v,C,K,V;let f=z(y.current,e||n||"",t||i||"",c||r||"");f!==((v=a.current)==null?void 0:v.getModel())&&(x&&Z.set(g,(C=a.current)==null?void 0:C.saveViewState()),(K=a.current)==null||K.setModel(f),x&&((V=a.current)==null||V.restoreViewState(Z.get(c))))},[c],N),E(()=>{var f;(f=a.current)==null||f.updateOptions(j)},[j],N),E(()=>{!a.current||n===void 0||(a.current.getOption(y.current.editor.EditorOption.readOnly)?a.current.setValue(n):n!==a.current.getValue()&&(A.current=!0,a.current.executeEdits("",[{range:a.current.getModel().getFullModelRange(),text:n,forceMoveMarkers:!0}]),a.current.pushUndoStop(),A.current=!1))},[n],N),E(()=>{var v,C;let f=(v=a.current)==null?void 0:v.getModel();f&&i&&((C=y.current)==null||C.editor.setModelLanguage(f,i))},[i],N),E(()=>{var f;m!==void 0&&((f=a.current)==null||f.revealLine(m))},[m],N),E(()=>{var f;(f=y.current)==null||f.editor.setTheme(p)},[p],N);let W=d.useCallback(()=>{var f;if(!(!s.current||!y.current)&&!R.current){h.current(y.current);let v=c||r,C=z(y.current,n||e||"",t||i||"",v||"");a.current=(f=y.current)==null?void 0:f.editor.create(s.current,{model:C,automaticLayout:!0,...j},S),x&&a.current.restoreViewState(Z.get(v)),y.current.editor.setTheme(p),m!==void 0&&a.current.revealLine(m),O(!0),R.current=!0}},[e,t,r,n,i,c,j,S,x,p,m]);d.useEffect(()=>{N&&u.current(a.current,y.current)},[N]),d.useEffect(()=>{!w&&!N&&W()},[w,N,W]),l.current=n,d.useEffect(()=>{var f,v;N&&T&&((f=$.current)==null||f.dispose(),$.current=(v=a.current)==null?void 0:v.onDidChangeModelContent(C=>{A.current||T(a.current.getValue(),C)}))},[N,T]),d.useEffect(()=>{if(N){let f=y.current.editor.onDidChangeMarkers(v=>{var K;let C=(K=a.current.getModel())==null?void 0:K.uri;if(C&&v.find(V=>V.path===C.path)){let V=y.current.editor.getModelMarkers({resource:C});P==null||P(V)}});return()=>{f==null||f.dispose()}}return()=>{}},[N,P]);function Oe(){var f,v;(f=$.current)==null||f.dispose(),F?x&&Z.set(c,a.current.saveViewState()):(v=a.current.getModel())==null||v.dispose(),a.current.dispose()}return L.createElement(we,{width:D,height:U,isEditorReady:N,loading:b,_ref:s,className:H,wrapperProps:q})}var zt=Vt,Ut=d.memo(zt),Ht=Ut;const Gt=()=>{const[e,t]=d.useState("/"),[r,n]=d.useState([]),[i,c]=d.useState([]),[p,m]=d.useState(null),[b,j]=d.useState(!1),[S,x]=d.useState(null);d.useEffect(()=>{F(e)},[e]);const F=async a=>{try{j(!0);const s=await fetch(`/api/files/browse?path=${encodeURIComponent(a.slice(1))}`);if(s.ok){const u=await s.json();n(u.items)}else throw new Error("Failed to browse directory")}catch(s){x({type:"error",text:s.message})}finally{j(!1)}},D=async a=>{if(i.find(u=>u.path===a)){m(a);return}try{const u=await fetch(`/api/files/read?path=${encodeURIComponent(a.slice(1))}`);if(u.ok){const h=await u.json(),$={path:a,content:h.content,original:h.content,modified:!1};c([...i,$]),m(a)}else{const h=await u.json();x({type:"error",text:h.detail||"Failed to open file"})}}catch(u){x({type:"error",text:u.message})}},U=async a=>{const s=i.find(u=>u.path===a);if(s)try{const u=await fetch("/api/files/save",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({path:a.slice(1),content:s.content})});if(u.ok)x({type:"success",text:"File saved successfully"}),c(i.map(h=>h.path===a?{...h,original:h.content,modified:!1}:h)),F(e);else{const h=await u.json();throw new Error(h.detail||"Failed to save file")}}catch(u){x({type:"error",text:u.message})}},H=a=>{const s=i.find(h=>h.path===a);if(s!=null&&s.modified&&!confirm(`${s.path} has unsaved changes. Close anyway?`))return;const u=i.filter(h=>h.path!==a);c(u),p===a&&m(u.length>0?u[0].path:null)},q=(a,s)=>{c(i.map(u=>u.path===a?{...u,content:s,modified:s!==u.original}:u))},B=async a=>{if(confirm(`Delete ${a}? This cannot be undone.`))try{const s=await fetch(`/api/files/delete?path=${encodeURIComponent(a.slice(1))}`,{method:"DELETE"});if(s.ok)x({type:"success",text:"Deleted successfully"}),c(i.filter(u=>u.path!==a)),F(e);else{const u=await s.json();throw new Error(u.detail||"Failed to delete")}}catch(s){x({type:"error",text:s.message})}},M=async()=>{const a=prompt("Enter file name (e.g., mypool_driver.py):");if(!a)return;const s=`${e}${e.endsWith("/")?"":"/"}${a}`;try{const u=await fetch("/api/files/create",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({path:s.slice(1),content:""})});if(u.ok)x({type:"success",text:"File created successfully"}),F(e),D(s);else{const h=await u.json();throw new Error(h.detail||"Failed to create file")}}catch(u){x({type:"error",text:u.message})}},T=async a=>{const s=a.split("/").pop(),u=prompt(`Copy ${s} as:`,`${s}.copy`);if(!u)return;const $=`${a.substring(0,a.lastIndexOf("/"))}/${u}`;try{const l=await fetch("/api/files/copy",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({path:a.slice(1),new_path:$.slice(1)})});if(l.ok)x({type:"success",text:"File copied successfully"}),F(e);else{const g=await l.json();throw new Error(g.detail||"Failed to copy file")}}catch(l){x({type:"error",text:l.message})}},P=a=>{const s=`/api/files/download?path=${encodeURIComponent(a.slice(1))}`;window.open(s,"_blank")},N=a=>{if(a.type==="directory")return o.jsx(le,{className:"w-5 h-5 text-blue-400"});switch(a.extension){case".py":return o.jsx(se,{className:"w-5 h-5 text-green-400"});case".yaml":case".yml":return o.jsx(Ce,{className:"w-5 h-5 text-purple-400"});case".json":return o.jsx(se,{className:"w-5 h-5 text-yellow-400"});case".md":return o.jsx(ce,{className:"w-5 h-5 text-gray-400"});default:return o.jsx(Re,{className:"w-5 h-5 text-gray-400"})}},O=a=>{var h;const s=(h=a.split(".").pop())==null?void 0:h.toLowerCase();return{py:"python",js:"javascript",ts:"typescript",json:"json",yaml:"yaml",yml:"yaml",md:"markdown",sh:"shell",txt:"plaintext",log:"plaintext"}[s||""]||"plaintext"},w=a=>a<1024?`${a} B`:a<1024*1024?`${(a/1024).toFixed(1)} KB`:`${(a/(1024*1024)).toFixed(1)} MB`,k=e.split("/").filter(Boolean),y=i.find(a=>a.path===p);return o.jsxs("div",{className:"flex flex-col h-screen bg-gray-950",children:[o.jsxs("div",{className:"p-4 border-b border-gray-800",children:[o.jsx("h1",{className:"text-2xl font-bold text-gray-100",children:"File Manager"}),o.jsx("p",{className:"text-sm text-gray-400 mt-1",children:"Browse and edit configuration files"})]}),S&&o.jsx("div",{className:`mx-4 mt-4 p-3 rounded-md ${S.type==="success"?"bg-green-900/40 border border-green-700":"bg-red-900/40 border border-red-700"}`,children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsx("p",{className:`text-sm ${S.type==="success"?"text-green-200":"text-red-200"}`,children:S.text}),o.jsx("button",{onClick:()=>x(null),className:"text-gray-400 hover:text-gray-300",children:o.jsx(oe,{className:"w-4 h-4"})})]})}),o.jsxs("div",{className:"flex flex-1 overflow-hidden",children:[o.jsxs("div",{className:"w-80 border-r border-gray-800 flex flex-col bg-gray-900/40",children:[o.jsxs("div",{className:"p-3 border-b border-gray-800 flex items-center space-x-2 text-sm",children:[o.jsx("button",{onClick:()=>t("/"),className:"text-blue-400 hover:text-blue-300",children:"/config"}),k.map((a,s)=>o.jsxs(L.Fragment,{children:[o.jsx(Ee,{className:"w-4 h-4 text-gray-600"}),o.jsx("button",{onClick:()=>t("/"+k.slice(0,s+1).join("/")),className:"text-blue-400 hover:text-blue-300",children:a})]},s))]}),o.jsxs("div",{className:"p-2 border-b border-gray-800 flex items-center space-x-2",children:[o.jsx("button",{onClick:M,className:"p-2 rounded hover:bg-gray-800 text-gray-300 hover:text-gray-100",title:"New File",children:o.jsx(Me,{className:"w-4 h-4"})}),o.jsx("button",{onClick:()=>F(e),className:"p-2 rounded hover:bg-gray-800 text-gray-300 hover:text-gray-100",title:"Refresh",children:o.jsx(ie,{className:`w-4 h-4 ${b?"animate-spin":""}`})})]}),o.jsx("div",{className:"flex-1 overflow-y-auto",children:b&&r.length===0?o.jsxs("div",{className:"p-4 text-center text-gray-500",children:[o.jsx(ie,{className:"w-6 h-6 mx-auto animate-spin mb-2"}),"Loading..."]}):r.length===0?o.jsxs("div",{className:"p-4 text-center text-gray-500",children:[o.jsx(Se,{className:"w-12 h-12 mx-auto mb-2 opacity-50"}),o.jsx("p",{children:"Empty directory"})]}):o.jsxs("div",{className:"divide-y divide-gray-800",children:[e!=="/"&&o.jsxs("div",{onClick:()=>{const a=e.substring(0,e.lastIndexOf("/"))||"/";t(a)},className:"px-3 py-2 hover:bg-gray-800 cursor-pointer flex items-center space-x-3",children:[o.jsx(le,{className:"w-5 h-5 text-gray-500"}),o.jsx("span",{className:"text-gray-400",children:".."})]}),r.map(a=>o.jsxs("div",{className:"px-3 py-2 hover:bg-gray-800 cursor-pointer flex items-center justify-between group",children:[o.jsxs("div",{onClick:()=>{a.type==="directory"?t(a.path):D(a.path)},className:"flex items-center space-x-3 flex-1",children:[N(a),o.jsxs("div",{className:"flex-1 min-w-0",children:[o.jsx("p",{className:"text-sm text-gray-200 truncate",children:a.name}),o.jsx("p",{className:"text-xs text-gray-500",children:a.type==="file"?w(a.size):"Folder"})]})]}),a.type==="file"&&o.jsxs("div",{className:"flex items-center space-x-1 opacity-0 group-hover:opacity-100",children:[o.jsx("button",{onClick:s=>{s.stopPropagation(),T(a.path)},className:"p-1 rounded hover:bg-gray-700 text-gray-400 hover:text-gray-200",title:"Copy",children:o.jsx(Fe,{className:"w-3.5 h-3.5"})}),o.jsx("button",{onClick:s=>{s.stopPropagation(),P(a.path)},className:"p-1 rounded hover:bg-gray-700 text-gray-400 hover:text-gray-200",title:"Download",children:o.jsx(Pe,{className:"w-3.5 h-3.5"})}),o.jsx("button",{onClick:s=>{s.stopPropagation(),B(a.path)},className:"p-1 rounded hover:bg-gray-700 text-red-400 hover:text-red-300",title:"Delete",children:o.jsx($e,{className:"w-3.5 h-3.5"})})]})]},a.path))]})})]}),o.jsx("div",{className:"flex-1 flex flex-col",children:i.length===0?o.jsx("div",{className:"flex-1 flex items-center justify-center text-gray-500",children:o.jsxs("div",{className:"text-center",children:[o.jsx(ce,{className:"w-16 h-16 mx-auto mb-4 opacity-50"}),o.jsx("p",{className:"text-lg",children:"No files open"}),o.jsx("p",{className:"text-sm mt-2",children:"Select a file from the sidebar to start editing"})]})}):o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"flex items-center border-b border-gray-800 bg-gray-900/40 overflow-x-auto",children:i.map(a=>o.jsxs("div",{onClick:()=>m(a.path),className:`flex items-center space-x-2 px-4 py-2 border-r border-gray-800 cursor-pointer ${p===a.path?"bg-gray-900 text-gray-100":"text-gray-400 hover:text-gray-200 hover:bg-gray-800/50"}`,children:[o.jsxs("span",{className:"text-sm truncate max-w-xs",children:[a.path.split("/").pop(),a.modified&&" â€¢"]}),o.jsx("button",{onClick:s=>{s.stopPropagation(),H(a.path)},className:"hover:bg-gray-700 rounded p-0.5",children:o.jsx(oe,{className:"w-3.5 h-3.5"})})]},a.path))}),y&&o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"p-2 border-b border-gray-800 flex items-center justify-between bg-gray-900/40",children:[o.jsx("span",{className:"text-sm text-gray-400",children:y.path}),o.jsxs("button",{onClick:()=>U(y.path),disabled:!y.modified,className:`inline-flex items-center px-3 py-1 rounded text-sm ${y.modified?"bg-blue-600 text-white hover:bg-blue-700":"bg-gray-800 text-gray-500 cursor-not-allowed"}`,children:[o.jsx(ke,{className:"w-4 h-4 mr-1"}),"Save"]})]}),o.jsx("div",{className:"flex-1",children:o.jsx(Ht,{height:"100%",language:O(y.path),value:y.content,onChange:a=>q(y.path,a||""),theme:"vs-dark",options:{minimap:{enabled:!0},fontSize:14,lineNumbers:"on",rulers:[80,120],wordWrap:"off",automaticLayout:!0}})})]})]})})]})]})};export{Gt as default};
