import{c as H,b as S,a as F,j as e,o as A,W as B,C as l,d as m,e as h,f as d,an as P,$ as T,ao as D,r as U,a1 as q}from"./index-Bip6pmyK-1771277640157.js";import{A as E}from"./alert-triangle-CnHKWMP7-1771277640157.js";import{C as L}from"./check-circle-2-Bh5cMm3G-1771277640157.js";/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const R=H("Share2",[["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}],["circle",{cx:"6",cy:"12",r:"3",key:"w7nqdw"}],["circle",{cx:"18",cy:"19",r:"3",key:"1xt0gg"}],["line",{x1:"8.59",x2:"15.42",y1:"13.51",y2:"17.49",key:"47mynk"}],["line",{x1:"15.41",x2:"8.59",y1:"6.51",y2:"10.49",key:"1n3mei"}]]),W=new Set(["BTC","BCH","DGB"]);function C(s){return typeof s!="number"||!Number.isFinite(s)||s<=0?"N/A":s>=1e18?`${(s/1e18).toFixed(2)} EH/s`:s>=1e15?`${(s/1e15).toFixed(2)} PH/s`:s>=1e12?`${(s/1e12).toFixed(2)} TH/s`:s>=1e9?`${(s/1e9).toFixed(2)} GH/s`:s>=1e6?`${(s/1e6).toFixed(2)} MH/s`:s>=1e3?`${(s/1e3).toFixed(2)} KH/s`:`${s.toFixed(2)} H/s`}function $(s){return typeof s!="number"||!Number.isFinite(s)?"N/A":`${s.toFixed(2)}%`}function o(s){return typeof s!="number"||!Number.isFinite(s)?"N/A":s.toLocaleString()}function G(s){if(typeof s!="number"||!Number.isFinite(s)||s<=0)return"N/A";const r=Math.floor(s),n=Math.floor(r/3600),t=Math.floor(r%3600/60),i=r%60;return n>0?`${n}h ${t}m ${i}s`:t>0?`${t}m ${i}s`:`${i}s`}function M(s){if(!s)return"Unknown";const r=new Date(s).getTime();if(Number.isNaN(r))return s;const n=Math.max(0,Math.floor((Date.now()-r)/1e3));if(n<60)return`${n}s ago`;const t=Math.floor(n/60);if(t<60)return`${t}m ago`;const i=Math.floor(t/60);return i<24?`${i}h ago`:`${Math.floor(i/24)}d ago`}function k({points:s,colorClass:r}){const n=U.useMemo(()=>{const t=s.slice(-60);if(t.length<2)return"";const i=260,u=70,x=8,j=8,f=Math.min(...t.map(a=>a.x)),g=Math.max(...t.map(a=>a.x)),p=Math.min(...t.map(a=>a.y)),N=Math.max(...t.map(a=>a.y)),b=Math.max(g-f,1),y=Math.max(N-p,1);return t.map(a=>{const _=x+(a.x-f)/b*(i-x*2),v=u-j-(a.y-p)/y*(u-j*2);return`${_},${v}`}).join(" ")},[s]);return n?e.jsx("svg",{viewBox:"0 0 260 70",className:"h-[70px] w-full",children:e.jsx("polyline",{fill:"none",strokeWidth:"2",className:r,points:n})}):e.jsx("div",{className:"h-[70px] text-xs text-slate-500 flex items-center",children:"Not enough points"})}function Y(){var g,p,N,b,y,a,_,v,w;const r=(S().coin||"").toUpperCase(),n=!W.has(r),{data:t,isLoading:i,isError:u,error:x}=F({queryKey:["stratum-dashboard",r],queryFn:()=>q.getHmmLocalStratumCoinDashboard(r),enabled:!n,refetchInterval:3e4,refetchOnWindowFocus:!1,staleTime:25e3});if(n)return e.jsx("div",{className:"rounded-lg border border-amber-700/60 bg-amber-900/30 p-4 text-amber-200",children:"Unsupported coin route. Use BTC, BCH or DGB."});if(i)return e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx(A,{className:"h-8 w-8 animate-spin text-blue-500"})});if(u||!t)return e.jsxs("div",{className:"rounded-lg border border-red-700 bg-red-900/30 p-4 text-red-200",children:["Failed to load Stratum dashboard data: ",(x==null?void 0:x.message)||"Unknown error"]});const j=((g=t.quality)==null?void 0:g.readiness)||"unknown",f=!!((p=t.quality)!=null&&p.stale);return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsxs("div",{className:"flex items-center gap-3 text-3xl font-semibold text-foreground",children:[e.jsx(B,{className:"h-8 w-8 text-blue-400"}),e.jsxs("span",{children:["HMM-Local Stratum · ",r]})]}),e.jsxs("p",{className:"text-base text-muted-foreground",children:["Pool and miner telemetry for ",r," from local Stratum datastore."]})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-2 xl:grid-cols-4",children:[e.jsxs(l,{children:[e.jsx(m,{className:"pb-2",children:e.jsx(h,{className:"text-sm text-muted-foreground",children:"Readiness"})}),e.jsxs(d,{children:[e.jsx("div",{className:"text-2xl font-semibold capitalize",children:j}),e.jsx("div",{className:"mt-1 text-xs text-muted-foreground",children:f?"Data stale":"Data fresh"})]})]}),e.jsxs(l,{children:[e.jsx(m,{className:"pb-2",children:e.jsx(h,{className:"text-sm text-muted-foreground",children:"Pool hashrate"})}),e.jsxs(d,{children:[e.jsx("div",{className:"text-2xl font-semibold",children:C((N=t.hashrate)==null?void 0:N.pool_hashrate_hs)}),e.jsxs("div",{className:"mt-1 text-xs text-muted-foreground",children:["Workers: ",t.workers.count]})]})]}),e.jsxs(l,{children:[e.jsx(m,{className:"pb-2",children:e.jsx(h,{className:"text-sm text-muted-foreground",children:"Share reject rate"})}),e.jsxs(d,{children:[e.jsx("div",{className:"text-2xl font-semibold",children:$(((b=t.kpi)==null?void 0:b.share_reject_rate_pct)??null)}),e.jsxs("div",{className:"mt-1 text-xs text-muted-foreground",children:["Accepted ",o(((y=t.kpi)==null?void 0:y.share_accept_count)??null)," · Rejected ",o(((a=t.kpi)==null?void 0:a.share_reject_count)??null)]})]})]}),e.jsxs(l,{children:[e.jsx(m,{className:"pb-2",children:e.jsx(h,{className:"text-sm text-muted-foreground",children:"Blocks (24h)"})}),e.jsxs(d,{children:[e.jsx("div",{className:"text-2xl font-semibold",children:o(((_=t.kpi)==null?void 0:_.block_accept_count_24h)??null)}),e.jsxs("div",{className:"mt-1 text-xs text-muted-foreground",children:["Rejected ",o(((v=t.kpi)==null?void 0:v.block_reject_count_24h)??null)," · ETA ",G(((w=t.kpi)==null?void 0:w.expected_time_to_block_sec)??null)]})]})]})]}),e.jsxs(l,{children:[e.jsx(m,{children:e.jsxs(h,{className:"flex items-center gap-2 text-base",children:[e.jsx(P,{className:"h-4 w-4"})," Pool hashrate trend"]})}),e.jsx(d,{children:e.jsx(k,{points:t.charts.pool_hashrate_hs||[],colorClass:"stroke-blue-400"})})]}),e.jsx("div",{className:"space-y-4",children:t.workers.rows.length===0?e.jsx(l,{children:e.jsx(d,{className:"py-6 text-sm text-muted-foreground",children:"No worker rows available yet for this coin."})}):t.workers.rows.map(c=>e.jsxs(l,{children:[e.jsx(m,{className:"pb-3",children:e.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-2",children:[e.jsx(h,{className:"text-base",children:c.worker}),e.jsx("div",{className:"flex items-center gap-2 text-xs",children:c.reject_rate_pct!==null&&c.reject_rate_pct>=5?e.jsxs("span",{className:"inline-flex items-center gap-1 rounded-full border border-red-700/60 bg-red-900/30 px-2 py-1 text-red-300",children:[e.jsx(E,{className:"h-3 w-3"})," High reject risk"]}):e.jsxs("span",{className:"inline-flex items-center gap-1 rounded-full border border-emerald-700/50 bg-emerald-900/30 px-2 py-1 text-emerald-300",children:[e.jsx(L,{className:"h-3 w-3"})," Active"]})})]})}),e.jsxs(d,{className:"space-y-4",children:[e.jsxs("div",{className:"grid gap-3 md:grid-cols-2 xl:grid-cols-5",children:[e.jsxs("div",{className:"rounded-lg border border-slate-700/50 bg-slate-900/30 p-3",children:[e.jsx("div",{className:"text-xs uppercase tracking-wide text-slate-400",children:"Current hashrate"}),e.jsx("div",{className:"mt-1 text-sm text-slate-100",children:C(c.current_hashrate_hs)})]}),e.jsxs("div",{className:"rounded-lg border border-slate-700/50 bg-slate-900/30 p-3",children:[e.jsx("div",{className:"text-xs uppercase tracking-wide text-slate-400",children:"Shares"}),e.jsxs("div",{className:"mt-1 text-sm text-slate-100",children:[o(c.accepted)," accepted"]}),e.jsxs("div",{className:"text-xs text-slate-400",children:[o(c.rejected)," rejected"]})]}),e.jsxs("div",{className:"rounded-lg border border-slate-700/50 bg-slate-900/30 p-3",children:[e.jsx("div",{className:"text-xs uppercase tracking-wide text-slate-400",children:"Reject rate"}),e.jsx("div",{className:"mt-1 text-sm text-slate-100",children:$(c.reject_rate_pct)})]}),e.jsxs("div",{className:"rounded-lg border border-slate-700/50 bg-slate-900/30 p-3",children:[e.jsx("div",{className:"text-xs uppercase tracking-wide text-slate-400",children:"Highest diff"}),e.jsx("div",{className:"mt-1 text-sm text-slate-100",children:o(c.highest_diff)})]}),e.jsxs("div",{className:"rounded-lg border border-slate-700/50 bg-slate-900/30 p-3",children:[e.jsx("div",{className:"text-xs uppercase tracking-wide text-slate-400",children:"Last share"}),e.jsx("div",{className:"mt-1 text-sm text-slate-100",children:M(c.last_share_at)})]})]}),e.jsxs("div",{className:"grid gap-4 xl:grid-cols-2",children:[e.jsxs("div",{className:"rounded-lg border border-slate-700/50 bg-slate-900/30 p-3",children:[e.jsxs("div",{className:"mb-2 flex items-center gap-2 text-xs uppercase tracking-wide text-slate-400",children:[e.jsx(T,{className:"h-3.5 w-3.5"})," Hashrate trend"]}),e.jsx(k,{points:c.hashrate_chart||[],colorClass:"stroke-cyan-400"})]}),e.jsxs("div",{className:"rounded-lg border border-slate-700/50 bg-slate-900/30 p-3",children:[e.jsxs("div",{className:"mb-2 flex items-center gap-2 text-xs uppercase tracking-wide text-slate-400",children:[e.jsx(R,{className:"h-3.5 w-3.5"})," Vardiff trend"]}),e.jsx(k,{points:c.vardiff_chart||[],colorClass:"stroke-purple-400"})]})]})]})]},c.worker))}),e.jsx("div",{className:"rounded-lg border border-slate-700/50 bg-slate-900/20 p-3 text-xs text-slate-400",children:e.jsxs("div",{className:"flex flex-wrap items-center gap-4",children:[e.jsxs("span",{className:"inline-flex items-center gap-1",children:[e.jsx(D,{className:"h-3.5 w-3.5"})," Pool: ",t.pool.name]}),e.jsxs("span",{children:["Source: ",t.api_base]}),e.jsxs("span",{children:["Updated: ",M(t.fetched_at)]})]})})]})}export{Y as default};
