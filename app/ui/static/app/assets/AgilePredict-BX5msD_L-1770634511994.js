import{c as Me,r as K,a as Tt,j as u,a2 as Nt,C as D,d as he,e as fe,s as Rt,t as _t,v as It,w as Ot,x as Et,B as Lt,R as Wt,f as T,o as Yt,Y as zt}from"./index-C1SvuyBC-1770634511994.js";import{f as L,g as W,C as ee,E as _,t as M,h as Ce,j as S,k as re,l as w,m as Xt,u as Ht,n as E,R as rt,o as Bt,q as Vt,D as $t,A as Ft,v as q,r as ot,s as ke,Q as B,H as Q,w as _e,x as st,y as qt,z as Ie,F as ge,G as Oe,I as Ut,L as Gt,a as Jt,b as Kt,P as Qt,c as Zt,p as en,d as tn,e as nn,T as rn}from"./index-BenAPluD-1770634511994.js";import"./chartjs-adapter-date-fns.esm-Cdk7CG2j-1770634511994.js";import{L as Ee}from"./loader-2-D8ZIaeAF-1770634511994.js";/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const on=Me("ArrowDownRight",[["path",{d:"m7 7 10 10",key:"1fmybs"}],["path",{d:"M17 7v10H7",key:"6fjiku"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sn=Me("ArrowUpRight",[["path",{d:"M7 7h10v10",key:"1tivn9"}],["path",{d:"M7 17 17 7",key:"1vkiza"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const an=Me("CalendarRange",[["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",ry:"2",key:"eu3xkr"}],["line",{x1:"16",x2:"16",y1:"2",y2:"6",key:"m3sa8f"}],["line",{x1:"8",x2:"8",y1:"2",y2:"6",key:"18kwsl"}],["line",{x1:"3",x2:"21",y1:"10",y2:"10",key:"xt86sb"}],["path",{d:"M17 14h-6",key:"bkmgh3"}],["path",{d:"M13 18H7",key:"bb0bb7"}],["path",{d:"M7 14h.01",key:"1qa3f1"}],["path",{d:"M17 18h.01",key:"1bdyru"}]]);/*!
* chartjs-plugin-annotation v3.1.0
* https://www.chartjs.org/chartjs-plugin-annotation/index
 * (c) 2024 chartjs-plugin-annotation Contributors
 * Released under the MIT License
 */const Le={modes:{point(t,e){return te(t,e,{intersect:!0})},nearest(t,e,n){return cn(t,e,n)},x(t,e,n){return te(t,e,{intersect:n.intersect,axis:"x"})},y(t,e,n){return te(t,e,{intersect:n.intersect,axis:"y"})}}};function ve(t,e,n){return(Le.modes[n.mode]||Le.modes.nearest)(t,e,n)}function ln(t,e,n){return n!=="x"&&n!=="y"?t.inRange(e.x,e.y,"x",!0)||t.inRange(e.x,e.y,"y",!0):t.inRange(e.x,e.y,n,!0)}function dn(t,e,n){return n==="x"?{x:t.x,y:e.y}:n==="y"?{x:e.x,y:t.y}:e}function te(t,e,n){return t.filter(r=>n.intersect?r.inRange(e.x,e.y):ln(r,e,n.axis))}function cn(t,e,n){let r=Number.POSITIVE_INFINITY;return te(t,e,n).reduce((o,s)=>{const i=s.getCenterPoint(),a=dn(e,i,n.axis),l=Ce(e,a);return l<r?(o=[s],r=l):l===r&&o.push(s),o},[]).sort((o,s)=>o._index-s._index).slice(0,1)}function I(t,e,n){const r=Math.cos(n),o=Math.sin(n),s=e.x,i=e.y;return{x:s+r*(t.x-s)-o*(t.y-i),y:i+o*(t.x-s)+r*(t.y-i)}}const un=(t,e)=>e>t||t.length>e.length&&t.slice(0,e.length)===e,N=.001,oe=(t,e,n)=>Math.min(n,Math.max(e,t)),it=(t,e)=>t.value>=t.start-e&&t.value<=t.end+e;function hn(t,e,n){for(const r of Object.keys(t))t[r]=oe(t[r],e,n);return t}function fn(t,e,n,r){return!t||!e||n<=0?!1:Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2)<=Math.pow(n+r,2)}function at(t,{x:e,y:n,x2:r,y2:o},s,{borderWidth:i,hitTolerance:a}){const l=(i+a)/2,d=t.x>=e-l-N&&t.x<=r+l+N,c=t.y>=n-l-N&&t.y<=o+l+N;return s==="x"?d:(s==="y"||d)&&c}function lt(t,{rect:e,center:n},r,{rotation:o,borderWidth:s,hitTolerance:i}){const a=I(t,n,M(-o));return at(a,e,r,{borderWidth:s,hitTolerance:i})}function O(t,e){const{centerX:n,centerY:r}=t.getProps(["centerX","centerY"],e);return{x:n,y:r}}function gn(t,e,n,r=!0){const o=n.split(".");let s=0;for(const i of e.split(".")){const a=o[s++];if(parseInt(i,10)<parseInt(a,10))break;if(un(a,i)){if(r)throw new Error(`${t} v${n} is not supported. v${e} or newer is required.`);return!1}}return!0}const dt=t=>typeof t=="string"&&t.endsWith("%"),ct=t=>parseFloat(t)/100,ut=t=>oe(ct(t),0,1),V=(t,e)=>({x:t,y:e,x2:t,y2:e,width:0,height:0}),bn={box:t=>V(t.centerX,t.centerY),doughnutLabel:t=>V(t.centerX,t.centerY),ellipse:t=>({centerX:t.centerX,centerY:t.centerX,radius:0,width:0,height:0}),label:t=>V(t.centerX,t.centerY),line:t=>V(t.x,t.y),point:t=>({centerX:t.centerX,centerY:t.centerY,radius:0,width:0,height:0}),polygon:t=>V(t.centerX,t.centerY)};function Pe(t,e){return e==="start"?0:e==="end"?t:dt(e)?ut(e)*t:t/2}function P(t,e,n=!0){return typeof e=="number"?e:dt(e)?(n?ut(e):ct(e))*t:t}function mn(t,e){const{x:n,width:r}=t,o=e.textAlign;return o==="center"?n+r/2:o==="end"||o==="right"?n+r:n}function ht(t,e,{borderWidth:n,position:r,xAdjust:o,yAdjust:s},i){const a=L(i),l=e.width+(a?i.width:0)+n,d=e.height+(a?i.height:0)+n,c=Ae(r),f=We(t.x,l,o,c.x),h=We(t.y,d,s,c.y);return{x:f,y:h,x2:f+l,y2:h+d,width:l,height:d,centerX:f+l/2,centerY:h+d/2}}function Ae(t,e="center"){return L(t)?{x:q(t.x,e),y:q(t.y,e)}:(t=q(t,e),{x:t,y:t})}const ft=(t,e)=>t&&t.autoFit&&e<1;function gt(t,e){const n=t.font,r=W(n)?n:[n];return ft(t,e)?r.map(function(o){const s=ge(o);return s.size=Math.floor(o.size*e),s.lineHeight=o.lineHeight,ge(s)}):r.map(o=>ge(o))}function bt(t){return t&&(S(t.xValue)||S(t.yValue))}function We(t,e,n=0,r){return t-Pe(e,r)+n}function z(t,e,n){const r=n.init;if(r){if(r===!0)return yt(e,n)}else return;return yn(t,e,n)}function mt(t,e,n){let r=!1;return e.forEach(o=>{E(t[o])?(r=!0,n[o]=t[o]):S(n[o])&&delete n[o]}),r}function yt(t,e){const n=e.type||"line";return bn[n](t)}function yn(t,e,n){const r=ke(n.init,[{chart:t,properties:e,options:n}]);if(r===!0)return yt(e,n);if(L(r))return r}const be=new Map,pn=t=>isNaN(t)||t<=0,xn=t=>t.reduce(function(e,n){return e+=n.string,e},"");function se(t){if(t&&typeof t=="object"){const e=t.toString();return e==="[object HTMLImageElement]"||e==="[object HTMLCanvasElement]"}}function ie(t,{x:e,y:n},r){r&&(t.translate(e,n),t.rotate(M(r)),t.translate(-e,-n))}function j(t,e){if(e&&e.borderWidth)return t.lineCap=e.borderCapStyle||"butt",t.setLineDash(e.borderDash),t.lineDashOffset=e.borderDashOffset,t.lineJoin=e.borderJoinStyle||"miter",t.lineWidth=e.borderWidth,t.strokeStyle=e.borderColor,!0}function X(t,e){t.shadowColor=e.backgroundShadowColor,t.shadowBlur=e.shadowBlur,t.shadowOffsetX=e.shadowOffsetX,t.shadowOffsetY=e.shadowOffsetY}function ae(t,e){const n=e.content;if(se(n))return{width:P(n.width,e.width),height:P(n.height,e.height)};const r=gt(e),o=e.textStrokeWidth,s=W(n)?n:[n],i=s.join()+xn(r)+o+(t._measureText?"-spriting":"");return be.has(i)||be.set(i,Mn(t,s,r,o)),be.get(i)}function pt(t,e,n){const{x:r,y:o,width:s,height:i}=e;t.save(),X(t,n);const a=j(t,n);t.fillStyle=n.backgroundColor,t.beginPath(),Bt(t,{x:r,y:o,w:s,h:i,radius:hn(Vt(n.borderRadius),0,Math.min(s,i)/2)}),t.closePath(),t.fill(),a&&(t.shadowColor=n.borderShadowColor,t.stroke()),t.restore()}function xt(t,e,n,r){const o=n.content;if(se(o)){t.save(),t.globalAlpha=vn(n.opacity,o.style.opacity),t.drawImage(o,e.x,e.y,e.width,e.height),t.restore();return}const s=W(o)?o:[o],i=gt(n,r),a=n.color,l=W(a)?a:[a],d=mn(e,n),c=e.y+n.textStrokeWidth/2;t.save(),t.textBaseline="middle",t.textAlign=n.textAlign,wn(t,n)&&Cn(t,{x:d,y:c},s,i),kn(t,{x:d,y:c},s,{fonts:i,colors:l}),t.restore()}function wn(t,e){if(e.textStrokeWidth>0)return t.lineJoin="round",t.miterLimit=2,t.lineWidth=e.textStrokeWidth,t.strokeStyle=e.textStrokeColor,!0}function Sn(t,e,n,r){const{radius:o,options:s}=e,i=s.pointStyle,a=s.rotation;let l=(a||0)*rt;if(se(i)){t.save(),t.translate(n,r),t.rotate(l),t.drawImage(i,-i.width/2,-i.height/2,i.width,i.height),t.restore();return}pn(o)||jn(t,{x:n,y:r,radius:o,rotation:a,style:i,rad:l})}function jn(t,{x:e,y:n,radius:r,rotation:o,style:s,rad:i}){let a,l,d,c;switch(t.beginPath(),s){default:t.arc(e,n,r,0,st),t.closePath();break;case"triangle":t.moveTo(e+Math.sin(i)*r,n-Math.cos(i)*r),i+=_e,t.lineTo(e+Math.sin(i)*r,n-Math.cos(i)*r),i+=_e,t.lineTo(e+Math.sin(i)*r,n-Math.cos(i)*r),t.closePath();break;case"rectRounded":c=r*.516,d=r-c,a=Math.cos(i+B)*d,l=Math.sin(i+B)*d,t.arc(e-a,n-l,c,i-w,i-Q),t.arc(e+l,n-a,c,i-Q,i),t.arc(e+a,n+l,c,i,i+Q),t.arc(e-l,n+a,c,i+Q,i+w),t.closePath();break;case"rect":if(!o){d=Math.SQRT1_2*r,t.rect(e-d,n-d,2*d,2*d);break}i+=B;case"rectRot":a=Math.cos(i)*r,l=Math.sin(i)*r,t.moveTo(e-a,n-l),t.lineTo(e+l,n-a),t.lineTo(e+a,n+l),t.lineTo(e-l,n+a),t.closePath();break;case"crossRot":i+=B;case"cross":a=Math.cos(i)*r,l=Math.sin(i)*r,t.moveTo(e-a,n-l),t.lineTo(e+a,n+l),t.moveTo(e+l,n-a),t.lineTo(e-l,n+a);break;case"star":a=Math.cos(i)*r,l=Math.sin(i)*r,t.moveTo(e-a,n-l),t.lineTo(e+a,n+l),t.moveTo(e+l,n-a),t.lineTo(e-l,n+a),i+=B,a=Math.cos(i)*r,l=Math.sin(i)*r,t.moveTo(e-a,n-l),t.lineTo(e+a,n+l),t.moveTo(e+l,n-a),t.lineTo(e-l,n+a);break;case"line":a=Math.cos(i)*r,l=Math.sin(i)*r,t.moveTo(e-a,n-l),t.lineTo(e+a,n+l);break;case"dash":t.moveTo(e,n),t.lineTo(e+Math.cos(i)*r,n+Math.sin(i)*r);break}t.fill()}function Mn(t,e,n,r){t.save();const o=e.length;let s=0,i=r;for(let a=0;a<o;a++){const l=n[Math.min(a,n.length-1)];t.font=l.string;const d=e[a];s=Math.max(s,t.measureText(d).width+r),i+=l.lineHeight}return t.restore(),{width:s,height:i}}function Cn(t,{x:e,y:n},r,o){t.beginPath();let s=0;r.forEach(function(i,a){const l=o[Math.min(a,o.length-1)],d=l.lineHeight;t.font=l.string,t.strokeText(i,e,n+d/2+s),s+=d}),t.stroke()}function kn(t,{x:e,y:n},r,{fonts:o,colors:s}){let i=0;r.forEach(function(a,l){const d=s[Math.min(l,s.length-1)],c=o[Math.min(l,o.length-1)],f=c.lineHeight;t.beginPath(),t.font=c.string,t.fillStyle=d,t.fillText(a,e,n+f/2+i),i+=f,t.fill()})}function vn(t,e){const n=Ie(t)?t:e;return Ie(n)?oe(n,0,1):1}const wt=["left","bottom","top","right"];function Pn(t,e){const{pointX:n,pointY:r,options:o}=e,s=o.callout,i=s&&s.display&&Rn(e,s);if(!i||In(e,s,i))return;if(t.save(),t.beginPath(),!j(t,s))return t.restore();const{separatorStart:l,separatorEnd:d}=An(e,i),{sideStart:c,sideEnd:f}=Tn(e,i,l);(s.margin>0||o.borderWidth===0)&&(t.moveTo(l.x,l.y),t.lineTo(d.x,d.y)),t.moveTo(c.x,c.y),t.lineTo(f.x,f.y);const h=I({x:n,y:r},e.getCenterPoint(),M(-e.rotation));t.lineTo(h.x,h.y),t.stroke(),t.restore()}function An(t,e){const{x:n,y:r,x2:o,y2:s}=t,i=Dn(t,e);let a,l;return e==="left"||e==="right"?(a={x:n+i,y:r},l={x:a.x,y:s}):(a={x:n,y:r+i},l={x:o,y:a.y}),{separatorStart:a,separatorEnd:l}}function Dn(t,e){const{width:n,height:r,options:o}=t,s=o.callout.margin+o.borderWidth/2;return e==="right"?n+s:e==="bottom"?r+s:-s}function Tn(t,e,n){const{y:r,width:o,height:s,options:i}=t,a=i.callout.start,l=Nn(e,i.callout);let d,c;return e==="left"||e==="right"?(d={x:n.x,y:r+P(s,a)},c={x:d.x+l,y:d.y}):(d={x:n.x+P(o,a),y:n.y},c={x:d.x,y:d.y+l}),{sideStart:d,sideEnd:c}}function Nn(t,e){const n=e.side;return t==="left"||t==="top"?-n:n}function Rn(t,e){const n=e.position;return wt.includes(n)?n:_n(t,e)}function _n(t,e){const{x:n,y:r,x2:o,y2:s,width:i,height:a,pointX:l,pointY:d,centerX:c,centerY:f,rotation:h}=t,b={x:c,y:f},g=e.start,p=P(i,g),y=P(a,g),m=[n,n+p,n+p,o],x=[r+y,s,r,s],C=[];for(let A=0;A<4;A++){const ue=I({x:m[A],y:x[A]},b,M(h));C.push({position:wt[A],distance:Ce(ue,{x:l,y:d})})}return C.sort((A,ue)=>A.distance-ue.distance)[0].position}function In(t,e,n){const{pointX:r,pointY:o}=t,s=e.margin;let i=r,a=o;return n==="left"?i+=s:n==="right"?i-=s:n==="top"?a+=s:n==="bottom"&&(a-=s),t.inRange(i,a)}const Ye={xScaleID:{min:"xMin",max:"xMax",start:"left",end:"right",startProp:"x",endProp:"x2"},yScaleID:{min:"yMin",max:"yMax",start:"bottom",end:"top",startProp:"y",endProp:"y2"}};function Y(t,e,n){return e=typeof e=="number"?e:t.parse(e),ot(e)?t.getPixelForValue(e):n}function R(t,e,n){const r=e[n];if(r||n==="scaleID")return r;const o=n.charAt(0),s=Object.values(t).filter(i=>i.axis&&i.axis===o);return s.length?s[0].id:o}function St(t,e){if(t){const n=t.options.reverse,r=Y(t,e.min,n?e.end:e.start),o=Y(t,e.max,n?e.start:e.end);return{start:r,end:o}}}function jt(t,e){const{chartArea:n,scales:r}=t,o=r[R(r,e,"xScaleID")],s=r[R(r,e,"yScaleID")];let i=n.width/2,a=n.height/2;return o&&(i=Y(o,e.xValue,o.left+o.width/2)),s&&(a=Y(s,e.yValue,s.top+s.height/2)),{x:i,y:a}}function De(t,e){const n=t.scales,r=n[R(n,e,"xScaleID")],o=n[R(n,e,"yScaleID")];if(!r&&!o)return{};let{left:s,right:i}=r||t.chartArea,{top:a,bottom:l}=o||t.chartArea;const d=ze(r,{min:e.xMin,max:e.xMax,start:s,end:i});s=d.start,i=d.end;const c=ze(o,{min:e.yMin,max:e.yMax,start:l,end:a});return a=c.start,l=c.end,{x:s,y:a,x2:i,y2:l,width:i-s,height:l-a,centerX:s+(i-s)/2,centerY:a+(l-a)/2}}function Mt(t,e){if(!bt(e)){const n=De(t,e);let r=e.radius;(!r||isNaN(r))&&(r=Math.min(n.width,n.height)/2,e.radius=r);const o=r*2,s=n.centerX+e.xAdjust,i=n.centerY+e.yAdjust;return{x:s-r,y:i-r,x2:s+r,y2:i+r,centerX:s,centerY:i,width:o,height:o,radius:r}}return En(t,e)}function On(t,e){const{scales:n,chartArea:r}=t,o=n[e.scaleID],s={x:r.left,y:r.top,x2:r.right,y2:r.bottom};return o?Ln(o,s,e):Wn(n,s,e),s}function Ct(t,e){const n=De(t,e);return n.initProperties=z(t,n,e),n.elements=[{type:"label",optionScope:"label",properties:Xn(t,n,e),initProperties:n.initProperties}],n}function En(t,e){const n=jt(t,e),r=e.radius*2;return{x:n.x-e.radius+e.xAdjust,y:n.y-e.radius+e.yAdjust,x2:n.x+e.radius+e.xAdjust,y2:n.y+e.radius+e.yAdjust,centerX:n.x+e.xAdjust,centerY:n.y+e.yAdjust,radius:e.radius,width:r,height:r}}function ze(t,e){const n=St(t,e)||e;return{start:Math.min(n.start,n.end),end:Math.max(n.start,n.end)}}function Ln(t,e,n){const r=Y(t,n.value,NaN),o=Y(t,n.endValue,r);t.isHorizontal()?(e.x=r,e.x2=o):(e.y=r,e.y2=o)}function Wn(t,e,n){for(const r of Object.keys(Ye)){const o=t[R(t,n,r)];if(o){const{min:s,max:i,start:a,end:l,startProp:d,endProp:c}=Ye[r],f=St(o,{min:n[s],max:n[i],start:o[a],end:o[l]});e[d]=f.start,e[c]=f.end}}}function Yn({properties:t,options:e},n,r,o){const{x:s,x2:i,width:a}=t;return kt({start:s,end:i,borderWidth:e.borderWidth},{position:r.x,padding:{start:o.left,end:o.right},adjust:e.label.xAdjust,size:n.width})}function zn({properties:t,options:e},n,r,o){const{y:s,y2:i,height:a}=t;return kt({start:s,end:i,borderWidth:e.borderWidth},{position:r.y,padding:{start:o.top,end:o.bottom},adjust:e.label.yAdjust,size:n.height})}function kt(t,e){const{start:n,end:r,borderWidth:o}=t,{position:s,padding:{start:i,end:a},adjust:l}=e,d=r-o-n-i-a-e.size;return n+o/2+l+Pe(d,s)}function Xn(t,e,n){const r=n.label;r.backgroundColor="transparent",r.callout.display=!1;const o=Ae(r.position),s=re(r.padding),i=ae(t.ctx,r),a=Yn({properties:e,options:n},i,o,s),l=zn({properties:e,options:n},i,o,s),d=i.width+s.width,c=i.height+s.height;return{x:a,y:l,x2:a+d,y2:l+c,width:d,height:c,centerX:a+d/2,centerY:l+c/2,rotation:r.rotation}}const me=["enter","leave"],Te=me.concat("click");function Hn(t,e,n){e.listened=mt(n,Te,e.listeners),e.moveListened=!1,me.forEach(r=>{E(n[r])&&(e.moveListened=!0)}),(!e.listened||!e.moveListened)&&e.annotations.forEach(r=>{!e.listened&&E(r.click)&&(e.listened=!0),e.moveListened||me.forEach(o=>{E(r[o])&&(e.listened=!0,e.moveListened=!0)})})}function Bn(t,e,n){if(t.listened)switch(e.type){case"mousemove":case"mouseout":return Vn(t,e,n);case"click":return $n(t,e,n)}}function Vn(t,e,n){if(!t.moveListened)return;let r;e.type==="mousemove"?r=ve(t.visibleElements,e,n.interaction):r=[];const o=t.hovered;t.hovered=r;const s={state:t,event:e};let i=Xe(s,"leave",o,r);return Xe(s,"enter",r,o)||i}function Xe({state:t,event:e},n,r,o){let s;for(const i of r)o.indexOf(i)<0&&(s=vt(i.options[n]||t.listeners[n],i,e)||s);return s}function $n(t,e,n){const r=t.listeners,o=ve(t.visibleElements,e,n.interaction);let s;for(const i of o)s=vt(i.options.click||r.click,i,e)||s;return s}function vt(t,e,n){return ke(t,[e.$context,n])===!0}const ne=["afterDraw","beforeDraw"];function Fn(t,e,n){const r=e.visibleElements;e.hooked=mt(n,ne,e.hooks),e.hooked||r.forEach(o=>{e.hooked||ne.forEach(s=>{E(o.options[s])&&(e.hooked=!0)})})}function He(t,e,n){if(t.hooked){const r=e.options[n]||t.hooks[n];return ke(r,[e.$context])}}function qn(t,e,n){const r=Qn(t.scales,e,n);let o=Be(e,r,"min","suggestedMin");o=Be(e,r,"max","suggestedMax")||o,o&&E(e.handleTickRangeOptions)&&e.handleTickRangeOptions()}function Un(t,e){for(const n of t)Jn(n,e)}function Be(t,e,n,r){if(ot(e[n])&&!Gn(t.options,n,r)){const o=t[n]!==e[n];return t[n]=e[n],o}}function Gn(t,e,n){return S(t[e])||S(t[n])}function Jn(t,e){for(const n of["scaleID","xScaleID","yScaleID"]){const r=R(e,t,n);r&&!e[r]&&Kn(t,n)&&console.warn(`No scale found with id '${r}' for annotation '${t.id}'`)}}function Kn(t,e){if(e==="scaleID")return!0;const n=e.charAt(0);for(const r of["Min","Max","Value"])if(S(t[n+r]))return!0;return!1}function Qn(t,e,n){const r=e.axis,o=e.id,s=r+"ScaleID",i={min:q(e.min,Number.NEGATIVE_INFINITY),max:q(e.max,Number.POSITIVE_INFINITY)};for(const a of n)a.scaleID===o?Ve(a,e,["value","endValue"],i):R(t,a,s)===o&&Ve(a,e,[r+"Min",r+"Max",r+"Value"],i);return i}function Ve(t,e,n,r){for(const o of n){const s=t[o];if(S(s)){const i=e.parse(s);r.min=Math.min(r.min,i),r.max=Math.max(r.max,i)}}}class H extends _{inRange(e,n,r,o){const{x:s,y:i}=I({x:e,y:n},this.getCenterPoint(o),M(-this.options.rotation));return at({x:s,y:i},this.getProps(["x","y","x2","y2"],o),r,this.options)}getCenterPoint(e){return O(this,e)}draw(e){e.save(),ie(e,this.getCenterPoint(),this.options.rotation),pt(e,this,this.options),e.restore()}get label(){return this.elements&&this.elements[0]}resolveElementProperties(e,n){return Ct(e,n)}}H.id="boxAnnotation";H.defaults={adjustScaleRange:!0,backgroundShadowColor:"transparent",borderCapStyle:"butt",borderDash:[],borderDashOffset:0,borderJoinStyle:"miter",borderRadius:0,borderShadowColor:"transparent",borderWidth:1,display:!0,init:void 0,hitTolerance:0,label:{backgroundColor:"transparent",borderWidth:0,callout:{display:!1},color:"black",content:null,display:!1,drawTime:void 0,font:{family:void 0,lineHeight:void 0,size:void 0,style:void 0,weight:"bold"},height:void 0,hitTolerance:void 0,opacity:void 0,padding:6,position:"center",rotation:void 0,textAlign:"start",textStrokeColor:void 0,textStrokeWidth:0,width:void 0,xAdjust:0,yAdjust:0,z:void 0},rotation:0,shadowBlur:0,shadowOffsetX:0,shadowOffsetY:0,xMax:void 0,xMin:void 0,xScaleID:void 0,yMax:void 0,yMin:void 0,yScaleID:void 0,z:0};H.defaultRoutes={borderColor:"color",backgroundColor:"color"};H.descriptors={label:{_fallback:!0}};class le extends _{inRange(e,n,r,o){return lt({x:e,y:n},{rect:this.getProps(["x","y","x2","y2"],o),center:this.getCenterPoint(o)},r,{rotation:this.rotation,borderWidth:0,hitTolerance:this.options.hitTolerance})}getCenterPoint(e){return O(this,e)}draw(e){const n=this.options;!n.display||!n.content||(or(e,this),e.save(),ie(e,this.getCenterPoint(),this.rotation),xt(e,this,n,this._fitRatio),e.restore())}resolveElementProperties(e,n){const r=Zn(e,n);if(!r)return{};const{controllerMeta:o,point:s,radius:i}=tr(e,n,r);let a=ae(e.ctx,n);const l=nr(a,i);ft(n,l)&&(a={width:a.width*l,height:a.height*l});const{position:d,xAdjust:c,yAdjust:f}=n,h=ht(s,a,{borderWidth:0,position:d,xAdjust:c,yAdjust:f});return{initProperties:z(e,h,n),...h,...o,rotation:n.rotation,_fitRatio:l}}}le.id="doughnutLabelAnnotation";le.defaults={autoFit:!0,autoHide:!0,backgroundColor:"transparent",backgroundShadowColor:"transparent",borderColor:"transparent",borderDash:[],borderDashOffset:0,borderJoinStyle:"miter",borderShadowColor:"transparent",borderWidth:0,color:"black",content:null,display:!0,font:{family:void 0,lineHeight:void 0,size:void 0,style:void 0,weight:void 0},height:void 0,hitTolerance:0,init:void 0,opacity:void 0,position:"center",rotation:0,shadowBlur:0,shadowOffsetX:0,shadowOffsetY:0,spacing:1,textAlign:"center",textStrokeColor:void 0,textStrokeWidth:0,width:void 0,xAdjust:0,yAdjust:0};le.defaultRoutes={};function Zn(t,e){return t.getSortedVisibleDatasetMetas().reduce(function(n,r){const o=r.controller;return o instanceof $t&&er(t,e,r.data)&&(!n||o.innerRadius<n.controller.innerRadius)&&o.options.circumference>=90?r:n},void 0)}function er(t,e,n){if(!e.autoHide)return!0;for(let r=0;r<n.length;r++)if(!n[r].hidden&&t.getDataVisibility(r))return!0}function tr({chartArea:t},e,n){const{left:r,top:o,right:s,bottom:i}=t,{innerRadius:a,offsetX:l,offsetY:d}=n.controller,c=(r+s)/2+l,f=(o+i)/2+d,h={left:Math.max(c-a,r),right:Math.min(c+a,s),top:Math.max(f-a,o),bottom:Math.min(f+a,i)},b={x:(h.left+h.right)/2,y:(h.top+h.bottom)/2},g=e.spacing+e.borderWidth/2,p=a-g,y=b.y>f,m=y?o+g:i-g,x=rr(m,c,f,p);return{controllerMeta:{_centerX:c,_centerY:f,_radius:p,_counterclockwise:y,...x},point:b,radius:Math.min(a,Math.min(h.right-h.left,h.bottom-h.top)/2)}}function nr({width:t,height:e},n){const r=Math.sqrt(Math.pow(t,2)+Math.pow(e,2));return n*2/r}function rr(t,e,n,r){const o=Math.pow(n-t,2),s=Math.pow(r,2),i=e*-2,a=Math.pow(e,2)+o-s,l=Math.pow(i,2)-4*a;if(l<=0)return{_startAngle:0,_endAngle:st};const d=(-i-Math.sqrt(l))/2,c=(-i+Math.sqrt(l))/2;return{_startAngle:Oe({x:e,y:n},{x:d,y:t}).angle,_endAngle:Oe({x:e,y:n},{x:c,y:t}).angle}}function or(t,e){const{_centerX:n,_centerY:r,_radius:o,_startAngle:s,_endAngle:i,_counterclockwise:a,options:l}=e;t.save();const d=j(t,l);t.fillStyle=l.backgroundColor,t.beginPath(),t.arc(n,r,o,s,i,a),t.closePath(),t.fill(),d&&t.stroke(),t.restore()}class U extends _{inRange(e,n,r,o){return lt({x:e,y:n},{rect:this.getProps(["x","y","x2","y2"],o),center:this.getCenterPoint(o)},r,{rotation:this.rotation,borderWidth:this.options.borderWidth,hitTolerance:this.options.hitTolerance})}getCenterPoint(e){return O(this,e)}draw(e){const n=this.options,r=!S(this._visible)||this._visible;!n.display||!n.content||!r||(e.save(),ie(e,this.getCenterPoint(),this.rotation),Pn(e,this),pt(e,this,n),xt(e,sr(this),n),e.restore())}resolveElementProperties(e,n){let r;if(bt(n))r=jt(e,n);else{const{centerX:a,centerY:l}=De(e,n);r={x:a,y:l}}const o=re(n.padding),s=ae(e.ctx,n),i=ht(r,s,n,o);return{initProperties:z(e,i,n),pointX:r.x,pointY:r.y,...i,rotation:n.rotation}}}U.id="labelAnnotation";U.defaults={adjustScaleRange:!0,backgroundColor:"transparent",backgroundShadowColor:"transparent",borderCapStyle:"butt",borderDash:[],borderDashOffset:0,borderJoinStyle:"miter",borderRadius:0,borderShadowColor:"transparent",borderWidth:0,callout:{borderCapStyle:"butt",borderColor:void 0,borderDash:[],borderDashOffset:0,borderJoinStyle:"miter",borderWidth:1,display:!1,margin:5,position:"auto",side:5,start:"50%"},color:"black",content:null,display:!0,font:{family:void 0,lineHeight:void 0,size:void 0,style:void 0,weight:void 0},height:void 0,hitTolerance:0,init:void 0,opacity:void 0,padding:6,position:"center",rotation:0,shadowBlur:0,shadowOffsetX:0,shadowOffsetY:0,textAlign:"center",textStrokeColor:void 0,textStrokeWidth:0,width:void 0,xAdjust:0,xMax:void 0,xMin:void 0,xScaleID:void 0,xValue:void 0,yAdjust:0,yMax:void 0,yMin:void 0,yScaleID:void 0,yValue:void 0,z:0};U.defaultRoutes={borderColor:"color"};function sr({x:t,y:e,width:n,height:r,options:o}){const s=o.borderWidth/2,i=re(o.padding);return{x:t+i.left+s,y:e+i.top+s,width:n-i.left-i.right-o.borderWidth,height:r-i.top-i.bottom-o.borderWidth}}const Ne=(t,e,n)=>({x:t.x+n*(e.x-t.x),y:t.y+n*(e.y-t.y)}),ye=(t,e,n)=>Ne(e,n,Math.abs((t-e.y)/(n.y-e.y))).x,$e=(t,e,n)=>Ne(e,n,Math.abs((t-e.x)/(n.x-e.x))).y,F=t=>t*t,ir=(t,e,{x:n,y:r,x2:o,y2:s},i)=>i==="y"?{start:Math.min(r,s),end:Math.max(r,s),value:e}:{start:Math.min(n,o),end:Math.max(n,o),value:t},Fe=(t,e,n,r)=>(1-r)*(1-r)*t+2*(1-r)*r*e+r*r*n,pe=(t,e,n,r)=>({x:Fe(t.x,e.x,n.x,r),y:Fe(t.y,e.y,n.y,r)}),qe=(t,e,n,r)=>2*(1-r)*(e-t)+2*r*(n-e),Ue=(t,e,n,r)=>-Math.atan2(qe(t.x,e.x,n.x,r),qe(t.y,e.y,n.y,r))+.5*w;class G extends _{inRange(e,n,r,o){const s=(this.options.borderWidth+this.options.hitTolerance)/2;if(r!=="x"&&r!=="y"){const i={mouseX:e,mouseY:n},{path:a,ctx:l}=this;if(a){j(l,this.options),l.lineWidth+=this.options.hitTolerance;const{chart:c}=this.$context,f=e*c.currentDevicePixelRatio,h=n*c.currentDevicePixelRatio,b=l.isPointInStroke(a,f,h)||xe(this,i,o);return l.restore(),b}const d=F(s);return cr(this,i,d,o)||xe(this,i,o)}return ar(this,{mouseX:e,mouseY:n},r,{hitSize:s,useFinalPosition:o})}getCenterPoint(e){return O(this,e)}draw(e){const{x:n,y:r,x2:o,y2:s,cp:i,options:a}=this;if(e.save(),!j(e,a))return e.restore();X(e,a);const l=Math.sqrt(Math.pow(o-n,2)+Math.pow(s-r,2));if(a.curve&&i)return pr(e,this,i,l),e.restore();const{startOpts:d,endOpts:c,startAdjust:f,endAdjust:h}=Pt(this),b=Math.atan2(s-r,o-n);e.translate(n,r),e.rotate(b),e.beginPath(),e.moveTo(0+f,0),e.lineTo(l-h,0),e.shadowColor=a.borderShadowColor,e.stroke(),we(e,0,f,d),we(e,l,-h,c),e.restore()}get label(){return this.elements&&this.elements[0]}resolveElementProperties(e,n){const r=On(e,n),{x:o,y:s,x2:i,y2:a}=r,l=lr(r,e.chartArea),d=l?dr({x:o,y:s},{x:i,y:a},e.chartArea):{x:o,y:s,x2:i,y2:a,width:Math.abs(i-o),height:Math.abs(a-s)};if(d.centerX=(i+o)/2,d.centerY=(a+s)/2,d.initProperties=z(e,d,n),n.curve){const f={x:d.x,y:d.y},h={x:d.x2,y:d.y2};d.cp=yr(d,n,Ce(f,h))}const c=ur(e,d,n.label);return c._visible=l,d.elements=[{type:"label",optionScope:"label",properties:c,initProperties:d.initProperties}],d}}G.id="lineAnnotation";const Ge={backgroundColor:void 0,backgroundShadowColor:void 0,borderColor:void 0,borderDash:void 0,borderDashOffset:void 0,borderShadowColor:void 0,borderWidth:void 0,display:void 0,fill:void 0,length:void 0,shadowBlur:void 0,shadowOffsetX:void 0,shadowOffsetY:void 0,width:void 0};G.defaults={adjustScaleRange:!0,arrowHeads:{display:!1,end:Object.assign({},Ge),fill:!1,length:12,start:Object.assign({},Ge),width:6},borderDash:[],borderDashOffset:0,borderShadowColor:"transparent",borderWidth:2,curve:!1,controlPoint:{y:"-50%"},display:!0,endValue:void 0,init:void 0,hitTolerance:0,label:{backgroundColor:"rgba(0,0,0,0.8)",backgroundShadowColor:"transparent",borderCapStyle:"butt",borderColor:"black",borderDash:[],borderDashOffset:0,borderJoinStyle:"miter",borderRadius:6,borderShadowColor:"transparent",borderWidth:0,callout:Object.assign({},U.defaults.callout),color:"#fff",content:null,display:!1,drawTime:void 0,font:{family:void 0,lineHeight:void 0,size:void 0,style:void 0,weight:"bold"},height:void 0,hitTolerance:void 0,opacity:void 0,padding:6,position:"center",rotation:0,shadowBlur:0,shadowOffsetX:0,shadowOffsetY:0,textAlign:"center",textStrokeColor:void 0,textStrokeWidth:0,width:void 0,xAdjust:0,yAdjust:0,z:void 0},scaleID:void 0,shadowBlur:0,shadowOffsetX:0,shadowOffsetY:0,value:void 0,xMax:void 0,xMin:void 0,xScaleID:void 0,yMax:void 0,yMin:void 0,yScaleID:void 0,z:0};G.descriptors={arrowHeads:{start:{_fallback:!0},end:{_fallback:!0},_fallback:!0}};G.defaultRoutes={borderColor:"color"};function ar(t,{mouseX:e,mouseY:n},r,{hitSize:o,useFinalPosition:s}){const i=ir(e,n,t.getProps(["x","y","x2","y2"],s),r);return it(i,o)||xe(t,{mouseX:e,mouseY:n},s,r)}function lr({x:t,y:e,x2:n,y2:r},{top:o,right:s,bottom:i,left:a}){return!(t<a&&n<a||t>s&&n>s||e<o&&r<o||e>i&&r>i)}function Je({x:t,y:e},n,{top:r,right:o,bottom:s,left:i}){return t<i&&(e=$e(i,{x:t,y:e},n),t=i),t>o&&(e=$e(o,{x:t,y:e},n),t=o),e<r&&(t=ye(r,{x:t,y:e},n),e=r),e>s&&(t=ye(s,{x:t,y:e},n),e=s),{x:t,y:e}}function dr(t,e,n){const{x:r,y:o}=Je(t,e,n),{x:s,y:i}=Je(e,t,n);return{x:r,y:o,x2:s,y2:i,width:Math.abs(s-r),height:Math.abs(i-o)}}function cr(t,{mouseX:e,mouseY:n},r=N,o){const{x:s,y:i,x2:a,y2:l}=t.getProps(["x","y","x2","y2"],o),d=a-s,c=l-i,f=F(d)+F(c),h=f===0?-1:((e-s)*d+(n-i)*c)/f;let b,g;return h<0?(b=s,g=i):h>1?(b=a,g=l):(b=s+h*d,g=i+h*c),F(e-b)+F(n-g)<=r}function xe(t,{mouseX:e,mouseY:n},r,o){const s=t.label;return s.options.display&&s.inRange(e,n,o,r)}function ur(t,e,n){const r=n.borderWidth,o=re(n.padding),s=ae(t.ctx,n),i=s.width+o.width+r,a=s.height+o.height+r;return fr(e,n,{width:i,height:a,padding:o},t.chartArea)}function hr(t){const{x:e,y:n,x2:r,y2:o}=t,s=Math.atan2(o-n,r-e);return s>w/2?s-w:s<w/-2?s+w:s}function fr(t,e,n,r){const{width:o,height:s,padding:i}=n,{xAdjust:a,yAdjust:l}=e,d={x:t.x,y:t.y},c={x:t.x2,y:t.y2},f=e.rotation==="auto"?hr(t):M(e.rotation),h=gr(o,s,f),b=br(t,e,{labelSize:h,padding:i},r),g=t.cp?pe(d,t.cp,c,b):Ne(d,c,b),p={size:h.w,min:r.left,max:r.right,padding:i.left},y={size:h.h,min:r.top,max:r.bottom,padding:i.top},m=Qe(g.x,p)+a,x=Qe(g.y,y)+l;return{x:m-o/2,y:x-s/2,x2:m+o/2,y2:x+s/2,centerX:m,centerY:x,pointX:g.x,pointY:g.y,width:o,height:s,rotation:qt(f)}}function gr(t,e,n){const r=Math.cos(n),o=Math.sin(n);return{w:Math.abs(t*r)+Math.abs(e*o),h:Math.abs(t*o)+Math.abs(e*r)}}function br(t,e,n,r){let o;const s=mr(t,r);return e.position==="start"?o=Ke({w:t.x2-t.x,h:t.y2-t.y},n,e,s):e.position==="end"?o=1-Ke({w:t.x-t.x2,h:t.y-t.y2},n,e,s):o=Pe(1,e.position),o}function Ke(t,e,n,r){const{labelSize:o,padding:s}=e,i=t.w*r.dx,a=t.h*r.dy,l=i>0&&(o.w/2+s.left-r.x)/i,d=a>0&&(o.h/2+s.top-r.y)/a;return oe(Math.max(l,d),0,.25)}function mr(t,e){const{x:n,x2:r,y:o,y2:s}=t,i=Math.min(o,s)-e.top,a=Math.min(n,r)-e.left,l=e.bottom-Math.max(o,s),d=e.right-Math.max(n,r);return{x:Math.min(a,d),y:Math.min(i,l),dx:a<=d?1:-1,dy:i<=l?1:-1}}function Qe(t,e){const{size:n,min:r,max:o,padding:s}=e,i=n/2;return n>o-r?(o+r)/2:(r>=t-s-i&&(t=r+s+i),o<=t+s+i&&(t=o-s-i),t)}function Pt(t){const e=t.options,n=e.arrowHeads&&e.arrowHeads.start,r=e.arrowHeads&&e.arrowHeads.end;return{startOpts:n,endOpts:r,startAdjust:Ze(t,n),endAdjust:Ze(t,r)}}function Ze(t,e){if(!e||!e.display)return 0;const{length:n,width:r}=e,o=t.options.borderWidth/2,s={x:n,y:r+o};return Math.abs(ye(0,s,{x:0,y:o}))}function we(t,e,n,r){if(!r||!r.display)return;const{length:o,width:s,fill:i,backgroundColor:a,borderColor:l}=r,d=Math.abs(e-o)+n;t.beginPath(),X(t,r),j(t,r),t.moveTo(d,-s),t.lineTo(e+n,0),t.lineTo(d,s),i===!0?(t.fillStyle=a||l,t.closePath(),t.fill(),t.shadowColor="transparent"):t.shadowColor=r.borderShadowColor,t.stroke()}function yr(t,e,n){const{x:r,y:o,x2:s,y2:i,centerX:a,centerY:l}=t,d=Math.atan2(i-o,s-r),c=Ae(e.controlPoint,0),f={x:a+P(n,c.x,!1),y:l+P(n,c.y,!1)};return I(f,{x:a,y:l},d)}function et(t,{x:e,y:n},{angle:r,adjust:o},s){!s||!s.display||(t.save(),t.translate(e,n),t.rotate(r),we(t,0,-o,s),t.restore())}function pr(t,e,n,r){const{x:o,y:s,x2:i,y2:a,options:l}=e,{startOpts:d,endOpts:c,startAdjust:f,endAdjust:h}=Pt(e),b={x:o,y:s},g={x:i,y:a},p=Ue(b,n,g,0),y=Ue(b,n,g,1)-w,m=pe(b,n,g,f/r),x=pe(b,n,g,1-h/r),C=new Path2D;t.beginPath(),C.moveTo(m.x,m.y),C.quadraticCurveTo(n.x,n.y,x.x,x.y),t.shadowColor=l.borderShadowColor,t.stroke(C),e.path=C,e.ctx=t,et(t,m,{angle:p,adjust:f},d),et(t,x,{angle:y,adjust:h},c)}class J extends _{inRange(e,n,r,o){const s=this.options.rotation,i=(this.options.borderWidth+this.options.hitTolerance)/2;if(r!=="x"&&r!=="y")return xr({x:e,y:n},this.getProps(["width","height","centerX","centerY"],o),s,i);const{x:a,y:l,x2:d,y2:c}=this.getProps(["x","y","x2","y2"],o),f=r==="y"?{start:l,end:c}:{start:a,end:d},h=I({x:e,y:n},this.getCenterPoint(o),M(-s));return h[r]>=f.start-i-N&&h[r]<=f.end+i+N}getCenterPoint(e){return O(this,e)}draw(e){const{width:n,height:r,centerX:o,centerY:s,options:i}=this;e.save(),ie(e,this.getCenterPoint(),i.rotation),X(e,this.options),e.beginPath(),e.fillStyle=i.backgroundColor;const a=j(e,i);e.ellipse(o,s,r/2,n/2,w/2,0,2*w),e.fill(),a&&(e.shadowColor=i.borderShadowColor,e.stroke()),e.restore()}get label(){return this.elements&&this.elements[0]}resolveElementProperties(e,n){return Ct(e,n)}}J.id="ellipseAnnotation";J.defaults={adjustScaleRange:!0,backgroundShadowColor:"transparent",borderDash:[],borderDashOffset:0,borderShadowColor:"transparent",borderWidth:1,display:!0,hitTolerance:0,init:void 0,label:Object.assign({},H.defaults.label),rotation:0,shadowBlur:0,shadowOffsetX:0,shadowOffsetY:0,xMax:void 0,xMin:void 0,xScaleID:void 0,yMax:void 0,yMin:void 0,yScaleID:void 0,z:0};J.defaultRoutes={borderColor:"color",backgroundColor:"color"};J.descriptors={label:{_fallback:!0}};function xr(t,e,n,r){const{width:o,height:s,centerX:i,centerY:a}=e,l=o/2,d=s/2;if(l<=0||d<=0)return!1;const c=M(n||0),f=Math.cos(c),h=Math.sin(c),b=Math.pow(f*(t.x-i)+h*(t.y-a),2),g=Math.pow(h*(t.x-i)-f*(t.y-a),2);return b/Math.pow(l+r,2)+g/Math.pow(d+r,2)<=1.0001}class de extends _{inRange(e,n,r,o){const{x:s,y:i,x2:a,y2:l,width:d}=this.getProps(["x","y","x2","y2","width"],o),c=(this.options.borderWidth+this.options.hitTolerance)/2;return r!=="x"&&r!=="y"?fn({x:e,y:n},this.getCenterPoint(o),d/2,c):it(r==="y"?{start:i,end:l,value:n}:{start:s,end:a,value:e},c)}getCenterPoint(e){return O(this,e)}draw(e){const n=this.options,r=n.borderWidth;if(n.radius<.1)return;e.save(),e.fillStyle=n.backgroundColor,X(e,n);const o=j(e,n);Sn(e,this,this.centerX,this.centerY),o&&!se(n.pointStyle)&&(e.shadowColor=n.borderShadowColor,e.stroke()),e.restore(),n.borderWidth=r}resolveElementProperties(e,n){const r=Mt(e,n);return r.initProperties=z(e,r,n),r}}de.id="pointAnnotation";de.defaults={adjustScaleRange:!0,backgroundShadowColor:"transparent",borderDash:[],borderDashOffset:0,borderShadowColor:"transparent",borderWidth:1,display:!0,hitTolerance:0,init:void 0,pointStyle:"circle",radius:10,rotation:0,shadowBlur:0,shadowOffsetX:0,shadowOffsetY:0,xAdjust:0,xMax:void 0,xMin:void 0,xScaleID:void 0,xValue:void 0,yAdjust:0,yMax:void 0,yMin:void 0,yScaleID:void 0,yValue:void 0,z:0};de.defaultRoutes={borderColor:"color",backgroundColor:"color"};class ce extends _{inRange(e,n,r,o){if(r!=="x"&&r!=="y")return this.options.radius>=.1&&this.elements.length>1&&Sr(this.elements,e,n,o);const s=I({x:e,y:n},this.getCenterPoint(o),M(-this.options.rotation)),i=this.elements.map(d=>r==="y"?d.bY:d.bX),a=Math.min(...i),l=Math.max(...i);return s[r]>=a&&s[r]<=l}getCenterPoint(e){return O(this,e)}draw(e){const{elements:n,options:r}=this;e.save(),e.beginPath(),e.fillStyle=r.backgroundColor,X(e,r);const o=j(e,r);let s=!0;for(const i of n)s?(e.moveTo(i.x,i.y),s=!1):e.lineTo(i.x,i.y);e.closePath(),e.fill(),o&&(e.shadowColor=r.borderShadowColor,e.stroke()),e.restore()}resolveElementProperties(e,n){const r=Mt(e,n),{sides:o,rotation:s}=n,i=[],a=2*w/o;let l=s*rt;for(let d=0;d<o;d++,l+=a){const c=wr(r,n,l);c.initProperties=z(e,r,n),i.push(c)}return r.elements=i,r}}ce.id="polygonAnnotation";ce.defaults={adjustScaleRange:!0,backgroundShadowColor:"transparent",borderCapStyle:"butt",borderDash:[],borderDashOffset:0,borderJoinStyle:"miter",borderShadowColor:"transparent",borderWidth:1,display:!0,hitTolerance:0,init:void 0,point:{radius:0},radius:10,rotation:0,shadowBlur:0,shadowOffsetX:0,shadowOffsetY:0,sides:3,xAdjust:0,xMax:void 0,xMin:void 0,xScaleID:void 0,xValue:void 0,yAdjust:0,yMax:void 0,yMin:void 0,yScaleID:void 0,yValue:void 0,z:0};ce.defaultRoutes={borderColor:"color",backgroundColor:"color"};function wr({centerX:t,centerY:e},{radius:n,borderWidth:r,hitTolerance:o},s){const i=(r+o)/2,a=Math.sin(s),l=Math.cos(s),d={x:t+a*n,y:e-l*n};return{type:"point",optionScope:"point",properties:{x:d.x,y:d.y,centerX:d.x,centerY:d.y,bX:t+a*(n+i),bY:e-l*(n+i)}}}function Sr(t,e,n,r){let o=!1,s=t[t.length-1].getProps(["bX","bY"],r);for(const i of t){const a=i.getProps(["bX","bY"],r);a.bY>n!=s.bY>n&&e<(s.bX-a.bX)*(n-a.bY)/(s.bY-a.bY)+a.bX&&(o=!o),s=a}return o}const v={box:H,doughnutLabel:le,ellipse:J,label:U,line:G,point:de,polygon:ce};Object.keys(v).forEach(t=>{Ut.describe(`elements.${v[t].id}`,{_fallback:"plugins.annotation.common"})});const jr={update:Object.assign},Mr=Te.concat(ne),tt=(t,e)=>L(e)?je(t,e):t,Se=t=>t==="color"||t==="font";function Re(t="line"){return v[t]?t:(console.warn(`Unknown annotation type: '${t}', defaulting to 'line'`),"line")}function Cr(t,e,n,r){const o=vr(t,n.animations,r),s=e.annotations,i=Dr(e.elements,s);for(let a=0;a<s.length;a++){const l=s[a],d=At(i,a,l.type),c=l.setContext(Ar(t,d,i,l)),f=d.resolveElementProperties(t,c);f.skip=kr(f),"elements"in f&&(Pr(d,f.elements,c,o),delete f.elements),S(d.x)||Object.assign(d,f),Object.assign(d,f.initProperties),f.options=Dt(c),o.update(d,f)}}function kr(t){return isNaN(t.x)||isNaN(t.y)}function vr(t,e,n){return n==="reset"||n==="none"||n==="resize"?jr:new Ft(t,e)}function Pr(t,e,n,r){const o=t.elements||(t.elements=[]);o.length=e.length;for(let s=0;s<e.length;s++){const i=e[s],a=i.properties,l=At(o,s,i.type,i.initProperties),d=n[i.optionScope].override(i);a.options=Dt(d),r.update(l,a)}}function At(t,e,n,r){const o=v[Re(n)];let s=t[e];return(!s||!(s instanceof o))&&(s=t[e]=new o,Object.assign(s,r)),s}function Dt(t){const e=v[Re(t.type)],n={};n.id=t.id,n.type=t.type,n.drawTime=t.drawTime,Object.assign(n,je(t,e.defaults),je(t,e.defaultRoutes));for(const r of Mr)n[r]=t[r];return n}function je(t,e){const n={};for(const r of Object.keys(e)){const o=e[r],s=t[r];Se(r)&&W(s)?n[r]=s.map(i=>tt(i,o)):n[r]=tt(s,o)}return n}function Ar(t,e,n,r){return e.$context||(e.$context=Object.assign(Object.create(t.getContext()),{element:e,get elements(){return n.filter(o=>o&&o.options)},id:r.id,type:"annotation"}))}function Dr(t,e){const n=e.length,r=t.length;if(r<n){const o=n-r;t.splice(r,0,...new Array(o))}else r>n&&t.splice(n,r-n);return t}var Tr="3.1.0";const k=new Map,nt=t=>t.type!=="doughnutLabel",Nr=Te.concat(ne);var Rr={id:"annotation",version:Tr,beforeRegister(){gn("chart.js","4.0",ee.version)},afterRegister(){ee.register(v)},afterUnregister(){ee.unregister(v)},beforeInit(t){k.set(t,{annotations:[],elements:[],visibleElements:[],listeners:{},listened:!1,moveListened:!1,hooks:{},hooked:!1,hovered:[]})},beforeUpdate(t,e,n){const r=k.get(t),o=r.annotations=[];let s=n.annotations;L(s)?Object.keys(s).forEach(i=>{const a=s[i];L(a)&&(a.id=i,o.push(a))}):W(s)&&o.push(...s),Un(o.filter(nt),t.scales)},afterDataLimits(t,e){const n=k.get(t);qn(t,e.scale,n.annotations.filter(nt).filter(r=>r.display&&r.adjustScaleRange))},afterUpdate(t,e,n){const r=k.get(t);Hn(t,r,n),Cr(t,r,n,e.mode),r.visibleElements=r.elements.filter(o=>!o.skip&&o.options.display),Fn(t,r,n)},beforeDatasetsDraw(t,e,n){$(t,"beforeDatasetsDraw",n.clip)},afterDatasetsDraw(t,e,n){$(t,"afterDatasetsDraw",n.clip)},beforeDatasetDraw(t,e,n){$(t,e.index,n.clip)},beforeDraw(t,e,n){$(t,"beforeDraw",n.clip)},afterDraw(t,e,n){$(t,"afterDraw",n.clip)},beforeEvent(t,e,n){const r=k.get(t);Bn(r,e.event,n)&&(e.changed=!0)},afterDestroy(t){k.delete(t)},getAnnotations(t){const e=k.get(t);return e?e.elements:[]},_getAnnotationElementsAtEventForMode(t,e,n){return ve(t,e,n)},defaults:{animations:{numbers:{properties:["x","y","x2","y2","width","height","centerX","centerY","pointX","pointY","radius"],type:"number"},colors:{properties:["backgroundColor","borderColor"],type:"color"}},clip:!0,interaction:{mode:void 0,axis:void 0,intersect:void 0},common:{drawTime:"afterDatasetsDraw",init:!1,label:{}}},descriptors:{_indexable:!1,_scriptable:t=>!Nr.includes(t)&&t!=="init",annotations:{_allKeys:!1,_fallback:(t,e)=>`elements.${v[Re(e.type)].id}`},interaction:{_fallback:!0},common:{label:{_indexable:Se,_fallback:!0},_indexable:Se}},additionalOptionScopes:[""]};function $(t,e,n){const{ctx:r,chartArea:o}=t,s=k.get(t);n&&Xt(r,o);const i=_r(s.visibleElements,e).sort((a,l)=>a.element.options.z-l.element.options.z);for(const a of i)Ir(r,o,s,a);n&&Ht(r)}function _r(t,e){const n=[];for(const r of t)if(r.options.drawTime===e&&n.push({element:r,main:!0}),r.elements&&r.elements.length)for(const o of r.elements)o.options.display&&o.options.drawTime===e&&n.push({element:o});return n}function Ir(t,e,n,r){const o=r.element;r.main?(He(n,o,"beforeDraw"),o.draw(t,e),He(n,o,"afterDraw")):o.draw(t,e)}ee.register(Jt,Kt,Qt,Zt,en,tn,nn,rn,Rr);async function Or(t,e){const n=await fetch(t,{headers:{"Content-Type":"application/json"},...e});if(!n.ok){const r=await n.json().catch(()=>({})),o=r.detail||r.message||`Request failed (${n.status})`;throw new Error(o)}if(n.status!==204)return n.json()}const Er=[{value:"3",label:"3 days"},{value:"5",label:"5 days"},{value:"7",label:"7 days"}];function Z(t){var s;if(!t)return"—";const e=new Date(t.start),n=e.toLocaleTimeString("en-GB",{hour:"2-digit",minute:"2-digit"}),r=e.toLocaleDateString("en-GB",{weekday:"short",day:"numeric",month:"short"});return`${((s=t.price_pred_pence)==null?void 0:s.toFixed(2))??"—"} p/kWh • ${r} ${n}`}function Lr(t){return t?new Date(t).toLocaleString("en-GB",{weekday:"short",hour:"2-digit",minute:"2-digit",day:"numeric",month:"short"}):"—"}function Wr(t){const e=t.map(r=>r.price_pred_pence).filter(r=>typeof r=="number");if(!e.length)return null;const n=e.reduce((r,o)=>r+o,0);return Number((n/e.length).toFixed(2))}function Br(){const[t,e]=K.useState("7"),{data:n,isLoading:r,isFetching:o,error:s,refetch:i}=Tt({queryKey:["agile-forecast",t],queryFn:()=>Or(`/api/energy/agile-forecast?days=${t}`),refetchInterval:3e5}),a=K.useMemo(()=>{var h;return(h=n==null?void 0:n.days)!=null&&h.length?n.days.flatMap(b=>b.slots.filter(g=>typeof g.price_pred_pence=="number").map(g=>({timestamp:g.start,price:g.price_pred_pence}))):[]},[n]),l=K.useMemo(()=>a.length?{labels:a.map(h=>new Date(h.timestamp)),datasets:[{label:"Predicted price",data:a.map(h=>h.price),borderColor:"rgba(59, 130, 246, 1)",backgroundColor:"rgba(59, 130, 246, 0.1)",tension:.35,pointRadius:0}]}:null,[a]),d=K.useMemo(()=>({responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1},tooltip:{callbacks:{label:h=>{var g;return`${(typeof((g=h.parsed)==null?void 0:g.y)=="number"?h.parsed.y:0).toFixed(2)} p/kWh`}}},annotation:{annotations:{line19p:{type:"line",yMin:19,yMax:19,borderColor:"rgba(234, 179, 8, 0.7)",borderWidth:2,borderDash:[6,6],label:{display:!0,content:"19p/kWh",position:"end",backgroundColor:"rgba(234, 179, 8, 0.2)",color:"rgba(234, 179, 8, 1)",font:{size:11},padding:4}},line30p:{type:"line",yMin:30,yMax:30,borderColor:"rgba(239, 68, 68, 0.7)",borderWidth:2,borderDash:[6,6],label:{display:!0,content:"30p/kWh",position:"end",backgroundColor:"rgba(239, 68, 68, 0.2)",color:"rgba(239, 68, 68, 1)",font:{size:11},padding:4}}}}},scales:{x:{type:"time",time:{unit:"hour"},ticks:{maxRotation:0},grid:{color:"rgba(255,255,255,0.05)"}},y:{beginAtZero:!1,title:{display:!0,text:"p/kWh"},grid:{color:"rgba(255,255,255,0.05)"}}}}),[]),c=(n==null?void 0:n.days)??[],f=n==null?void 0:n.summary;return u.jsxs("div",{className:"space-y-8",children:[u.jsxs("div",{className:"flex flex-col gap-2",children:[u.jsxs("div",{className:"flex items-center gap-3 text-sm uppercase tracking-widest text-blue-300",children:[u.jsx(Nt,{className:"h-5 w-5"}),u.jsx("span",{children:"Agile Predict"})]}),u.jsx("h1",{className:"text-2xl font-semibold",children:"7-Day Agile Forecast"}),u.jsx("p",{className:"text-sm text-gray-400",children:"Ingested directly from AgilePredict.com with daily refresh windows at 04:30. Use the forecast to pre-stage automation rules, power plans, and miner bands."})]}),u.jsxs(D,{children:[u.jsxs(he,{className:"flex flex-col gap-4 border-b border-border/50 bg-muted/10 md:flex-row md:items-center md:justify-between",children:[u.jsxs("div",{children:[u.jsx("p",{className:"text-xs uppercase tracking-widest text-blue-300",children:"Forecast Controls"}),u.jsxs(fe,{className:"text-xl",children:["Region ",(n==null?void 0:n.region)??"—"]}),u.jsxs("p",{className:"text-sm text-muted-foreground",children:["Last updated ",Lr(n==null?void 0:n.forecast_created_at)]})]}),u.jsxs("div",{className:"flex flex-col gap-3 sm:flex-row sm:items-center",children:[u.jsxs(Rt,{value:t,onValueChange:e,children:[u.jsx(_t,{className:"w-full sm:w-32",children:u.jsx(It,{placeholder:"Days"})}),u.jsx(Ot,{children:Er.map(h=>u.jsx(Et,{value:h.value,children:h.label},h.value))})]}),u.jsxs(Lt,{onClick:()=>i(),variant:"secondary",disabled:o,className:"gap-2",children:[o?u.jsx(Ee,{className:"h-4 w-4 animate-spin"}):u.jsx(Wt,{className:"h-4 w-4"}),"Refresh"]})]})]}),u.jsxs(T,{className:"py-6",children:[s&&u.jsxs("div",{className:"flex items-center gap-3 rounded-md border border-red-500/40 bg-red-500/10 px-4 py-3 text-sm text-red-200",children:[u.jsx(Yt,{className:"h-4 w-4"}),u.jsx("span",{children:s instanceof Error?s.message:"Unable to load Agile Predict forecast."})]}),r?u.jsxs("div",{className:"flex items-center gap-3 text-muted-foreground",children:[u.jsx(Ee,{className:"h-4 w-4 animate-spin"}),"Loading forecast…"]}):null]})]}),f&&u.jsxs("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-4",children:[u.jsx(D,{children:u.jsxs(T,{className:"p-5",children:[u.jsx("p",{className:"text-xs uppercase text-gray-500",children:"Average price"}),u.jsx("p",{className:"mt-2 text-3xl font-semibold",children:f.average_price_pence?`${f.average_price_pence.toFixed(2)} p/kWh`:"—"})]})}),u.jsx(D,{children:u.jsxs(T,{className:"p-5",children:[u.jsx("p",{className:"text-xs uppercase text-gray-500",children:"Total slots"}),u.jsx("p",{className:"mt-2 text-3xl font-semibold",children:f.slot_count})]})}),u.jsx(D,{children:u.jsxs(T,{className:"p-5",children:[u.jsx("p",{className:"text-xs uppercase text-gray-500",children:"Cheapest slot"}),u.jsx("p",{className:"mt-2 text-sm text-muted-foreground",children:Z(f.cheapest_slot)})]})}),u.jsx(D,{children:u.jsxs(T,{className:"p-5",children:[u.jsx("p",{className:"text-xs uppercase text-gray-500",children:"Most expensive"}),u.jsx("p",{className:"mt-2 text-sm text-muted-foreground",children:Z(f.most_expensive_slot)})]})})]}),l&&u.jsxs(D,{children:[u.jsxs(he,{children:[u.jsx(fe,{children:"Price trajectory"}),u.jsx("p",{className:"text-sm text-muted-foreground",children:"Predicted half-hour slots over the selected window."})]}),u.jsx(T,{children:u.jsx("div",{className:"h-80",children:u.jsx(Gt,{data:l,options:d,"aria-label":"Agile forecast chart"})})})]}),l&&c.length>0&&u.jsx("div",{className:"rounded-md border border-border/40 bg-muted/5 p-4",children:u.jsx("div",{className:"flex divide-x divide-border/30",children:c.map(h=>{const b=new Date(h.date).toLocaleDateString("en-GB",{weekday:"long"});return u.jsxs("div",{className:"flex-1 px-3 text-center text-sm",children:[u.jsx("div",{className:"mb-2 h-4 w-px bg-blue-500/70 mx-auto"}),u.jsx("p",{className:"font-medium text-gray-200",children:b}),u.jsx("p",{className:"text-xs text-muted-foreground",children:new Date(h.date).toLocaleDateString("en-GB",{day:"numeric",month:"short"})})]},h.date)})})}),u.jsxs("div",{className:"space-y-4",children:[u.jsxs("div",{className:"flex items-center gap-3 text-sm uppercase tracking-widest text-blue-300",children:[u.jsx(an,{className:"h-5 w-5"}),u.jsx("span",{children:"Daily breakdown"})]}),u.jsx("div",{className:"grid gap-4 lg:grid-cols-2",children:c.map(h=>{const b=Wr(h.slots),g=[...h.slots].sort((y,m)=>(y.price_pred_pence??1/0)-(m.price_pred_pence??1/0))[0],p=[...h.slots].sort((y,m)=>(m.price_pred_pence??-1/0)-(y.price_pred_pence??-1/0))[0];return u.jsxs(D,{className:"border-border/60",children:[u.jsxs(he,{children:[u.jsx(fe,{className:"text-lg",children:new Date(h.date).toLocaleDateString("en-GB",{weekday:"long",day:"numeric",month:"long"})}),u.jsxs("p",{className:"text-sm text-muted-foreground",children:["Average ",b?`${b.toFixed(2)} p/kWh`:"—"]})]}),u.jsxs(T,{className:"space-y-4",children:[u.jsxs("div",{className:"grid gap-3 md:grid-cols-2",children:[u.jsxs("div",{className:"rounded-md border border-emerald-500/40 bg-emerald-500/5 p-3 text-sm",children:[u.jsxs("div",{className:"flex items-center gap-2 text-emerald-300",children:[u.jsx(on,{className:"h-4 w-4"}),"Cheapest"]}),u.jsx("p",{className:"mt-1 text-muted-foreground",children:Z(g)})]}),u.jsxs("div",{className:"rounded-md border border-rose-500/40 bg-rose-500/5 p-3 text-sm",children:[u.jsxs("div",{className:"flex items-center gap-2 text-rose-300",children:[u.jsx(sn,{className:"h-4 w-4"}),"Expensive"]}),u.jsx("p",{className:"mt-1 text-muted-foreground",children:Z(p)})]})]}),u.jsx("div",{className:"grid gap-2 sm:grid-cols-2",children:h.slots.slice(0,8).map(y=>{var m;return u.jsxs("div",{className:zt("flex items-center justify-between rounded-md border px-3 py-2 text-sm",(y.price_pred_pence??0)<=(b??0)?"border-emerald-500/40 bg-emerald-500/5":"border-amber-500/40 bg-amber-500/5"),children:[u.jsx("span",{children:new Date(y.start).toLocaleTimeString("en-GB",{hour:"2-digit",minute:"2-digit"})}),u.jsxs("span",{className:"font-medium",children:[(m=y.price_pred_pence)==null?void 0:m.toFixed(2),"p"]})]},y.start)})}),h.slots.length>8&&u.jsxs("p",{className:"text-xs text-muted-foreground",children:["+",h.slots.length-8," more half-hour slots"]})]})]},h.date)})})]})]})}export{Br as default};
