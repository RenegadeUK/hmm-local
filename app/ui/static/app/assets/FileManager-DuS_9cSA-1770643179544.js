import{c as ee,r as d,ak as L,j as o,X as oe,Q as Me,R as ie,ao as Se,S as Ce}from"./index-BRWQTsRy-1770643179544.js";import{C as Ee}from"./chevron-right-C_o41DVm-1770643179544.js";import{C as Fe}from"./copy-DJcuSY1t-1770643179544.js";import{D as Pe}from"./download-BwMs95GX-1770643179544.js";import{T as $e}from"./trash-2-CuuqmHKC-1770643179544.js";import{E as ke}from"./eye-BuaMCZjz-1770643179544.js";import{S as Re}from"./save-CSdA3PdH-1770643179544.js";/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const se=ee("FileCode",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["path",{d:"m10 13-2 2 2 2",key:"17smn8"}],["path",{d:"m14 17 2-2-2-2",key:"14mezr"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ce=ee("FileText",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["line",{x1:"16",x2:"8",y1:"13",y2:"13",key:"14keom"}],["line",{x1:"16",x2:"8",y1:"17",y2:"17",key:"17nazh"}],["line",{x1:"10",x2:"8",y1:"9",y2:"9",key:"1a5vjj"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ie=ee("File",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const le=ee("Folder",[["path",{d:"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z",key:"1kt360"}]]);function ue(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function Te(e){if(Array.isArray(e))return e}function Le(e,t,r){return(t=qe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function De(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,s,h,y=[],w=!0,j=!1;try{if(s=(r=r.call(e)).next,t!==0)for(;!(w=(n=s.call(r)).done)&&(y.push(n.value),y.length!==t);w=!0);}catch(C){j=!0,i=C}finally{try{if(!w&&r.return!=null&&(h=r.return(),Object(h)!==h))return}finally{if(j)throw i}}return y}}function Ae(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function de(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function pe(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?de(Object(r),!0).forEach(function(n){Le(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):de(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Ve(e,t){if(e==null)return{};var r,n,i=ze(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function ze(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function Ue(e,t){return Te(e)||De(e,t)||Be(e,t)||Ae()}function He(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function qe(e){var t=He(e,"string");return typeof t=="symbol"?t:t+""}function Be(e,t){if(e){if(typeof e=="string")return ue(e,t);var r={}.toString.call(e).slice(8,-1);return r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set"?Array.from(e):r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?ue(e,t):void 0}}function We(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function fe(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function he(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?fe(Object(r),!0).forEach(function(n){We(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):fe(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function _e(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return function(n){return t.reduceRight(function(i,s){return s(i)},n)}}function J(e){return function t(){for(var r=this,n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return i.length>=e.length?e.apply(this,i):function(){for(var h=arguments.length,y=new Array(h),w=0;w<h;w++)y[w]=arguments[w];return t.apply(r,[].concat(i,y))}}}function Z(e){return{}.toString.call(e).includes("Object")}function Je(e){return!Object.keys(e).length}function G(e){return typeof e=="function"}function Ke(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function Ge(e,t){return Z(t)||R("changeType"),Object.keys(t).some(function(r){return!Ke(e,r)})&&R("changeField"),t}function Qe(e){G(e)||R("selectorType")}function Xe(e){G(e)||Z(e)||R("handlerType"),Z(e)&&Object.values(e).some(function(t){return!G(t)})&&R("handlersType")}function Ye(e){e||R("initialIsRequired"),Z(e)||R("initialType"),Je(e)&&R("initialContent")}function Ze(e,t){throw new Error(e[t]||e.default)}var et={initialIsRequired:"initial state is required",initialType:"initial state should be an object",initialContent:"initial state shouldn't be an empty object",handlerType:"handler should be an object or a function",handlersType:"all handlers should be a functions",selectorType:"selector should be a function",changeType:"provided value of changes should be an object",changeField:'it seams you want to change a field in the state which is not specified in the "initial" state',default:"an unknown error accured in `state-local` package"},R=J(Ze)(et),X={changes:Ge,selector:Qe,handler:Xe,initial:Ye};function tt(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};X.initial(e),X.handler(t);var r={current:e},n=J(at)(r,t),i=J(nt)(r),s=J(X.changes)(e),h=J(rt)(r);function y(){var j=arguments.length>0&&arguments[0]!==void 0?arguments[0]:function(C){return C};return X.selector(j),j(r.current)}function w(j){_e(n,i,s,h)(j)}return[y,w]}function rt(e,t){return G(t)?t(e.current):t}function nt(e,t){return e.current=he(he({},e.current),t),t}function at(e,t,r){return G(t)?t(e.current):Object.keys(r).forEach(function(n){var i;return(i=t[n])===null||i===void 0?void 0:i.call(t,e.current[n])}),r}var ot={create:tt},it={paths:{vs:"https://cdn.jsdelivr.net/npm/monaco-editor@0.55.1/min/vs"}};function st(e){return function t(){for(var r=this,n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return i.length>=e.length?e.apply(this,i):function(){for(var h=arguments.length,y=new Array(h),w=0;w<h;w++)y[w]=arguments[w];return t.apply(r,[].concat(i,y))}}}function ct(e){return{}.toString.call(e).includes("Object")}function lt(e){return e||me("configIsRequired"),ct(e)||me("configType"),e.urls?(ut(),{paths:{vs:e.urls.monacoBase}}):e}function ut(){console.warn(ge.deprecation)}function dt(e,t){throw new Error(e[t]||e.default)}var ge={configIsRequired:"the configuration object is required",configType:"the configuration object should be an object",default:"an unknown error accured in `@monaco-editor/loader` package",deprecation:`Deprecation warning!
    You are using deprecated way of configuration.

    Instead of using
      monaco.config({ urls: { monacoBase: '...' } })
    use
      monaco.config({ paths: { vs: '...' } })

    For more please check the link https://github.com/suren-atoyan/monaco-loader#config
  `},me=st(dt)(ge),pt={config:lt},ft=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return function(i){return r.reduceRight(function(s,h){return h(s)},i)}};function ye(e,t){return Object.keys(t).forEach(function(r){t[r]instanceof Object&&e[r]&&Object.assign(t[r],ye(e[r],t[r]))}),pe(pe({},e),t)}var ht={type:"cancelation",msg:"operation is manually canceled"};function re(e){var t=!1,r=new Promise(function(n,i){e.then(function(s){return t?i(ht):n(s)}),e.catch(i)});return r.cancel=function(){return t=!0},r}var mt=["monaco"],gt=ot.create({config:it,isInitialized:!1,resolve:null,reject:null,monaco:null}),xe=Ue(gt,2),Q=xe[0],te=xe[1];function yt(e){var t=pt.config(e),r=t.monaco,n=Ve(t,mt);te(function(i){return{config:ye(i.config,n),monaco:r}})}function xt(){var e=Q(function(t){var r=t.monaco,n=t.isInitialized,i=t.resolve;return{monaco:r,isInitialized:n,resolve:i}});if(!e.isInitialized){if(te({isInitialized:!0}),e.monaco)return e.resolve(e.monaco),re(ne);if(window.monaco&&window.monaco.editor)return ve(window.monaco),e.resolve(window.monaco),re(ne);ft(vt,wt)(jt)}return re(ne)}function vt(e){return document.body.appendChild(e)}function bt(e){var t=document.createElement("script");return e&&(t.src=e),t}function wt(e){var t=Q(function(n){var i=n.config,s=n.reject;return{config:i,reject:s}}),r=bt("".concat(t.config.paths.vs,"/loader.js"));return r.onload=function(){return e()},r.onerror=t.reject,r}function jt(){var e=Q(function(r){var n=r.config,i=r.resolve,s=r.reject;return{config:n,resolve:i,reject:s}}),t=window.require;t.config(e.config),t(["vs/editor/editor.main"],function(r){var n=r.m||r;ve(n),e.resolve(n)},function(r){e.reject(r)})}function ve(e){Q().monaco||te({monaco:e})}function Nt(){return Q(function(e){var t=e.monaco;return t})}var ne=new Promise(function(e,t){return te({resolve:e,reject:t})}),be={config:yt,init:xt,__getMonacoInstance:Nt},Ot={wrapper:{display:"flex",position:"relative",textAlign:"initial"},fullWidth:{width:"100%"},hide:{display:"none"}},ae=Ot,Mt={container:{display:"flex",height:"100%",width:"100%",justifyContent:"center",alignItems:"center"}},St=Mt;function Ct({children:e}){return L.createElement("div",{style:St.container},e)}var Et=Ct,Ft=Et;function Pt({width:e,height:t,isEditorReady:r,loading:n,_ref:i,className:s,wrapperProps:h}){return L.createElement("section",{style:{...ae.wrapper,width:e,height:t},...h},!r&&L.createElement(Ft,null,n),L.createElement("div",{ref:i,style:{...ae.fullWidth,...!r&&ae.hide},className:s}))}var $t=Pt,we=d.memo($t);function kt(e){d.useEffect(e,[])}var je=kt;function Rt(e,t,r=!0){let n=d.useRef(!0);d.useEffect(n.current||!r?()=>{n.current=!1}:e,t)}var F=Rt;function K(){}function z(e,t,r,n){return It(e,n)||Tt(e,t,r,n)}function It(e,t){return e.editor.getModel(Ne(e,t))}function Tt(e,t,r,n){return e.editor.createModel(t,r,n?Ne(e,n):void 0)}function Ne(e,t){return e.Uri.parse(t)}function Lt({original:e,modified:t,language:r,originalLanguage:n,modifiedLanguage:i,originalModelPath:s,modifiedModelPath:h,keepCurrentOriginalModel:y=!1,keepCurrentModifiedModel:w=!1,theme:j="light",loading:C="Loading...",options:v={},height:P="100%",width:D="100%",className:U,wrapperProps:H={},beforeMount:q=K,onMount:B=K}){let[S,I]=d.useState(!1),[k,N]=d.useState(!0),O=d.useRef(null),x=d.useRef(null),T=d.useRef(null),M=d.useRef(B),p=d.useRef(q),a=d.useRef(!1);je(()=>{let l=be.init();return l.then(m=>(x.current=m)&&N(!1)).catch(m=>(m==null?void 0:m.type)!=="cancelation"&&console.error("Monaco initialization: error:",m)),()=>O.current?g():l.cancel()}),F(()=>{if(O.current&&x.current){let l=O.current.getOriginalEditor(),m=z(x.current,e||"",n||r||"text",s||"");m!==l.getModel()&&l.setModel(m)}},[s],S),F(()=>{if(O.current&&x.current){let l=O.current.getModifiedEditor(),m=z(x.current,t||"",i||r||"text",h||"");m!==l.getModel()&&l.setModel(m)}},[h],S),F(()=>{let l=O.current.getModifiedEditor();l.getOption(x.current.editor.EditorOption.readOnly)?l.setValue(t||""):t!==l.getValue()&&(l.executeEdits("",[{range:l.getModel().getFullModelRange(),text:t||"",forceMoveMarkers:!0}]),l.pushUndoStop())},[t],S),F(()=>{var l,m;(m=(l=O.current)==null?void 0:l.getModel())==null||m.original.setValue(e||"")},[e],S),F(()=>{let{original:l,modified:m}=O.current.getModel();x.current.editor.setModelLanguage(l,n||r||"text"),x.current.editor.setModelLanguage(m,i||r||"text")},[r,n,i],S),F(()=>{var l;(l=x.current)==null||l.editor.setTheme(j)},[j],S),F(()=>{var l;(l=O.current)==null||l.updateOptions(v)},[v],S);let c=d.useCallback(()=>{var $;if(!x.current)return;p.current(x.current);let l=z(x.current,e||"",n||r||"text",s||""),m=z(x.current,t||"",i||r||"text",h||"");($=O.current)==null||$.setModel({original:l,modified:m})},[r,t,i,e,n,s,h]),u=d.useCallback(()=>{var l;!a.current&&T.current&&(O.current=x.current.editor.createDiffEditor(T.current,{automaticLayout:!0,...v}),c(),(l=x.current)==null||l.editor.setTheme(j),I(!0),a.current=!0)},[v,j,c]);d.useEffect(()=>{S&&M.current(O.current,x.current)},[S]),d.useEffect(()=>{!k&&!S&&u()},[k,S,u]);function g(){var m,$,A,W;let l=(m=O.current)==null?void 0:m.getModel();y||(($=l==null?void 0:l.original)==null||$.dispose()),w||((A=l==null?void 0:l.modified)==null||A.dispose()),(W=O.current)==null||W.dispose()}return L.createElement(we,{width:D,height:P,isEditorReady:S,loading:C,_ref:T,className:U,wrapperProps:H})}var Dt=Lt;d.memo(Dt);function At(e){let t=d.useRef();return d.useEffect(()=>{t.current=e},[e]),t.current}var Vt=At,Y=new Map;function zt({defaultValue:e,defaultLanguage:t,defaultPath:r,value:n,language:i,path:s,theme:h="light",line:y,loading:w="Loading...",options:j={},overrideServices:C={},saveViewState:v=!0,keepCurrentModel:P=!1,width:D="100%",height:U="100%",className:H,wrapperProps:q={},beforeMount:B=K,onMount:S=K,onChange:I,onValidate:k=K}){let[N,O]=d.useState(!1),[x,T]=d.useState(!0),M=d.useRef(null),p=d.useRef(null),a=d.useRef(null),c=d.useRef(S),u=d.useRef(B),g=d.useRef(),l=d.useRef(n),m=Vt(s),$=d.useRef(!1),A=d.useRef(!1);je(()=>{let f=be.init();return f.then(b=>(M.current=b)&&T(!1)).catch(b=>(b==null?void 0:b.type)!=="cancelation"&&console.error("Monaco initialization: error:",b)),()=>p.current?Oe():f.cancel()}),F(()=>{var b,E,_,V;let f=z(M.current,e||n||"",t||i||"",s||r||"");f!==((b=p.current)==null?void 0:b.getModel())&&(v&&Y.set(m,(E=p.current)==null?void 0:E.saveViewState()),(_=p.current)==null||_.setModel(f),v&&((V=p.current)==null||V.restoreViewState(Y.get(s))))},[s],N),F(()=>{var f;(f=p.current)==null||f.updateOptions(j)},[j],N),F(()=>{!p.current||n===void 0||(p.current.getOption(M.current.editor.EditorOption.readOnly)?p.current.setValue(n):n!==p.current.getValue()&&(A.current=!0,p.current.executeEdits("",[{range:p.current.getModel().getFullModelRange(),text:n,forceMoveMarkers:!0}]),p.current.pushUndoStop(),A.current=!1))},[n],N),F(()=>{var b,E;let f=(b=p.current)==null?void 0:b.getModel();f&&i&&((E=M.current)==null||E.editor.setModelLanguage(f,i))},[i],N),F(()=>{var f;y!==void 0&&((f=p.current)==null||f.revealLine(y))},[y],N),F(()=>{var f;(f=M.current)==null||f.editor.setTheme(h)},[h],N);let W=d.useCallback(()=>{var f;if(!(!a.current||!M.current)&&!$.current){u.current(M.current);let b=s||r,E=z(M.current,n||e||"",t||i||"",b||"");p.current=(f=M.current)==null?void 0:f.editor.create(a.current,{model:E,automaticLayout:!0,...j},C),v&&p.current.restoreViewState(Y.get(b)),M.current.editor.setTheme(h),y!==void 0&&p.current.revealLine(y),O(!0),$.current=!0}},[e,t,r,n,i,s,j,C,v,h,y]);d.useEffect(()=>{N&&c.current(p.current,M.current)},[N]),d.useEffect(()=>{!x&&!N&&W()},[x,N,W]),l.current=n,d.useEffect(()=>{var f,b;N&&I&&((f=g.current)==null||f.dispose(),g.current=(b=p.current)==null?void 0:b.onDidChangeModelContent(E=>{A.current||I(p.current.getValue(),E)}))},[N,I]),d.useEffect(()=>{if(N){let f=M.current.editor.onDidChangeMarkers(b=>{var _;let E=(_=p.current.getModel())==null?void 0:_.uri;if(E&&b.find(V=>V.path===E.path)){let V=M.current.editor.getModelMarkers({resource:E});k==null||k(V)}});return()=>{f==null||f.dispose()}}return()=>{}},[N,k]);function Oe(){var f,b;(f=g.current)==null||f.dispose(),P?v&&Y.set(s,p.current.saveViewState()):(b=p.current.getModel())==null||b.dispose(),p.current.dispose()}return L.createElement(we,{width:D,height:U,isEditorReady:N,loading:w,_ref:a,className:H,wrapperProps:q})}var Ut=zt,Ht=d.memo(Ut),qt=Ht;const Xt=()=>{const[e,t]=d.useState("/"),[r,n]=d.useState([]),[i,s]=d.useState([]),[h,y]=d.useState(null),[w,j]=d.useState(!1),[C,v]=d.useState(null);d.useEffect(()=>{P(e)},[e]);const P=async a=>{try{j(!0);const c=await fetch(`/api/files/browse?path=${encodeURIComponent(a.slice(1))}`);if(c.ok){const u=await c.json();n(u.items)}else throw new Error("Failed to browse directory")}catch(c){v({type:"error",text:c.message})}finally{j(!1)}},D=async a=>{if(i.find(u=>u.path===a)){y(a);return}try{const u=await fetch(`/api/files/read?path=${encodeURIComponent(a.slice(1))}`);if(u.ok){const g=await u.json(),l={path:a,content:g.content,original:g.content,modified:!1};s([...i,l]),y(a)}else{const g=await u.json();v({type:"error",text:g.detail||"Failed to open file"})}}catch(u){v({type:"error",text:u.message})}},U=async a=>{const c=i.find(u=>u.path===a);if(c)try{const u=await fetch("/api/files/save",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({path:a.slice(1),content:c.content})});if(u.ok)v({type:"success",text:"File saved successfully"}),s(i.map(g=>g.path===a?{...g,original:g.content,modified:!1}:g)),P(e);else{const g=await u.json();throw new Error(g.detail||"Failed to save file")}}catch(u){v({type:"error",text:u.message})}},H=a=>{const c=i.find(g=>g.path===a);if(c!=null&&c.modified&&!confirm(`${c.path} has unsaved changes. Close anyway?`))return;const u=i.filter(g=>g.path!==a);s(u),h===a&&y(u.length>0?u[0].path:null)},q=(a,c)=>{s(i.map(u=>u.path===a?{...u,content:c,modified:c!==u.original}:u))},B=async a=>{if(confirm(`Delete ${a}? This cannot be undone.`))try{const c=await fetch(`/api/files/delete?path=${encodeURIComponent(a.slice(1))}`,{method:"DELETE"});if(c.ok)v({type:"success",text:"Deleted successfully"}),s(i.filter(u=>u.path!==a)),P(e);else{const u=await c.json();throw new Error(u.detail||"Failed to delete")}}catch(c){v({type:"error",text:c.message})}},S=async()=>{const a=prompt("Enter file name (e.g., mypool_driver.py):");if(!a)return;const c=`${e}${e.endsWith("/")?"":"/"}${a}`;try{const u=await fetch("/api/files/create",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({path:c.slice(1),content:""})});if(u.ok)v({type:"success",text:"File created successfully"}),P(e),D(c);else{const g=await u.json();throw new Error(g.detail||"Failed to create file")}}catch(u){v({type:"error",text:u.message})}},I=async a=>{const c=a.split("/").pop(),u=prompt(`Copy ${c} as:`,`${c}.copy`);if(!u)return;const l=`${a.substring(0,a.lastIndexOf("/"))}/${u}`;try{const m=await fetch("/api/files/copy",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({path:a.slice(1),new_path:l.slice(1)})});if(m.ok)v({type:"success",text:"File copied successfully"}),P(e);else{const $=await m.json();throw new Error($.detail||"Failed to copy file")}}catch(m){v({type:"error",text:m.message})}},k=a=>{const c=`/api/files/download?path=${encodeURIComponent(a.slice(1))}`;window.open(c,"_blank")},N=a=>{if(a.type==="directory")return o.jsx(le,{className:"w-5 h-5 text-blue-400"});switch(a.extension){case".py":return o.jsx(se,{className:"w-5 h-5 text-green-400"});case".yaml":case".yml":return o.jsx(Ce,{className:"w-5 h-5 text-purple-400"});case".json":return o.jsx(se,{className:"w-5 h-5 text-yellow-400"});case".md":return o.jsx(ce,{className:"w-5 h-5 text-gray-400"});default:return o.jsx(Ie,{className:"w-5 h-5 text-gray-400"})}},O=a=>{var g;const c=(g=a.split(".").pop())==null?void 0:g.toLowerCase();return{py:"python",js:"javascript",ts:"typescript",json:"json",yaml:"yaml",yml:"yaml",md:"markdown",sh:"shell",txt:"plaintext",log:"plaintext"}[c||""]||"plaintext"},x=a=>a.endsWith(".example"),T=a=>a<1024?`${a} B`:a<1024*1024?`${(a/1024).toFixed(1)} KB`:`${(a/(1024*1024)).toFixed(1)} MB`,M=e.split("/").filter(Boolean),p=i.find(a=>a.path===h);return o.jsxs("div",{className:"flex flex-col h-screen bg-gray-950",children:[o.jsxs("div",{className:"p-4 border-b border-gray-800",children:[o.jsx("h1",{className:"text-2xl font-bold text-gray-100",children:"File Manager"}),o.jsx("p",{className:"text-sm text-gray-400 mt-1",children:"Browse and edit configuration files"})]}),C&&o.jsx("div",{className:`mx-4 mt-4 p-3 rounded-md ${C.type==="success"?"bg-green-900/40 border border-green-700":"bg-red-900/40 border border-red-700"}`,children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsx("p",{className:`text-sm ${C.type==="success"?"text-green-200":"text-red-200"}`,children:C.text}),o.jsx("button",{onClick:()=>v(null),className:"text-gray-400 hover:text-gray-300",children:o.jsx(oe,{className:"w-4 h-4"})})]})}),o.jsxs("div",{className:"flex flex-1 overflow-hidden",children:[o.jsxs("div",{className:"w-80 border-r border-gray-800 flex flex-col bg-gray-900/40",children:[o.jsxs("div",{className:"p-3 border-b border-gray-800 flex items-center space-x-2 text-sm",children:[o.jsx("button",{onClick:()=>t("/"),className:"text-blue-400 hover:text-blue-300",children:"/config"}),M.map((a,c)=>o.jsxs(L.Fragment,{children:[o.jsx(Ee,{className:"w-4 h-4 text-gray-600"}),o.jsx("button",{onClick:()=>t("/"+M.slice(0,c+1).join("/")),className:"text-blue-400 hover:text-blue-300",children:a})]},c))]}),o.jsxs("div",{className:"p-2 border-b border-gray-800 flex items-center space-x-2",children:[o.jsx("button",{onClick:S,className:"p-2 rounded hover:bg-gray-800 text-gray-300 hover:text-gray-100",title:"New File",children:o.jsx(Me,{className:"w-4 h-4"})}),o.jsx("button",{onClick:()=>P(e),className:"p-2 rounded hover:bg-gray-800 text-gray-300 hover:text-gray-100",title:"Refresh",children:o.jsx(ie,{className:`w-4 h-4 ${w?"animate-spin":""}`})})]}),o.jsx("div",{className:"flex-1 overflow-y-auto",children:w&&r.length===0?o.jsxs("div",{className:"p-4 text-center text-gray-500",children:[o.jsx(ie,{className:"w-6 h-6 mx-auto animate-spin mb-2"}),"Loading..."]}):r.length===0?o.jsxs("div",{className:"p-4 text-center text-gray-500",children:[o.jsx(Se,{className:"w-12 h-12 mx-auto mb-2 opacity-50"}),o.jsx("p",{children:"Empty directory"})]}):o.jsxs("div",{className:"divide-y divide-gray-800",children:[e!=="/"&&o.jsxs("div",{onClick:()=>{const a=e.substring(0,e.lastIndexOf("/"))||"/";t(a)},className:"px-3 py-2 hover:bg-gray-800 cursor-pointer flex items-center space-x-3",children:[o.jsx(le,{className:"w-5 h-5 text-gray-500"}),o.jsx("span",{className:"text-gray-400",children:".."})]}),r.map(a=>o.jsxs("div",{className:"px-3 py-2 hover:bg-gray-800 cursor-pointer flex items-center justify-between group",children:[o.jsxs("div",{onClick:()=>{a.type==="directory"?t(a.path):D(a.path)},className:"flex items-center space-x-3 flex-1",children:[N(a),o.jsxs("div",{className:"flex-1 min-w-0",children:[o.jsx("p",{className:"text-sm text-gray-200 truncate",children:a.name}),o.jsx("p",{className:"text-xs text-gray-500",children:a.type==="file"?T(a.size):"Folder"})]})]}),a.type==="file"&&o.jsxs("div",{className:"flex items-center space-x-1 opacity-0 group-hover:opacity-100",children:[o.jsx("button",{onClick:c=>{c.stopPropagation(),I(a.path)},className:"p-1 rounded hover:bg-gray-700 text-gray-400 hover:text-gray-200",title:"Copy",children:o.jsx(Fe,{className:"w-3.5 h-3.5"})}),o.jsx("button",{onClick:c=>{c.stopPropagation(),k(a.path)},className:"p-1 rounded hover:bg-gray-700 text-gray-400 hover:text-gray-200",title:"Download",children:o.jsx(Pe,{className:"w-3.5 h-3.5"})}),o.jsx("button",{onClick:c=>{c.stopPropagation(),B(a.path)},className:"p-1 rounded hover:bg-gray-700 text-red-400 hover:text-red-300",title:"Delete",children:o.jsx($e,{className:"w-3.5 h-3.5"})})]})]},a.path))]})})]}),o.jsx("div",{className:"flex-1 flex flex-col",children:i.length===0?o.jsx("div",{className:"flex-1 flex items-center justify-center text-gray-500",children:o.jsxs("div",{className:"text-center",children:[o.jsx(ce,{className:"w-16 h-16 mx-auto mb-4 opacity-50"}),o.jsx("p",{className:"text-lg",children:"No files open"}),o.jsx("p",{className:"text-sm mt-2",children:"Select a file from the sidebar to start editing"})]})}):o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"flex items-center border-b border-gray-800 bg-gray-900/40 overflow-x-auto",children:i.map(a=>o.jsxs("div",{onClick:()=>y(a.path),className:`flex items-center space-x-2 px-4 py-2 border-r border-gray-800 cursor-pointer ${h===a.path?"bg-gray-900 text-gray-100":"text-gray-400 hover:text-gray-200 hover:bg-gray-800/50"}`,children:[o.jsxs("span",{className:"text-sm truncate max-w-xs",children:[a.path.split("/").pop(),a.modified&&" â€¢"]}),o.jsx("button",{onClick:c=>{c.stopPropagation(),H(a.path)},className:"hover:bg-gray-700 rounded p-0.5",children:o.jsx(oe,{className:"w-3.5 h-3.5"})})]},a.path))}),p&&o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"p-2 border-b border-gray-800 flex items-center justify-between bg-gray-900/40",children:[o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsx("span",{className:"text-sm text-gray-400",children:p.path}),x(p.path)&&o.jsxs("span",{className:"inline-flex items-center px-2 py-0.5 rounded text-xs bg-yellow-900/40 text-yellow-400 border border-yellow-700",children:[o.jsx(ke,{className:"w-3 h-3 mr-1"}),"Read-only"]})]}),o.jsxs("button",{onClick:()=>U(p.path),disabled:!p.modified||x(p.path),className:`inline-flex items-center px-3 py-1 rounded text-sm ${p.modified&&!x(p.path)?"bg-blue-600 text-white hover:bg-blue-700":"bg-gray-800 text-gray-500 cursor-not-allowed"}`,title:x(p.path)?"File is read-only (view only)":"",children:[o.jsx(Re,{className:"w-4 h-4 mr-1"}),"Save"]})]}),o.jsx("div",{className:"flex-1",children:o.jsx(qt,{height:"100%",language:O(p.path),value:p.content,onChange:a=>q(p.path,a||""),theme:"vs-dark",options:{minimap:{enabled:!0},fontSize:14,lineNumbers:"on",rulers:[80,120],wordWrap:"off",automaticLayout:!0,readOnly:x(p.path)}})})]})]})})]})]})};export{Xt as default};
