import{a as S,j as s,am as o,an as y}from"./index-BD9hvQWc-1771716385543.js";function w(e){if(e==null)return"N/A";const m=Math.max(0,Math.floor(e)),a=Math.floor(m/60),n=Math.floor(a/60),i=a%60;return n>0?`${n}h ${i}m`:`${a}m`}function $(){var g,x,h,p,v,f,N,b;const{data:e,isLoading:m,isError:a,error:n}=S({queryKey:["stratum","BCH"],queryFn:()=>y.getStatus("BCH"),refetchInterval:1e4,refetchOnWindowFocus:!1,staleTime:8e3});if(m)return s.jsx("div",{className:"w-full py-10 text-center text-sm text-muted-foreground",children:"Loading BCH Stratum…"});if(a||!e){const t=n instanceof Error?n.message:"Unknown error";return s.jsxs("div",{className:"rounded-lg border border-red-700 bg-red-900/30 p-4 text-red-200",children:["Failed to load BCH Stratum: ",t]})}const i=((g=e.ready)==null?void 0:g.ready)===!0,_=e.computed.workers_online,d=e.computed.hashrate,l=e.computed.shares_15m,c=e.computed.shares_24h,u=e.computed.shares_total,r=e.computed.last_block_event;return s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{children:[s.jsx("h1",{className:"text-2xl font-semibold",children:"BCH Stratum"}),s.jsxs("div",{className:"text-sm text-muted-foreground",children:[e.pool.stratum.host,":",e.pool.stratum.port," • Manager: ",e.pool.manager.base_url]})]}),s.jsxs("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-4",children:[s.jsx(o,{label:"Status",value:i?"Ready":"Not Ready",subtext:(x=e.ready)!=null&&x.reasons&&e.ready.reasons.length>0?e.ready.reasons.join(" • "):void 0}),s.jsx(o,{label:"Workers",value:_??"N/A",subtext:e.computed.workers_down_for_s&&Number(e.computed.workers_down_for_s)>0?`Down for ${w(Number(e.computed.workers_down_for_s))}`:e.computed.workers_min_15m!==null&&e.computed.workers_min_15m!==void 0?`15m min/max: ${e.computed.workers_min_15m}/${e.computed.workers_max_15m??e.computed.workers_min_15m}`:void 0}),s.jsx(o,{label:"Hashrate",value:d&&typeof d=="object"&&"display"in d?String(d.display):"N/A"}),s.jsx(o,{label:"Shares",value:l!=null?`${Number(l).toLocaleString()} (15m)`:"N/A",subtext:c!=null?`24h: ${Number(c).toLocaleString()} • Total: ${Number(u||0).toLocaleString()}`:`Total: ${Number(u||0).toLocaleString()}`})]}),s.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[s.jsx(o,{label:"Last Block Event",value:r!=null&&r.timestamp?new Date(String(r.timestamp)).toLocaleString():"None",subtext:r!=null&&r.message?String(r.message):void 0}),s.jsx(o,{label:"Node Cache",value:((p=(h=e.node)==null?void 0:h.mining)==null?void 0:p.age_seconds)!==null&&((f=(v=e.node)==null?void 0:v.mining)==null?void 0:f.age_seconds)!==void 0?`${Number(e.node.mining.age_seconds).toFixed(1)}s old`:"N/A",subtext:(b=(N=e.node)==null?void 0:N.mining)!=null&&b.error?String(e.node.mining.error):void 0})]}),s.jsxs("div",{className:"rounded-lg border border-border bg-card p-4",children:[s.jsx("div",{className:"text-sm font-medium",children:"Recent Events"}),s.jsx("div",{className:"mt-2 space-y-1 text-xs",children:e.ckpool.events.length===0?s.jsx("div",{className:"text-muted-foreground",children:"No recent events"}):e.ckpool.events.slice(0,30).map((t,j)=>s.jsxs("div",{className:"flex flex-wrap gap-x-2 gap-y-0.5",children:[s.jsx("span",{className:"text-muted-foreground",children:t.timestamp?new Date(String(t.timestamp)).toLocaleTimeString():""}),s.jsx("span",{className:"font-semibold",children:String(t.event_type||"")}),s.jsx("span",{className:"text-muted-foreground",children:String(t.severity||"")}),s.jsx("span",{children:String(t.message||"")})]},j))})]})]})}export{$ as default};
