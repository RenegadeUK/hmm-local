import{c as L,b as U,a as q,j as e,o as E,W,C as d,d as x,e as m,f as l,an as G,$ as I,ao as K,r as V,a1 as O}from"./index-DH1tuhK--1771363747916.js";import{A as X}from"./alert-triangle-ClaxKYpI-1771363747916.js";import{C as Y}from"./check-circle-2-B35NMLt6-1771363747916.js";/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const z=L("Share2",[["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}],["circle",{cx:"6",cy:"12",r:"3",key:"w7nqdw"}],["circle",{cx:"18",cy:"19",r:"3",key:"1xt0gg"}],["line",{x1:"8.59",x2:"15.42",y1:"13.51",y2:"17.49",key:"47mynk"}],["line",{x1:"15.41",x2:"8.59",y1:"6.51",y2:"10.49",key:"1n3mei"}]]),Q=new Set(["BTC","BCH","DGB"]);function A(s){return typeof s!="number"||!Number.isFinite(s)||s<=0?"N/A":s>=1e18?`${(s/1e18).toFixed(2)} EH/s`:s>=1e15?`${(s/1e15).toFixed(2)} PH/s`:s>=1e12?`${(s/1e12).toFixed(2)} TH/s`:s>=1e9?`${(s/1e9).toFixed(2)} GH/s`:s>=1e6?`${(s/1e6).toFixed(2)} MH/s`:s>=1e3?`${(s/1e3).toFixed(2)} KH/s`:`${s.toFixed(2)} H/s`}function T(s){return typeof s!="number"||!Number.isFinite(s)?"N/A":`${s.toFixed(2)}%`}function h(s){return typeof s!="number"||!Number.isFinite(s)?"N/A":s.toLocaleString()}function J(s){if(typeof s!="number"||!Number.isFinite(s))return"N/A";const a=Math.abs(s);return a>=1e12?`${(s/1e12).toFixed(2)}T`:a>=1e9?`${(s/1e9).toFixed(2)}B`:a>=1e6?`${(s/1e6).toFixed(2)}M`:a>=1e3?`${(s/1e3).toFixed(2)}K`:s.toFixed(2)}function Z(s){return typeof s!="number"||!Number.isFinite(s)?"N/A":Math.abs(s)>=1e3?`${(s/1e3).toFixed(2)}K`:s.toFixed(2)}function ee(s){if(typeof s!="number"||!Number.isFinite(s)||s<=0)return"N/A";const a=Math.floor(s),n=Math.floor(a/3600),t=Math.floor(a%3600/60),i=a%60;return n>0?`${n}h ${t}m ${i}s`:t>0?`${t}m ${i}s`:`${i}s`}function B(s){if(!s)return"Unknown";const a=new Date(s).getTime();if(Number.isNaN(a))return s;const n=Math.max(0,Math.floor((Date.now()-a)/1e3));if(n<60)return`${n}s ago`;const t=Math.floor(n/60);if(t<60)return`${t}m ago`;const i=Math.floor(t/60);return i<24?`${i}h ago`:`${Math.floor(i/24)}d ago`}function se(s){var i;if(!s)return s;const a=s.trim();if(!a.includes("."))return a;const n=a.split(".");return((i=n[n.length-1])==null?void 0:i.trim())||a}function $({points:s,colorClass:a}){const n=V.useMemo(()=>{const t=s.slice(-60);if(t.length<2)return"";const i=260,u=70,o=8,p=8,j=Math.min(...t.map(c=>c.x)),b=Math.max(...t.map(c=>c.x)),f=Math.min(...t.map(c=>c.y)),N=Math.max(...t.map(c=>c.y)),g=Math.max(b-j,1),_=Math.max(N-f,1);return t.map(c=>{const y=o+(c.x-j)/g*(i-o*2),F=u-p-(c.y-f)/_*(u-p*2);return`${y},${F}`}).join(" ")},[s]);return n?e.jsx("svg",{viewBox:"0 0 260 70",className:"h-[70px] w-full",children:e.jsx("polyline",{fill:"none",strokeWidth:"2",className:a,points:n})}):e.jsx("div",{className:"h-[70px] text-xs text-slate-500 flex items-center",children:"Not enough points"})}function ne(){var b,f,N,g,_,c,y,F,v;const a=(U().coin||"").toUpperCase(),n=!Q.has(a),{data:t,isLoading:i,isError:u,error:o}=q({queryKey:["stratum-dashboard",a],queryFn:()=>O.getHmmLocalStratumCoinDashboard(a),enabled:!n,refetchInterval:3e4,refetchOnWindowFocus:!1,staleTime:25e3});if(n)return e.jsx("div",{className:"rounded-lg border border-amber-700/60 bg-amber-900/30 p-4 text-amber-200",children:"Unsupported coin route. Use BTC, BCH or DGB."});if(i)return e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx(E,{className:"h-8 w-8 animate-spin text-blue-500"})});if(u||!t)return e.jsxs("div",{className:"rounded-lg border border-red-700 bg-red-900/30 p-4 text-red-200",children:["Failed to load Stratum dashboard data: ",(o==null?void 0:o.message)||"Unknown error"]});const p=((b=t.quality)==null?void 0:b.readiness)||"unknown",j=!!((f=t.quality)!=null&&f.stale);return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsxs("div",{className:"flex items-center gap-3 text-3xl font-semibold text-foreground",children:[e.jsx(W,{className:"h-8 w-8 text-blue-400"}),e.jsxs("span",{children:["HMM-Local Stratum · ",a]})]}),e.jsxs("p",{className:"text-base text-muted-foreground",children:["Pool and miner telemetry for ",a," from local Stratum datastore."]})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-2 xl:grid-cols-4",children:[e.jsxs(d,{children:[e.jsx(x,{className:"pb-2",children:e.jsx(m,{className:"text-sm text-muted-foreground",children:"Readiness"})}),e.jsxs(l,{children:[e.jsx("div",{className:"text-2xl font-semibold capitalize",children:p}),e.jsx("div",{className:"mt-1 text-xs text-muted-foreground",children:j?"Data stale":"Data fresh"})]})]}),e.jsxs(d,{children:[e.jsx(x,{className:"pb-2",children:e.jsx(m,{className:"text-sm text-muted-foreground",children:"Pool hashrate"})}),e.jsxs(l,{children:[e.jsx("div",{className:"text-2xl font-semibold",children:A((N=t.hashrate)==null?void 0:N.pool_hashrate_hs)}),e.jsxs("div",{className:"mt-1 text-xs text-muted-foreground",children:["Workers: ",t.workers.count]})]})]}),e.jsxs(d,{children:[e.jsx(x,{className:"pb-2",children:e.jsx(m,{className:"text-sm text-muted-foreground",children:"Share reject rate"})}),e.jsxs(l,{children:[e.jsx("div",{className:"text-2xl font-semibold",children:T(((g=t.kpi)==null?void 0:g.share_reject_rate_pct)??null)}),e.jsxs("div",{className:"mt-1 text-xs text-muted-foreground",children:["Accepted ",h(((_=t.kpi)==null?void 0:_.share_accept_count)??null)," · Rejected ",h(((c=t.kpi)==null?void 0:c.share_reject_count)??null)]})]})]}),e.jsxs(d,{children:[e.jsx(x,{className:"pb-2",children:e.jsx(m,{className:"text-sm text-muted-foreground",children:"Blocks (24h)"})}),e.jsxs(l,{children:[e.jsx("div",{className:"text-2xl font-semibold",children:h(((y=t.kpi)==null?void 0:y.block_accept_count_24h)??null)}),e.jsxs("div",{className:"mt-1 text-xs text-muted-foreground",children:["Rejected ",h(((F=t.kpi)==null?void 0:F.block_reject_count_24h)??null)," · ETA ",ee(((v=t.kpi)==null?void 0:v.expected_time_to_block_sec)??null)]})]})]})]}),e.jsxs(d,{children:[e.jsx(x,{children:e.jsxs(m,{className:"flex items-center gap-2 text-base",children:[e.jsx(G,{className:"h-4 w-4"})," Pool hashrate trend"]})}),e.jsx(l,{children:e.jsx($,{points:t.charts.pool_hashrate_hs||[],colorClass:"stroke-blue-400"})})]}),e.jsx("div",{className:"space-y-4",children:t.workers.rows.length===0?e.jsx(d,{children:e.jsx(l,{className:"py-6 text-sm text-muted-foreground",children:"No worker rows available yet for this coin."})}):t.workers.rows.map(r=>e.jsx(d,{children:(()=>{var S;const k=typeof r.current_hashrate_hs=="number"&&Number.isFinite(r.current_hashrate_hs)&&r.current_hashrate_hs>0,D=typeof r.accepted=="number"&&typeof r.rejected=="number"&&Number.isFinite(r.accepted)&&Number.isFinite(r.rejected)&&r.accepted+r.rejected>0,M=typeof r.reject_rate_pct=="number"&&Number.isFinite(r.reject_rate_pct),P=typeof r.highest_diff=="number"&&Number.isFinite(r.highest_diff),w=!!r.last_share_at,H=(r.hashrate_chart||[]).length>=2,C=(r.vardiff_chart||[]).length>=2,R=C?(S=r.vardiff_chart[r.vardiff_chart.length-1])==null?void 0:S.y:null;return e.jsxs(e.Fragment,{children:[e.jsx(x,{className:"pb-3",children:e.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-2",children:[e.jsx(m,{className:"text-base",children:se(r.worker)}),e.jsx("div",{className:"flex items-center gap-2 text-xs",children:M&&r.reject_rate_pct!==null&&r.reject_rate_pct>=5?e.jsxs("span",{className:"inline-flex items-center gap-1 rounded-full border border-red-700/60 bg-red-900/30 px-2 py-1 text-red-300",children:[e.jsx(X,{className:"h-3 w-3"})," High reject risk"]}):e.jsxs("span",{className:"inline-flex items-center gap-1 rounded-full border border-emerald-700/50 bg-emerald-900/30 px-2 py-1 text-emerald-300",children:[e.jsx(Y,{className:"h-3 w-3"})," Active"]})})]})}),e.jsxs(l,{className:"space-y-4",children:[e.jsxs("div",{className:"grid gap-3 md:grid-cols-2 xl:grid-cols-5",children:[k&&e.jsxs("div",{className:"rounded-lg border border-slate-700/50 bg-slate-900/30 p-3",children:[e.jsx("div",{className:"text-xs uppercase tracking-wide text-slate-400",children:"Current hashrate"}),e.jsx("div",{className:"mt-1 text-sm text-slate-100",children:A(r.current_hashrate_hs)})]}),D&&e.jsxs("div",{className:"rounded-lg border border-slate-700/50 bg-slate-900/30 p-3",children:[e.jsx("div",{className:"text-xs uppercase tracking-wide text-slate-400",children:"Shares"}),e.jsxs("div",{className:"mt-1 text-sm text-slate-100",children:[h(r.accepted)," accepted"]}),e.jsxs("div",{className:"text-xs text-slate-400",children:[h(r.rejected)," rejected"]})]}),M&&e.jsxs("div",{className:"rounded-lg border border-slate-700/50 bg-slate-900/30 p-3",children:[e.jsx("div",{className:"text-xs uppercase tracking-wide text-slate-400",children:"Reject rate"}),e.jsx("div",{className:"mt-1 text-sm text-slate-100",children:T(r.reject_rate_pct)})]}),P&&e.jsxs("div",{className:"rounded-lg border border-slate-700/50 bg-slate-900/30 p-3",children:[e.jsx("div",{className:"text-xs uppercase tracking-wide text-slate-400",children:"Highest diff"}),e.jsx("div",{className:"mt-1 text-sm text-slate-100",children:J(r.highest_diff)})]}),w&&e.jsxs("div",{className:"rounded-lg border border-slate-700/50 bg-slate-900/30 p-3",children:[e.jsx("div",{className:"text-xs uppercase tracking-wide text-slate-400",children:"Last share"}),e.jsx("div",{className:"mt-1 text-sm text-slate-100",children:B(r.last_share_at)})]})]}),(H||C)&&e.jsxs("div",{className:"grid gap-4 xl:grid-cols-2",children:[H&&e.jsxs("div",{className:"rounded-lg border border-slate-700/50 bg-slate-900/30 p-3",children:[e.jsxs("div",{className:"mb-2 flex items-center gap-2 text-xs uppercase tracking-wide text-slate-400",children:[e.jsx(I,{className:"h-3.5 w-3.5"})," Hashrate trend"]}),e.jsx($,{points:r.hashrate_chart||[],colorClass:"stroke-cyan-400"})]}),C&&e.jsxs("div",{className:"rounded-lg border border-slate-700/50 bg-slate-900/30 p-3",children:[e.jsxs("div",{className:"mb-2 flex items-center justify-between gap-2 text-xs uppercase tracking-wide text-slate-400",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(z,{className:"h-3.5 w-3.5"})," Vardiff trend"]}),e.jsxs("div",{className:"text-[11px] normal-case text-slate-300",children:["Current: ",Z(R)]})]}),e.jsx($,{points:r.vardiff_chart||[],colorClass:"stroke-purple-400"})]})]})]})]})})()},r.worker))}),e.jsx("div",{className:"rounded-lg border border-slate-700/50 bg-slate-900/20 p-3 text-xs text-slate-400",children:e.jsxs("div",{className:"flex flex-wrap items-center gap-4",children:[e.jsxs("span",{className:"inline-flex items-center gap-1",children:[e.jsx(K,{className:"h-3.5 w-3.5"})," Pool: ",t.pool.name]}),e.jsxs("span",{children:["Source: ",t.api_base]}),e.jsxs("span",{children:["Updated: ",B(t.fetched_at)]})]})})]})}export{ne as default};
