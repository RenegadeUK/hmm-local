import{c as ee,r as d,aj as D,j as o,X as oe,U as Se,R as ie,ak as Me,S as Ce}from"./index-CjS44ej6-1771273896267.js";import{C as Ee}from"./chevron-right-Dw4iLPNH-1771273896267.js";import{P as Fe}from"./pen-square-D2fZD6Xb-1771273896267.js";import{C as Pe}from"./copy-BKkhgccw-1771273896267.js";import{D as $e}from"./download-Bu-ycIk_-1771273896267.js";import{T as ke}from"./trash-2-BBtjGN8S-1771273896267.js";import{E as Re}from"./eye-DxsPppao-1771273896267.js";import{S as Ie}from"./save-CICt5vMO-1771273896267.js";/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const se=ee("FileCode",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["path",{d:"m10 13-2 2 2 2",key:"17smn8"}],["path",{d:"m14 17 2-2-2-2",key:"14mezr"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ce=ee("FileText",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["line",{x1:"16",x2:"8",y1:"13",y2:"13",key:"14keom"}],["line",{x1:"16",x2:"8",y1:"17",y2:"17",key:"17nazh"}],["line",{x1:"10",x2:"8",y1:"9",y2:"9",key:"1a5vjj"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Te=ee("File",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const le=ee("Folder",[["path",{d:"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z",key:"1kt360"}]]);function ue(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function Le(e){if(Array.isArray(e))return e}function De(e,t,r){return(t=Be(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Ae(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,l,f,g=[],v=!0,w=!1;try{if(l=(r=r.call(e)).next,t!==0)for(;!(v=(n=l.call(r)).done)&&(g.push(n.value),g.length!==t);v=!0);}catch(F){w=!0,i=F}finally{try{if(!v&&r.return!=null&&(f=r.return(),Object(f)!==f))return}finally{if(w)throw i}}return g}}function Ve(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function de(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function pe(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?de(Object(r),!0).forEach(function(n){De(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):de(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function ze(e,t){if(e==null)return{};var r,n,i=Ue(e,t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(n=0;n<l.length;n++)r=l[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function Ue(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function He(e,t){return Le(e)||Ae(e,t)||We(e,t)||Ve()}function qe(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Be(e){var t=qe(e,"string");return typeof t=="symbol"?t:t+""}function We(e,t){if(e){if(typeof e=="string")return ue(e,t);var r={}.toString.call(e).slice(8,-1);return r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set"?Array.from(e):r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?ue(e,t):void 0}}function _e(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function fe(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function he(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?fe(Object(r),!0).forEach(function(n){_e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):fe(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Je(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return function(n){return t.reduceRight(function(i,l){return l(i)},n)}}function J(e){return function t(){for(var r=this,n=arguments.length,i=new Array(n),l=0;l<n;l++)i[l]=arguments[l];return i.length>=e.length?e.apply(this,i):function(){for(var f=arguments.length,g=new Array(f),v=0;v<f;v++)g[v]=arguments[v];return t.apply(r,[].concat(i,g))}}}function Q(e){return{}.toString.call(e).includes("Object")}function Ke(e){return!Object.keys(e).length}function G(e){return typeof e=="function"}function Ge(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function Xe(e,t){return Q(t)||T("changeType"),Object.keys(t).some(function(r){return!Ge(e,r)})&&T("changeField"),t}function Ye(e){G(e)||T("selectorType")}function Ze(e){G(e)||Q(e)||T("handlerType"),Q(e)&&Object.values(e).some(function(t){return!G(t)})&&T("handlersType")}function Qe(e){e||T("initialIsRequired"),Q(e)||T("initialType"),Ke(e)&&T("initialContent")}function et(e,t){throw new Error(e[t]||e.default)}var tt={initialIsRequired:"initial state is required",initialType:"initial state should be an object",initialContent:"initial state shouldn't be an empty object",handlerType:"handler should be an object or a function",handlersType:"all handlers should be a functions",selectorType:"selector should be a function",changeType:"provided value of changes should be an object",changeField:'it seams you want to change a field in the state which is not specified in the "initial" state',default:"an unknown error accured in `state-local` package"},T=J(et)(tt),Y={changes:Xe,selector:Ye,handler:Ze,initial:Qe};function rt(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};Y.initial(e),Y.handler(t);var r={current:e},n=J(ot)(r,t),i=J(at)(r),l=J(Y.changes)(e),f=J(nt)(r);function g(){var w=arguments.length>0&&arguments[0]!==void 0?arguments[0]:function(F){return F};return Y.selector(w),w(r.current)}function v(w){Je(n,i,l,f)(w)}return[g,v]}function nt(e,t){return G(t)?t(e.current):t}function at(e,t){return e.current=he(he({},e.current),t),t}function ot(e,t,r){return G(t)?t(e.current):Object.keys(r).forEach(function(n){var i;return(i=t[n])===null||i===void 0?void 0:i.call(t,e.current[n])}),r}var it={create:rt},st={paths:{vs:"https://cdn.jsdelivr.net/npm/monaco-editor@0.55.1/min/vs"}};function ct(e){return function t(){for(var r=this,n=arguments.length,i=new Array(n),l=0;l<n;l++)i[l]=arguments[l];return i.length>=e.length?e.apply(this,i):function(){for(var f=arguments.length,g=new Array(f),v=0;v<f;v++)g[v]=arguments[v];return t.apply(r,[].concat(i,g))}}}function lt(e){return{}.toString.call(e).includes("Object")}function ut(e){return e||me("configIsRequired"),lt(e)||me("configType"),e.urls?(dt(),{paths:{vs:e.urls.monacoBase}}):e}function dt(){console.warn(ge.deprecation)}function pt(e,t){throw new Error(e[t]||e.default)}var ge={configIsRequired:"the configuration object is required",configType:"the configuration object should be an object",default:"an unknown error accured in `@monaco-editor/loader` package",deprecation:`Deprecation warning!
    You are using deprecated way of configuration.

    Instead of using
      monaco.config({ urls: { monacoBase: '...' } })
    use
      monaco.config({ paths: { vs: '...' } })

    For more please check the link https://github.com/suren-atoyan/monaco-loader#config
  `},me=ct(pt)(ge),ft={config:ut},ht=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return function(i){return r.reduceRight(function(l,f){return f(l)},i)}};function ye(e,t){return Object.keys(t).forEach(function(r){t[r]instanceof Object&&e[r]&&Object.assign(t[r],ye(e[r],t[r]))}),pe(pe({},e),t)}var mt={type:"cancelation",msg:"operation is manually canceled"};function re(e){var t=!1,r=new Promise(function(n,i){e.then(function(l){return t?i(mt):n(l)}),e.catch(i)});return r.cancel=function(){return t=!0},r}var gt=["monaco"],yt=it.create({config:st,isInitialized:!1,resolve:null,reject:null,monaco:null}),xe=He(yt,2),X=xe[0],te=xe[1];function xt(e){var t=ft.config(e),r=t.monaco,n=ze(t,gt);te(function(i){return{config:ye(i.config,n),monaco:r}})}function vt(){var e=X(function(t){var r=t.monaco,n=t.isInitialized,i=t.resolve;return{monaco:r,isInitialized:n,resolve:i}});if(!e.isInitialized){if(te({isInitialized:!0}),e.monaco)return e.resolve(e.monaco),re(ne);if(window.monaco&&window.monaco.editor)return ve(window.monaco),e.resolve(window.monaco),re(ne);ht(bt,jt)(Nt)}return re(ne)}function bt(e){return document.body.appendChild(e)}function wt(e){var t=document.createElement("script");return e&&(t.src=e),t}function jt(e){var t=X(function(n){var i=n.config,l=n.reject;return{config:i,reject:l}}),r=wt("".concat(t.config.paths.vs,"/loader.js"));return r.onload=function(){return e()},r.onerror=t.reject,r}function Nt(){var e=X(function(r){var n=r.config,i=r.resolve,l=r.reject;return{config:n,resolve:i,reject:l}}),t=window.require;t.config(e.config),t(["vs/editor/editor.main"],function(r){var n=r.m||r;ve(n),e.resolve(n)},function(r){e.reject(r)})}function ve(e){X().monaco||te({monaco:e})}function Ot(){return X(function(e){var t=e.monaco;return t})}var ne=new Promise(function(e,t){return te({resolve:e,reject:t})}),be={config:xt,init:vt,__getMonacoInstance:Ot},St={wrapper:{display:"flex",position:"relative",textAlign:"initial"},fullWidth:{width:"100%"},hide:{display:"none"}},ae=St,Mt={container:{display:"flex",height:"100%",width:"100%",justifyContent:"center",alignItems:"center"}},Ct=Mt;function Et({children:e}){return D.createElement("div",{style:Ct.container},e)}var Ft=Et,Pt=Ft;function $t({width:e,height:t,isEditorReady:r,loading:n,_ref:i,className:l,wrapperProps:f}){return D.createElement("section",{style:{...ae.wrapper,width:e,height:t},...f},!r&&D.createElement(Pt,null,n),D.createElement("div",{ref:i,style:{...ae.fullWidth,...!r&&ae.hide},className:l}))}var kt=$t,we=d.memo(kt);function Rt(e){d.useEffect(e,[])}var je=Rt;function It(e,t,r=!0){let n=d.useRef(!0);d.useEffect(n.current||!r?()=>{n.current=!1}:e,t)}var $=It;function K(){}function z(e,t,r,n){return Tt(e,n)||Lt(e,t,r,n)}function Tt(e,t){return e.editor.getModel(Ne(e,t))}function Lt(e,t,r,n){return e.editor.createModel(t,r,n?Ne(e,n):void 0)}function Ne(e,t){return e.Uri.parse(t)}function Dt({original:e,modified:t,language:r,originalLanguage:n,modifiedLanguage:i,originalModelPath:l,modifiedModelPath:f,keepCurrentOriginalModel:g=!1,keepCurrentModifiedModel:v=!1,theme:w="light",loading:F="Loading...",options:y={},height:k="100%",width:A="100%",className:U,wrapperProps:H={},beforeMount:q=K,onMount:B=K}){let[C,L]=d.useState(!1),[I,N]=d.useState(!0),O=d.useRef(null),b=d.useRef(null),R=d.useRef(null),M=d.useRef(B),h=d.useRef(q),j=d.useRef(!1);je(()=>{let s=be.init();return s.then(p=>(b.current=p)&&N(!1)).catch(p=>(p==null?void 0:p.type)!=="cancelation"&&console.error("Monaco initialization: error:",p)),()=>O.current?u():s.cancel()}),$(()=>{if(O.current&&b.current){let s=O.current.getOriginalEditor(),p=z(b.current,e||"",n||r||"text",l||"");p!==s.getModel()&&s.setModel(p)}},[l],C),$(()=>{if(O.current&&b.current){let s=O.current.getModifiedEditor(),p=z(b.current,t||"",i||r||"text",f||"");p!==s.getModel()&&s.setModel(p)}},[f],C),$(()=>{let s=O.current.getModifiedEditor();s.getOption(b.current.editor.EditorOption.readOnly)?s.setValue(t||""):t!==s.getValue()&&(s.executeEdits("",[{range:s.getModel().getFullModelRange(),text:t||"",forceMoveMarkers:!0}]),s.pushUndoStop())},[t],C),$(()=>{var s,p;(p=(s=O.current)==null?void 0:s.getModel())==null||p.original.setValue(e||"")},[e],C),$(()=>{let{original:s,modified:p}=O.current.getModel();b.current.editor.setModelLanguage(s,n||r||"text"),b.current.editor.setModelLanguage(p,i||r||"text")},[r,n,i],C),$(()=>{var s;(s=b.current)==null||s.editor.setTheme(w)},[w],C),$(()=>{var s;(s=O.current)==null||s.updateOptions(y)},[y],C);let a=d.useCallback(()=>{var S;if(!b.current)return;h.current(b.current);let s=z(b.current,e||"",n||r||"text",l||""),p=z(b.current,t||"",i||r||"text",f||"");(S=O.current)==null||S.setModel({original:s,modified:p})},[r,t,i,e,n,l,f]),c=d.useCallback(()=>{var s;!j.current&&R.current&&(O.current=b.current.editor.createDiffEditor(R.current,{automaticLayout:!0,...y}),a(),(s=b.current)==null||s.editor.setTheme(w),L(!0),j.current=!0)},[y,w,a]);d.useEffect(()=>{C&&M.current(O.current,b.current)},[C]),d.useEffect(()=>{!I&&!C&&c()},[I,C,c]);function u(){var p,S,E,W;let s=(p=O.current)==null?void 0:p.getModel();g||((S=s==null?void 0:s.original)==null||S.dispose()),v||((E=s==null?void 0:s.modified)==null||E.dispose()),(W=O.current)==null||W.dispose()}return D.createElement(we,{width:A,height:k,isEditorReady:C,loading:F,_ref:R,className:U,wrapperProps:H})}var At=Dt;d.memo(At);function Vt(e){let t=d.useRef();return d.useEffect(()=>{t.current=e},[e]),t.current}var zt=Vt,Z=new Map;function Ut({defaultValue:e,defaultLanguage:t,defaultPath:r,value:n,language:i,path:l,theme:f="light",line:g,loading:v="Loading...",options:w={},overrideServices:F={},saveViewState:y=!0,keepCurrentModel:k=!1,width:A="100%",height:U="100%",className:H,wrapperProps:q={},beforeMount:B=K,onMount:C=K,onChange:L,onValidate:I=K}){let[N,O]=d.useState(!1),[b,R]=d.useState(!0),M=d.useRef(null),h=d.useRef(null),j=d.useRef(null),a=d.useRef(C),c=d.useRef(B),u=d.useRef(),s=d.useRef(n),p=zt(l),S=d.useRef(!1),E=d.useRef(!1);je(()=>{let m=be.init();return m.then(x=>(M.current=x)&&R(!1)).catch(x=>(x==null?void 0:x.type)!=="cancelation"&&console.error("Monaco initialization: error:",x)),()=>h.current?Oe():m.cancel()}),$(()=>{var x,P,_,V;let m=z(M.current,e||n||"",t||i||"",l||r||"");m!==((x=h.current)==null?void 0:x.getModel())&&(y&&Z.set(p,(P=h.current)==null?void 0:P.saveViewState()),(_=h.current)==null||_.setModel(m),y&&((V=h.current)==null||V.restoreViewState(Z.get(l))))},[l],N),$(()=>{var m;(m=h.current)==null||m.updateOptions(w)},[w],N),$(()=>{!h.current||n===void 0||(h.current.getOption(M.current.editor.EditorOption.readOnly)?h.current.setValue(n):n!==h.current.getValue()&&(E.current=!0,h.current.executeEdits("",[{range:h.current.getModel().getFullModelRange(),text:n,forceMoveMarkers:!0}]),h.current.pushUndoStop(),E.current=!1))},[n],N),$(()=>{var x,P;let m=(x=h.current)==null?void 0:x.getModel();m&&i&&((P=M.current)==null||P.editor.setModelLanguage(m,i))},[i],N),$(()=>{var m;g!==void 0&&((m=h.current)==null||m.revealLine(g))},[g],N),$(()=>{var m;(m=M.current)==null||m.editor.setTheme(f)},[f],N);let W=d.useCallback(()=>{var m;if(!(!j.current||!M.current)&&!S.current){c.current(M.current);let x=l||r,P=z(M.current,n||e||"",t||i||"",x||"");h.current=(m=M.current)==null?void 0:m.editor.create(j.current,{model:P,automaticLayout:!0,...w},F),y&&h.current.restoreViewState(Z.get(x)),M.current.editor.setTheme(f),g!==void 0&&h.current.revealLine(g),O(!0),S.current=!0}},[e,t,r,n,i,l,w,F,y,f,g]);d.useEffect(()=>{N&&a.current(h.current,M.current)},[N]),d.useEffect(()=>{!b&&!N&&W()},[b,N,W]),s.current=n,d.useEffect(()=>{var m,x;N&&L&&((m=u.current)==null||m.dispose(),u.current=(x=h.current)==null?void 0:x.onDidChangeModelContent(P=>{E.current||L(h.current.getValue(),P)}))},[N,L]),d.useEffect(()=>{if(N){let m=M.current.editor.onDidChangeMarkers(x=>{var _;let P=(_=h.current.getModel())==null?void 0:_.uri;if(P&&x.find(V=>V.path===P.path)){let V=M.current.editor.getModelMarkers({resource:P});I==null||I(V)}});return()=>{m==null||m.dispose()}}return()=>{}},[N,I]);function Oe(){var m,x;(m=u.current)==null||m.dispose(),k?y&&Z.set(l,h.current.saveViewState()):(x=h.current.getModel())==null||x.dispose(),h.current.dispose()}return D.createElement(we,{width:A,height:U,isEditorReady:N,loading:v,_ref:j,className:H,wrapperProps:q})}var Ht=Ut,qt=d.memo(Ht),Bt=qt;const Qt=()=>{const[e,t]=d.useState("/"),[r,n]=d.useState([]),[i,l]=d.useState([]),[f,g]=d.useState(null),[v,w]=d.useState(!1),[F,y]=d.useState(null);d.useEffect(()=>{k(e)},[e]);const k=async a=>{try{w(!0);const c=await fetch(`/api/files/browse?path=${encodeURIComponent(a.slice(1))}`);if(c.ok){const u=await c.json();n(u.items)}else throw new Error("Failed to browse directory")}catch(c){y({type:"error",text:c.message})}finally{w(!1)}},A=async a=>{if(i.find(u=>u.path===a)){g(a);return}try{const u=await fetch(`/api/files/read?path=${encodeURIComponent(a.slice(1))}`);if(u.ok){const s=await u.json(),p={path:a,content:s.content,original:s.content,modified:!1};l([...i,p]),g(a)}else{const s=await u.json();y({type:"error",text:s.detail||"Failed to open file"})}}catch(u){y({type:"error",text:u.message})}},U=async a=>{const c=i.find(u=>u.path===a);if(c)try{const u=await fetch("/api/files/save",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({path:a.slice(1),content:c.content})});if(u.ok)y({type:"success",text:"File saved successfully"}),l(i.map(s=>s.path===a?{...s,original:s.content,modified:!1}:s)),k(e);else{const s=await u.json();throw new Error(s.detail||"Failed to save file")}}catch(u){y({type:"error",text:u.message})}},H=a=>{const c=i.find(s=>s.path===a);if(c!=null&&c.modified&&!confirm(`${c.path} has unsaved changes. Close anyway?`))return;const u=i.filter(s=>s.path!==a);l(u),f===a&&g(u.length>0?u[0].path:null)},q=(a,c)=>{l(i.map(u=>u.path===a?{...u,content:c,modified:c!==u.original}:u))},B=async a=>{if(confirm(`Delete ${a}? This cannot be undone.`))try{const c=await fetch(`/api/files/delete?path=${encodeURIComponent(a.slice(1))}`,{method:"DELETE"});if(c.ok)y({type:"success",text:"Deleted successfully"}),l(i.filter(u=>u.path!==a)),k(e);else{const u=await c.json();throw new Error(u.detail||"Failed to delete")}}catch(c){y({type:"error",text:c.message})}},C=async()=>{const a=prompt("Enter file name (e.g., mypool_driver.py):");if(!a)return;const c=`${e}${e.endsWith("/")?"":"/"}${a}`;try{const u=await fetch("/api/files/create",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({path:c.slice(1),content:""})});if(u.ok)y({type:"success",text:"File created successfully"}),k(e),A(c);else{const s=await u.json();throw new Error(s.detail||"Failed to create file")}}catch(u){y({type:"error",text:u.message})}},L=async a=>{const c=a.split("/").pop(),u=prompt(`Copy ${c} as:`,`${c}.copy`);if(!u)return;const p=`${a.substring(0,a.lastIndexOf("/"))}/${u}`;try{const S=await fetch("/api/files/copy",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({path:a.slice(1),new_path:p.slice(1)})});if(S.ok)y({type:"success",text:"File copied successfully"}),k(e);else{const E=await S.json();throw new Error(E.detail||"Failed to copy file")}}catch(S){y({type:"error",text:S.message})}},I=a=>{const c=`/api/files/download?path=${encodeURIComponent(a.slice(1))}`;window.open(c,"_blank")},N=async a=>{const c=a.split("/").pop(),u=prompt(`Rename "${c}" to:`,c);if(!u||u===c)return;const p=`${a.substring(0,a.lastIndexOf("/"))}/${u}`;try{const S=await fetch("/api/files/rename",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({path:a.slice(1),new_path:p.slice(1)})});if(S.ok)y({type:"success",text:"File renamed successfully"}),i.some(E=>E.path===a)&&(l(i.map(E=>E.path===a?{...E,path:p}:E)),f===a&&g(p)),k(e);else{const E=await S.json();throw new Error(E.detail||"Failed to rename file")}}catch(S){y({type:"error",text:S.message})}},O=a=>{if(a.type==="directory")return o.jsx(le,{className:"w-5 h-5 text-blue-400"});switch(a.extension){case".py":return o.jsx(se,{className:"w-5 h-5 text-green-400"});case".yaml":case".yml":return o.jsx(Ce,{className:"w-5 h-5 text-purple-400"});case".json":return o.jsx(se,{className:"w-5 h-5 text-yellow-400"});case".md":return o.jsx(ce,{className:"w-5 h-5 text-gray-400"});default:return o.jsx(Te,{className:"w-5 h-5 text-gray-400"})}},b=a=>{var s;const c=(s=a.split(".").pop())==null?void 0:s.toLowerCase();return{py:"python",js:"javascript",ts:"typescript",json:"json",yaml:"yaml",yml:"yaml",md:"markdown",sh:"shell",txt:"plaintext",log:"plaintext"}[c||""]||"plaintext"},R=a=>a.endsWith(".example"),M=a=>a<1024?`${a} B`:a<1024*1024?`${(a/1024).toFixed(1)} KB`:`${(a/(1024*1024)).toFixed(1)} MB`,h=e.split("/").filter(Boolean),j=i.find(a=>a.path===f);return o.jsxs("div",{className:"flex flex-col h-screen bg-gray-950",children:[o.jsxs("div",{className:"p-4 border-b border-gray-800",children:[o.jsx("h1",{className:"text-2xl font-bold text-gray-100",children:"File Manager"}),o.jsx("p",{className:"text-sm text-gray-400 mt-1",children:"Browse and edit configuration files"})]}),F&&o.jsx("div",{className:`mx-4 mt-4 p-3 rounded-md ${F.type==="success"?"bg-green-900/40 border border-green-700":"bg-red-900/40 border border-red-700"}`,children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsx("p",{className:`text-sm ${F.type==="success"?"text-green-200":"text-red-200"}`,children:F.text}),o.jsx("button",{onClick:()=>y(null),className:"text-gray-400 hover:text-gray-300",children:o.jsx(oe,{className:"w-4 h-4"})})]})}),o.jsxs("div",{className:"flex flex-1 overflow-hidden",children:[o.jsxs("div",{className:"w-80 border-r border-gray-800 flex flex-col bg-gray-900/40",children:[o.jsxs("div",{className:"p-3 border-b border-gray-800 flex items-center space-x-2 text-sm",children:[o.jsx("button",{onClick:()=>t("/"),className:"text-blue-400 hover:text-blue-300",children:"/config"}),h.map((a,c)=>o.jsxs(D.Fragment,{children:[o.jsx(Ee,{className:"w-4 h-4 text-gray-600"}),o.jsx("button",{onClick:()=>t("/"+h.slice(0,c+1).join("/")),className:"text-blue-400 hover:text-blue-300",children:a})]},c))]}),o.jsxs("div",{className:"p-2 border-b border-gray-800 flex items-center space-x-2",children:[o.jsx("button",{onClick:C,className:"p-2 rounded hover:bg-gray-800 text-gray-300 hover:text-gray-100",title:"New File",children:o.jsx(Se,{className:"w-4 h-4"})}),o.jsx("button",{onClick:()=>k(e),className:"p-2 rounded hover:bg-gray-800 text-gray-300 hover:text-gray-100",title:"Refresh",children:o.jsx(ie,{className:`w-4 h-4 ${v?"animate-spin":""}`})})]}),o.jsx("div",{className:"flex-1 overflow-y-auto",children:v&&r.length===0?o.jsxs("div",{className:"p-4 text-center text-gray-500",children:[o.jsx(ie,{className:"w-6 h-6 mx-auto animate-spin mb-2"}),"Loading..."]}):r.length===0?o.jsxs("div",{className:"p-4 text-center text-gray-500",children:[o.jsx(Me,{className:"w-12 h-12 mx-auto mb-2 opacity-50"}),o.jsx("p",{children:"Empty directory"})]}):o.jsxs("div",{className:"divide-y divide-gray-800",children:[e!=="/"&&o.jsxs("div",{onClick:()=>{const a=e.substring(0,e.lastIndexOf("/"))||"/";t(a)},className:"px-3 py-2 hover:bg-gray-800 cursor-pointer flex items-center space-x-3",children:[o.jsx(le,{className:"w-5 h-5 text-gray-500"}),o.jsx("span",{className:"text-gray-400",children:".."})]}),r.map(a=>o.jsxs("div",{className:"px-3 py-2 hover:bg-gray-800 cursor-pointer flex items-center justify-between group",children:[o.jsxs("div",{onClick:()=>{a.type==="directory"?t(a.path):A(a.path)},className:"flex items-center space-x-3 flex-1",children:[O(a),o.jsxs("div",{className:"flex-1 min-w-0",children:[o.jsx("p",{className:"text-sm text-gray-200 truncate",children:a.name}),o.jsx("p",{className:"text-xs text-gray-500",children:a.type==="file"?M(a.size):"Folder"})]})]}),a.type==="file"&&o.jsxs("div",{className:"flex items-center space-x-1 opacity-0 group-hover:opacity-100",children:[o.jsx("button",{onClick:c=>{c.stopPropagation(),N(a.path)},className:"p-1 rounded hover:bg-gray-700 text-gray-400 hover:text-gray-200",title:"Rename",children:o.jsx(Fe,{className:"w-3.5 h-3.5"})}),o.jsx("button",{onClick:c=>{c.stopPropagation(),L(a.path)},className:"p-1 rounded hover:bg-gray-700 text-gray-400 hover:text-gray-200",title:"Copy",children:o.jsx(Pe,{className:"w-3.5 h-3.5"})}),o.jsx("button",{onClick:c=>{c.stopPropagation(),I(a.path)},className:"p-1 rounded hover:bg-gray-700 text-gray-400 hover:text-gray-200",title:"Download",children:o.jsx($e,{className:"w-3.5 h-3.5"})}),o.jsx("button",{onClick:c=>{c.stopPropagation(),B(a.path)},className:"p-1 rounded hover:bg-gray-700 text-red-400 hover:text-red-300",title:"Delete",children:o.jsx(ke,{className:"w-3.5 h-3.5"})})]})]},a.path))]})})]}),o.jsx("div",{className:"flex-1 flex flex-col",children:i.length===0?o.jsx("div",{className:"flex-1 flex items-center justify-center text-gray-500",children:o.jsxs("div",{className:"text-center",children:[o.jsx(ce,{className:"w-16 h-16 mx-auto mb-4 opacity-50"}),o.jsx("p",{className:"text-lg",children:"No files open"}),o.jsx("p",{className:"text-sm mt-2",children:"Select a file from the sidebar to start editing"})]})}):o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"flex items-center border-b border-gray-800 bg-gray-900/40 overflow-x-auto",children:i.map(a=>o.jsxs("div",{onClick:()=>g(a.path),className:`flex items-center space-x-2 px-4 py-2 border-r border-gray-800 cursor-pointer ${f===a.path?"bg-gray-900 text-gray-100":"text-gray-400 hover:text-gray-200 hover:bg-gray-800/50"}`,children:[o.jsxs("span",{className:"text-sm truncate max-w-xs",children:[a.path.split("/").pop(),a.modified&&" â€¢"]}),o.jsx("button",{onClick:c=>{c.stopPropagation(),H(a.path)},className:"hover:bg-gray-700 rounded p-0.5",children:o.jsx(oe,{className:"w-3.5 h-3.5"})})]},a.path))}),j&&o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"p-2 border-b border-gray-800 flex items-center justify-between bg-gray-900/40",children:[o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsx("span",{className:"text-sm text-gray-400",children:j.path}),R(j.path)&&o.jsxs("span",{className:"inline-flex items-center px-2 py-0.5 rounded text-xs bg-yellow-900/40 text-yellow-400 border border-yellow-700",children:[o.jsx(Re,{className:"w-3 h-3 mr-1"}),"Read-only"]})]}),o.jsxs("button",{onClick:()=>U(j.path),disabled:!j.modified||R(j.path),className:`inline-flex items-center px-3 py-1 rounded text-sm ${j.modified&&!R(j.path)?"bg-blue-600 text-white hover:bg-blue-700":"bg-gray-800 text-gray-500 cursor-not-allowed"}`,title:R(j.path)?"File is read-only (view only)":"",children:[o.jsx(Ie,{className:"w-4 h-4 mr-1"}),"Save"]})]}),o.jsx("div",{className:"flex-1",children:o.jsx(Bt,{height:"100%",language:b(j.path),value:j.content,onChange:a=>q(j.path,a||""),theme:"vs-dark",options:{minimap:{enabled:!0},fontSize:14,lineNumbers:"on",rulers:[80,120],wordWrap:"off",automaticLayout:!0,readOnly:R(j.path)}})})]})]})})]})]})};export{Qt as default};
