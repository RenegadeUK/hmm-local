import{r as m,a as d,j as e,D as u,T as N}from"./index-CoRkTlXe-1771041506660.js";import{C,b as w,L as k,P as F,c as L,B as D,p as _,d as E,e as A,i as S,f as T}from"./index-CwO4G0M8-1771041506660.js";import{T as $}from"./trending-down-DwVkUfrM-1771041506660.js";import{C as q}from"./calendar-DS6u-s8k-1771041506660.js";function G(){m.useEffect(()=>{C.register(w,k,F,L,D,_,E,A,S)},[]);const[r,i]=m.useState("daily"),{data:x,isLoading:h}=d({queryKey:["costs-hourly"],queryFn:async()=>{const a=await fetch("/api/costs/hourly?hours=24");if(!a.ok)throw new Error("Failed to fetch hourly costs");return a.json()},refetchInterval:9e5,enabled:r==="hourly"}),{data:g,isLoading:b}=d({queryKey:["costs-daily"],queryFn:async()=>{const a=await fetch("/api/costs/daily?days=30");if(!a.ok)throw new Error("Failed to fetch daily costs");return a.json()},refetchInterval:9e5,enabled:r==="daily"}),{data:y,isLoading:p}=d({queryKey:["costs-monthly"],queryFn:async()=>{const a=await fetch("/api/costs/monthly?months=12");if(!a.ok)throw new Error("Failed to fetch monthly costs");return a.json()},refetchInterval:9e5,enabled:r==="monthly"}),f=h||b||p,s=r==="hourly"?x:r==="daily"?g:y,c=(()=>{if(!s)return null;let a=[],o=[],n=[],l=[];return r==="hourly"&&s.hours?(a=s.hours.map(t=>new Date(t.hour).toLocaleDateString("en-GB",{hour:"2-digit",minute:"2-digit"})),o=s.hours.map(t=>t.actual_cost),n=s.hours.map(t=>t.baseline_cost),l=s.hours.map(t=>t.savings)):r==="daily"&&s.days?(a=s.days.map(t=>new Date(t.date+"T00:00:00").toLocaleDateString("en-GB",{day:"numeric",month:"short"})),o=s.days.map(t=>t.actual_cost),n=s.days.map(t=>t.baseline_cost),l=s.days.map(t=>t.savings)):r==="monthly"&&s.months&&(a=s.months.map(t=>`${t.month_name.substring(0,3)} ${t.year}`),o=s.months.map(t=>t.actual_cost),n=s.months.map(t=>t.baseline_cost),l=s.months.map(t=>t.savings)),{labels:a,datasets:[{label:"Actual Cost",data:o,borderColor:"rgb(59, 130, 246)",backgroundColor:"rgba(59, 130, 246, 0.1)",fill:!0,tension:.3},{label:"Without Automation (24/7)",data:n,borderColor:"rgb(239, 68, 68)",backgroundColor:"rgba(239, 68, 68, 0.1)",fill:!0,tension:.3,borderDash:[5,5]},{label:"Savings",data:l,borderColor:"rgb(34, 197, 94)",backgroundColor:"rgba(34, 197, 94, 0.2)",fill:!0,tension:.3}]}})(),j={responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"top"},title:{display:!1},tooltip:{callbacks:{label:function(a){return`${a.dataset.label}: £${a.parsed.y.toFixed(2)}`}}}},scales:{y:{beginAtZero:!0,ticks:{callback:function(a){return"£"+a.toFixed(2)}}}}};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Energy Costs"}),e.jsx("p",{className:"text-muted-foreground",children:"Track actual costs vs. baseline (if all miners ran 24/7)"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>i("hourly"),className:`px-4 py-2 rounded-lg font-medium transition-colors ${r==="hourly"?"bg-primary text-primary-foreground":"bg-muted hover:bg-muted/80"}`,children:"Last 24 Hours"}),e.jsx("button",{onClick:()=>i("daily"),className:`px-4 py-2 rounded-lg font-medium transition-colors ${r==="daily"?"bg-primary text-primary-foreground":"bg-muted hover:bg-muted/80"}`,children:"Last 30 Days"}),e.jsx("button",{onClick:()=>i("monthly"),className:`px-4 py-2 rounded-lg font-medium transition-colors ${r==="monthly"?"bg-primary text-primary-foreground":"bg-muted hover:bg-muted/80"}`,children:"Last 12 Months"})]}),s&&e.jsxs("div",{className:"grid gap-4 md:grid-cols-4",children:[e.jsxs("div",{className:"rounded-lg border bg-card p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm font-medium text-muted-foreground",children:[e.jsx(u,{className:"h-4 w-4"}),"Actual Cost"]}),e.jsxs("div",{className:"mt-2 text-2xl font-bold",children:["£",s.summary.total_actual_cost.toFixed(2)]}),e.jsx("div",{className:"mt-1 text-xs text-muted-foreground",children:"Energy consumed"})]}),e.jsxs("div",{className:"rounded-lg border bg-card p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm font-medium text-muted-foreground",children:[e.jsx(N,{className:"h-4 w-4"}),"Without Automation"]}),e.jsxs("div",{className:"mt-2 text-2xl font-bold",children:["£",s.summary.total_baseline_cost.toFixed(2)]}),e.jsx("div",{className:"mt-1 text-xs text-muted-foreground",children:"If miners ran 24/7"})]}),e.jsxs("div",{className:"rounded-lg border bg-card p-4 bg-green-500/10 border-green-500/20",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm font-medium text-green-600 dark:text-green-400",children:[e.jsx($,{className:"h-4 w-4"}),"Total Savings"]}),e.jsxs("div",{className:"mt-2 text-2xl font-bold text-green-600 dark:text-green-400",children:["£",s.summary.total_savings.toFixed(2)]}),e.jsx("div",{className:"mt-1 text-xs text-green-600/80 dark:text-green-400/80",children:"From automation"})]}),e.jsxs("div",{className:"rounded-lg border bg-card p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm font-medium text-muted-foreground",children:[e.jsx(q,{className:"h-4 w-4"}),"Savings %"]}),e.jsxs("div",{className:"mt-2 text-2xl font-bold",children:[s.summary.savings_percent.toFixed(1),"%"]}),e.jsx("div",{className:"mt-1 text-xs text-muted-foreground",children:"Cost reduction"})]})]}),e.jsxs("div",{className:"rounded-lg border bg-card",children:[e.jsxs("div",{className:"border-b p-4",children:[e.jsxs("h2",{className:"text-lg font-semibold",children:[r==="hourly"&&"Hourly Costs (Last 24 Hours)",r==="daily"&&"Daily Costs (Last 30 Days)",r==="monthly"&&"Monthly Costs (Last 12 Months)"]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Blue: Actual costs • Red: Without automation (24/7) • Green: Savings"})]}),e.jsx("div",{className:"p-4",children:f?e.jsx("div",{className:"flex h-96 items-center justify-center",children:e.jsx("div",{className:"text-muted-foreground",children:"Loading cost data..."})}):c?e.jsx("div",{className:"h-96",children:e.jsx(T,{data:c,options:j})}):e.jsx("div",{className:"flex h-96 items-center justify-center",children:e.jsx("div",{className:"text-muted-foreground",children:"No cost data available"})})})]}),e.jsx("div",{className:"rounded-lg border bg-blue-500/10 border-blue-500/20 p-4",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"rounded-full bg-blue-500/20 p-2",children:e.jsx(u,{className:"h-5 w-5 text-blue-600 dark:text-blue-400"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-semibold text-blue-900 dark:text-blue-100",children:"How Costs Are Calculated"}),e.jsxs("p",{className:"mt-1 text-sm text-blue-800 dark:text-blue-200",children:[e.jsx("strong",{children:"Actual Cost:"})," Calculated from telemetry data (power readings × electricity price × runtime). When automation turns miners OFF, no power is consumed, so cost is lower."]}),e.jsxs("p",{className:"mt-2 text-sm text-blue-800 dark:text-blue-200",children:[e.jsx("strong",{children:"Baseline (Without Automation):"})," Estimated cost if all miners ran 24/7 at their average power draw. Uses actual electricity prices during downtime periods."]}),e.jsxs("p",{className:"mt-2 text-sm text-blue-800 dark:text-blue-200",children:[e.jsx("strong",{children:"Savings:"})," The difference between baseline and actual cost - money saved by automation turning miners OFF during expensive electricity periods."]})]})]})})]})}export{G as Costs};
